import{d as H,s as J,l as r,o as p,f as w,P as c,S as t,w as a,Q as i,R as K,F as k,W as N,Z as Y,a7 as ee,c as P,X as te}from"./index-BnnnK_YI.js";import{E as oe}from"./el-dialog-z2z_cZfe.js";/* empty css                   *//* empty css                     *//* empty css                 */import"./el-tag-DksfI-x9.js";/* empty css                  */import"./el-scrollbar-D3VZCHtT.js";import{E as le}from"./el-pagination-Cj9T_khR.js";import{E as ae,a as re}from"./el-table-column-BWSclO2l.js";import"./el-checkbox-9FcrlSCf.js";import"./el-tooltip-l0sNRNKZ.js";import{E as ie}from"./el-link-DL3ZTdMf.js";import"./el-button-D6xHPO3A.js";import{T as se}from"./index-CCV_fsNh.js";import{a as f}from"./index-Ce9ZylsI.js";import{e as ne}from"./index-B4aRIXA1.js";import{g as ue}from"./index-6IzyqOF-.js";/* empty css                   *//* empty css                       */import{a as n}from"./request-DhRpxnTY.js";import{E as me}from"./index-7hJybXhx.js";import{E as de}from"./index-DucyUmQv.js";import{E as pe,a as ce}from"./index-ClxgrGYT.js";import{E as fe,a as ve}from"./index-CXMUnDXQ.js";import"./index-BRZqMuae.js";import"./index-C0TB7Dbb.js";import"./scroll-CjGXt2xZ.js";import"./vnode-Dm6k9IV6.js";import"./refs-CWMt8GWG.js";import"./event-BB_Ol6Sd.js";import"./_initCloneObject-DNKOYgS9.js";import"./isEqual-DQirXHc5.js";import"./typescript-CS6VS-lD.js";import"./index-nQ1hFZTo.js";import"./isArrayLikeObject-BfGwdoSH.js";/* empty css                                                              *//* empty css                       *//* empty css                 *//* empty css                          */import"./index-mQz5lFU6.js";import"./index--nQxpy5t.js";import"./arrays-6TrVLtTe.js";import"./index-B4rGlqPP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-BZ2loiMZ.js";import"./castArray-DfA7nsC2.js";import"./_baseClone-DJAZlgpx.js";const ge={class:"s-flex-col",style:{height:"100%"}},_e={class:"s-table-operations"},he={class:"s-flex-auto",style:{"min-height":"0"}},be={class:"s-table-pagination"},we={class:"dialog-footer"},ke={class:"dialog-footer"},bt=H({__name:"Clues",setup(ye){const D=Y();ee();const d=J({page:1,perPage:10}),x=r(0),E=r({}),C=r([]),b=r(null),S=r([]),V=r([]),L=o=>{E.value=o,d.page=1,m()},m=async()=>{f.getList({status:1,...d,...E.value}).then(o=>{o.code===0&&(C.value=o.data.data,x.value=o.data.total)})},v=r({}),g=r(!1),z=r(null),M=o=>{v.value.id=o.id,g.value=!0},$=()=>{z.value.validate(o=>{o&&f.changeIntention(v.value).then(e=>{e.code===0?(n.success("转为意向成功"),m(),g.value=!1):n.error(e.msg)})})},q=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){n.warning("请选择需要删除的线索");return}me.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{f.del({id:o}).then(e=>{e.code===0?(n.success("删除成功"),m()):n.error(e.msg)})}).catch(()=>{})},_=r({}),h=r(!1),F=r(null),R=r([]),O=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){n.warning("请选择需要转移的线索");return}_.value.id=o,h.value=!0},Q=()=>{F.value.validate(o=>{o&&f.changeUser(_.value).then(e=>{e.code===0?(n.success("转移成功"),h.value=!1,m()):n.error(e.msg)})})},W=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){n.warning("请选择需要移至公海的线索");return}f.changePublic({id:o}).then(e=>{e.code===0?(n.success("移至公海成功"),m()):n.error(e.msg)})},X=()=>{D.push("/market/clues/import")},Z=()=>{console.log("export")};return f.getSearchField().then(o=>{o.code===0&&(S.value=o.data)}),ne().then(o=>{o.code===0&&(V.value=o.data)}),ue().then(o=>{o.code===0&&(R.value=o.data)}),m(),(o,e)=>{const s=de,u=ae,j=ie,A=re,G=le,U=ce,I=pe,y=fe,T=ve,B=oe;return p(),w(k,null,[c("div",ge,[t(se,{data:S.value,onSearch:L},null,8,["data"]),c("div",_e,[t(s,{size:"small",onClick:e[0]||(e[0]=l=>o.$router.push("/market/clues/add"))},{default:a(()=>[i("新增")]),_:1}),t(s,{size:"small",onClick:X},{default:a(()=>[i("导入")]),_:1}),t(s,{size:"small",onClick:Z},{default:a(()=>[i("导出")]),_:1}),t(s,{size:"small",onClick:O},{default:a(()=>[i("转移给他人")]),_:1}),t(s,{size:"small",onClick:W},{default:a(()=>[i("移至公海")]),_:1}),t(s,{size:"small",onClick:q},{default:a(()=>[i("删除")]),_:1})]),c("div",he,[t(A,{ref_key:"tableRef",ref:b,data:C.value,border:"","table-layout":"fixed",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:a(()=>[t(u,{type:"selection",width:"42"}),t(u,{prop:"companyName",label:"公司名称",width:"180"},{default:a(l=>[t(j,{href:"/market/clues/info?type=1&id="+l.row.id+"&exhibitionId="+l.row.exhibitionId+"&authUser="+l.row.authUser,type:"primary"},{default:a(()=>[i(K(l.row.companyName),1)]),_:2},1032,["href"])]),_:1}),t(u,{prop:"exhibitionContact",label:"联系方式",width:"180"}),t(u,{prop:"duties",label:"职务"}),t(u,{prop:"phone",label:"电话"}),t(u,{prop:"recordTime",label:"记录时间",width:"180"}),t(u,{prop:"recordText",label:"记录内容"}),t(u,{prop:"authUser",label:"授权人"}),t(u,{fixed:"right",label:"操作",width:"120"},{default:a(l=>[t(s,{link:"",type:"primary",size:"small",onClick:xe=>M(l.row)},{default:a(()=>[i(" 转为意向客户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),c("div",be,[t(G,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:x.value,"current-page":d.page,"onUpdate:currentPage":e[1]||(e[1]=l=>d.page=l),"page-size":d.perPage,"onUpdate:pageSize":e[2]||(e[2]=l=>d.perPage=l),onChange:m},null,8,["total","current-page","page-size"])])]),t(B,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=l=>g.value=l),title:"转为意向客户",width:"500",draggable:""},{footer:a(()=>[c("div",we,[t(s,{onClick:e[4]||(e[4]=l=>g.value=!1)},{default:a(()=>[i("取消")]),_:1}),t(s,{type:"primary",onClick:$},{default:a(()=>[i("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"willFormRef",ref:z,model:v.value,"label-width":"auto"},{default:a(()=>[t(y,{label:"项目",prop:"exhibitionId",rules:[{required:!0,message:"请选择项目"}]},{default:a(()=>[t(I,{modelValue:v.value.exhibitionId,"onUpdate:modelValue":e[3]||(e[3]=l=>v.value.exhibitionId=l),placeholder:""},{default:a(()=>[(p(!0),w(k,null,N(V.value,l=>(p(),w(k,{key:l.id},[l.status===1?(p(),P(U,{key:0,label:l.exhibitionName,value:l.id},null,8,["label","value"])):te("",!0)],64))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:h.value,"onUpdate:modelValue":e[8]||(e[8]=l=>h.value=l),title:"转移销售线索",width:"500",draggable:""},{footer:a(()=>[c("div",ke,[t(s,{onClick:e[7]||(e[7]=l=>h.value=!1)},{default:a(()=>[i("取消")]),_:1}),t(s,{type:"primary",onClick:Q},{default:a(()=>[i("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"moveFormRef",ref:F,model:_.value,"label-width":"auto"},{default:a(()=>[t(y,{label:""},{default:a(()=>[i("是否将选中的销售线索转移？")]),_:1}),t(y,{label:"销售线索所有人",prop:"userId",rules:[{required:!0,message:"请选择销售线索所有人"}]},{default:a(()=>[t(I,{modelValue:_.value.userId,"onUpdate:modelValue":e[6]||(e[6]=l=>_.value.userId=l),placeholder:""},{default:a(()=>[(p(!0),w(k,null,N(R.value,l=>(p(),P(U,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});export{bt as default};
