import{d as se,l as m,s as W,e as X,v as Z,O as K,o as s,f as _,P as c,R as F,S as l,w as o,Q as f,F as h,W as g,Z as ce,a7 as pe,c as P,X as me,_ as fe,$ as _e}from"./index-DuO5qCOl.js";import{E as ve}from"./el-dialog-CAuCsNUe.js";/* empty css                   */import{E as he}from"./el-col-DIVg5wKT.js";import{E as be}from"./el-scrollbar-vJTALLEq.js";import{E as ge,a as Pe}from"./el-form-item-Cu1KkJ1t.js";/* empty css                 */import"./el-button-BF6LotWW.js";import"./el-tag-D6qwnJNq.js";import{E as Ve,a as ye}from"./el-select-CbMMSZu0.js";import"./el-popper-BHkirKhh.js";import{E as Ce,a as we}from"./el-radio-DuQPwZZa.js";import{E as Ee}from"./el-image-viewer-Da-7Uuzg.js";import{a as Ne}from"./index-3ZZcCj1_.js";import{g as ke}from"./index-XdeIYU-H.js";import{E as xe}from"./index-DsHhOPYe.js";import{E as Ue}from"./index-D0AcFqj2.js";import{E as Fe}from"./index-00qRAo0A.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C_drDIjm.js";import"./scroll-Cg5HvfrT.js";import"./vnode-DvYhN3El.js";import"./refs-CRuf-qco.js";import"./event-BB_Ol6Sd.js";import"./castArray-BQFRVikh.js";import"./_baseClone-CDORlhWC.js";import"./_initCloneObject-f8GnqyNx.js";import"./isEqual-BLHZt2FS.js";import"./request-BhcMgum5.js";const Se=N=>(fe("data-v-a85f42be"),N=N(),_e(),N),Be={class:"booth-reserve"},Oe={class:"l"},Re={class:"title"},qe={class:"img-box"},Je={class:"r"},$e={class:"form-box"},De=Se(()=>c("div",null,"预定展位",-1)),Te={style:{"text-align":"center"}},ze={style:{padding:"15px"}},Ge={class:"dialog-footer"},je=se({__name:"Reserve",setup(N){const M=ce(),w=pe(),q=w.query.clueId,I=w.query.exhibitionId,Y=w.query.exhibitorId,b=m(w.query.hallCode),S=m([]),k=m([]),J=m([]),$=m([]),D=m([]),T=m([]),z={1:"%",2:"￥"},a=W({clueId:q,exhibitionId:I,exhibitorId:Y,add:[],discount:[],position:[{hallCode:b.value,positionCode:"",companyBrand:[],product:"",unitPrice:"",type:1,length:0,width:0,costPrice:0,addPrice:0,discountPrice:0,finalPrice:0,deposit:0,isOffset:1,payType:1,ratio:0}]});m({});const t=W({show:!1,index:0,form:{product:"",unitPrice:"",num:1,length:"",width:""}}),ee=d=>{t.form.unitPrice=Number(d.price),t.form.product=d.text,t.form.num=d.num},le=X(()=>t.form.unitPrice?t.form.unitPrice+"元/"+(t.form.num===1?"":t.form.num)+"㎡":""),oe=()=>{let d=a.position.length;B(b.value,d),a.position.push({hallCode:b.value,positionCode:"",companyBrand:[],product:"",unitPrice:"",type:1,length:0,width:0,costPrice:0,addPrice:0,discountPrice:0,finalPrice:0,deposit:0,isOffset:1,payType:1,ratio:0})},B=(d,e)=>{k.value[e]=[],ke({exhibitionId:I,hallCode:d}).then(p=>{k.value[e]=p.data})};B(b.value,0);const te=()=>{M.push({name:"BoothCreateOrder",query:{...w.query,companyName:x.value,data:JSON.stringify(a)}})},ae=d=>{t.show=!0,t.index=d,t.form.product="",t.form.unitPrice="",t.form.length="",t.form.width="",t.form.num=1},ie=()=>{t.show=!1;let d=t.form.length*t.form.width,e=d*t.form.unitPrice/t.form.num,p=G(e),n=j(e);a.position[t.index].product=t.form.product,a.position[t.index].unitPrice=t.form.unitPrice,a.position[t.index].length=t.form.length,a.position[t.index].width=t.form.width,a.position[t.index].area=d,a.position[t.index].costPrice=Number(e.toFixed(2)),a.position[t.index].addPrice=Number(p.toFixed(2)),a.position[t.index].discountPrice=Number(n.toFixed(2)),a.position[t.index].finalPrice=Number((e+p-n).toFixed(2))},G=d=>{let e=0;return a.add.forEach(p=>{let n=JSON.parse(p);n.unit===1?e+=d*n.price/100:n.unit===2&&(e+=n.price)}),e},j=d=>{let e=0;return a.discount.forEach(p=>{let n=JSON.parse(p);n.unit===1?e+=d*n.price/100:n.unit===2&&(e+=n.price)}),e};Z(()=>a.add,d=>{a.position.forEach(e=>{e.addPrice=Number(G(e.costPrice).toFixed(2)),e.finalPrice=Number((e.costPrice+e.addPrice-e.discountPrice).toFixed(2))})}),Z(()=>a.discount,d=>{a.position.forEach(e=>{e.discountPrice=Number(j(e.costPrice).toFixed(2)),e.finalPrice=Number((e.costPrice+e.addPrice-e.discountPrice).toFixed(2))})});const x=m(""),O=m(!0);Ne({clueId:q,exhibitionId:I}).then(d=>{let e=d.data;J.value=e.attachPrice.add,$.value=e.attachPrice.discount,D.value=e.companyBrand,T.value=e.unitPrice,S.value=e.exhibitionHall,x.value=e.companyName,O.value=e.isNew});const A=X(()=>{let d=S.value.find(e=>e.code===b.value);return d?d.img:""});return(d,e)=>{const p=Ee,n=ge,U=Ce,H=we,V=ye,y=Ve,C=xe,v=Ue,ne=K("DeleteFilled"),L=Fe,Q=Pe,ue=be,R=he,de=K("Close"),re=ve;return s(),_(h,null,[c("div",Be,[c("div",Oe,[c("div",Re,[c("span",null,F(x.value),1),c("span",null,"展馆号："+F(b.value),1)]),c("div",qe,[l(p,{style:{width:"100%",height:"100%"},src:A.value,"preview-src-list":[A.value],fit:"scale-down",alt:"展馆图片"},null,8,["src","preview-src-list"])])]),c("div",Je,[c("div",$e,[l(ue,{height:"100%"},{default:o(()=>[l(Q,{model:a,"label-width":"auto",class:"form"},{default:o(()=>[De,l(n,{label:"企业名称"},{default:o(()=>[f(F(x.value),1)]),_:1}),l(n,{label:"新展商"},{default:o(()=>[l(H,{modelValue:O.value,"onUpdate:modelValue":e[0]||(e[0]=i=>O.value=i),disabled:""},{default:o(()=>[l(U,{value:!0},{default:o(()=>[f("是")]),_:1}),l(U,{value:!1},{default:o(()=>[f("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"加收"},{default:o(()=>[l(y,{modelValue:a.add,"onUpdate:modelValue":e[1]||(e[1]=i=>a.add=i),multiple:"",placeholder:"请选择"},{default:o(()=>[(s(!0),_(h,null,g(J.value,(i,u)=>(s(),P(V,{key:u,label:i.text+" "+i.price+z[i.unit],value:JSON.stringify(i)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"折扣"},{default:o(()=>[l(y,{modelValue:a.discount,"onUpdate:modelValue":e[2]||(e[2]=i=>a.discount=i),multiple:"",placeholder:"请选择"},{default:o(()=>[(s(!0),_(h,null,g($.value,(i,u)=>(s(),P(V,{key:u,label:i.text+" "+i.price+z[i.unit],value:JSON.stringify(i)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:""},{default:o(()=>[l(C,{icon:"Plus",onClick:oe},{default:o(()=>[f("添加展位")]),_:1})]),_:1}),(s(!0),_(h,null,g(a.position,(i,u)=>(s(),_("div",{class:"item",key:u},[l(n,{label:"展馆号"},{default:o(()=>[l(y,{modelValue:a.position[u].hallCode,"onUpdate:modelValue":r=>a.position[u].hallCode=r,placeholder:"请选择",onChange:r=>{B(i.hallCode,u),b.value=i.hallCode}},{default:o(()=>[(s(!0),_(h,null,g(S.value,(r,E)=>(s(),P(V,{key:E,label:r.code,value:r.code},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024),l(n,{label:"展位号"},{default:o(()=>[l(y,{modelValue:a.position[u].positionCode,"onUpdate:modelValue":r=>a.position[u].positionCode=r,filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"请选择"},{default:o(()=>[(s(!0),_(h,null,g(k.value[u],(r,E)=>(s(),P(V,{key:E,label:r,value:r},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(n,{label:"品牌"},{default:o(()=>[l(y,{modelValue:a.position[u].companyBrand,"onUpdate:modelValue":r=>a.position[u].companyBrand=r,multiple:"",placeholder:"请选择"},{default:o(()=>[(s(!0),_(h,null,g(D.value,(r,E)=>(s(),P(V,{key:E,label:r,value:r},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(n,{label:"展位类型"},{default:o(()=>[l(H,{modelValue:a.position[u].type,"onUpdate:modelValue":r=>a.position[u].type=r},{default:o(()=>[l(U,{value:1},{default:o(()=>[f("标准")]),_:1}),l(U,{value:2},{default:o(()=>[f("特装")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(n,{label:"展位规格"},{default:o(()=>[l(C,{size:"small",onClick:r=>ae(u)},{default:o(()=>[f("添加")]),_:2},1032,["onClick"])]),_:2},1024),a.position[u].product?(s(),P(n,{key:0,label:" "},{default:o(()=>[c("div",null,F(a.position[u].product+" "+a.position[u].area+"㎡"),1)]),_:2},1024)):me("",!0),l(n,{label:"展位原价"},{default:o(()=>[l(v,{modelValue:a.position[u].costPrice,"onUpdate:modelValue":r=>a.position[u].costPrice=r,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(n,{label:"加收金额"},{default:o(()=>[l(v,{"model-value":a.position[u].addPrice,disabled:""},null,8,["model-value"])]),_:2},1024),l(n,{label:"折扣金额"},{default:o(()=>[l(v,{"model-value":a.position[u].discountPrice,disabled:""},null,8,["model-value"])]),_:2},1024),l(n,{label:"最终金额"},{default:o(()=>[l(v,{modelValue:a.position[u].finalPrice,"onUpdate:modelValue":r=>a.position[u].finalPrice=r},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),c("div",Te,[l(C,{link:"",type:"danger",onClick:r=>{a.position.splice(u,1),k.value.splice(u,1)}},{default:o(()=>[l(L,null,{default:o(()=>[l(ne)]),_:1})]),_:2},1032,["onClick"])])]))),128))]),_:1},8,["model"])]),_:1})]),c("div",ze,[l(C,{type:"primary",onClick:te,style:{width:"100%"}},{default:o(()=>[f("确认")]),_:1})])])]),l(re,{modelValue:t.show,"onUpdate:modelValue":e[7]||(e[7]=i=>t.show=i),title:"添加规格",width:"500",draggable:""},{footer:o(()=>[c("div",Ge,[l(C,{onClick:e[6]||(e[6]=i=>t.show=!1)},{default:o(()=>[f("取消")]),_:1}),l(C,{type:"primary",onClick:ie},{default:o(()=>[f("确定")]),_:1})])]),default:o(()=>[l(Q,{ref:"ggFormRef",model:t.form,"label-width":"auto"},{default:o(()=>[l(n,{label:"产品名称",prop:"product"},{default:o(()=>[l(y,{modelValue:t.form.product,"onUpdate:modelValue":e[3]||(e[3]=i=>t.form.product=i),placeholder:"",onChange:ee},{default:o(()=>[(s(!0),_(h,null,g(T.value,i=>(s(),P(V,{key:i.id,label:i.text+" "+i.price+"/"+i.num+"/㎡",value:i},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"单价",prop:"unitPrice"},{default:o(()=>[l(v,{"model-value":le.value,disabled:""},null,8,["model-value"])]),_:1}),l(n,{label:"尺寸"},{default:o(()=>[l(R,{span:11},{default:o(()=>[l(v,{modelValue:t.form.length,"onUpdate:modelValue":e[4]||(e[4]=i=>t.form.length=i),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(R,{span:2,style:{display:"flex","align-items":"center","justify-content":"center","font-size":"20px"}},{default:o(()=>[l(L,null,{default:o(()=>[l(de)]),_:1})]),_:1}),l(R,{span:11},{default:o(()=>[l(v,{modelValue:t.form.width,"onUpdate:modelValue":e[5]||(e[5]=i=>t.form.width=i),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),l(n,{label:"面积"},{default:o(()=>[l(v,{"model-value":Number((t.form.length*t.form.width).toFixed(2)),autocomplete:"off",disabled:""},null,8,["model-value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),gl=Ie(je,[["__scopeId","data-v-a85f42be"]]);export{gl as default};
