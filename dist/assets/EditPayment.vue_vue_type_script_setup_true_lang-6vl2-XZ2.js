import{d as M,t as n,y as N,o as S,h as L,i as l,X as f,$ as o,Y as _,Z as x,a7 as d}from"./index-C_05KRGS.js";import{E as $}from"./dialog-Dg5SD3wH.js";/* empty css                */import{a as z,E as O}from"./form-item-DB6KKvGp.js";import{E as X}from"./row-DS8BJTge.js";import{E as Z}from"./col-Bruo0X_a.js";import{E as A}from"./progress-BBcMnlVu.js";import{E as G}from"./button-Dkfrz2pB.js";import{E as H}from"./image-viewer-BPvrXajP.js";import{E as J}from"./date-picker-iGMsAKnh.js";/* empty css              */import"./scrollbar-mNXNuAx8.js";import"./popper-eK9e0ccA.js";import"./tag-ZlOpYQtd.js";import{E as K,a as Q}from"./select-DFbZre-8.js";import{p as W}from"./index-BnN3MOXC.js";import{u as j}from"./index-fcBnpQyl.js";/* empty css                */import{E as ee}from"./index-D3tfzHDZ.js";const oe={style:{"text-align":"center"}},le={class:"el-image__error"},ae={style:{"text-align":"center"}},te={class:"el-image__error"},re={class:"dialog-footer"},xe=M({__name:"EditPayment",emits:["callback"],setup(me,{expose:T,emit:C}){const y=n(!1),v=n(null),E=n(null),e=N({show:!1,form:{id:0,payCompany:"",payType:0,payPrice:"",payTime:"",account:"",payImg:"",receiveImg:"",remark:""}}),U=()=>{y.value=!0,W.edit(e.form).then(t=>{t.code===0?(d.success("修改成功"),e.show=!1,D("callback")):d.error(t.msg),y.value=!1}).catch(t=>{y.value=!1})},P=t=>{e.show=!0,e.form.id=t.id,e.form.payCompany=t.payCompany,e.form.payType=t.payType,e.form.payPrice=t.payPrice,e.form.payTime=t.payTime,e.form.account=t.account,e.form.payImg=t.payImg,e.form.receiveImg=t.receiveImg,e.form.remark=t.remark},V=t=>t.size/1024/1024>3?(d.error("文件大小不能超过 3MB!"),!1):!0,b=n(!1),h=n(!1),I=(t,r)=>{let s,m;r===1?(s=b,m=v):(s=h,m=E),s.value=!0;let i=new FormData;return i.append("upload",t.file),new Promise((g,u)=>{j(i).then(p=>{p.code===0?g(p.data):(u(p),d.error("上传失败"),m.value.clearFiles()),s.value=!1}).catch(p=>{u(p),d.error("上传失败"),m.value.clearFiles(),s.value=!1})})},D=C;return T({setEdit:P}),(t,r)=>{const s=ee,m=z,i=K,g=Q,u=J,p=H,c=G,k=A,w=Z,F=X,R=O,B=$;return S(),L(B,{modelValue:e.show,"onUpdate:modelValue":r[7]||(r[7]=a=>e.show=a),title:"编辑付款信息",width:"500",draggable:""},{footer:l(()=>[f("div",re,[o(c,{onClick:r[6]||(r[6]=a=>e.show=!1)},{default:l(()=>[_("取消")]),_:1}),o(c,{type:"primary",onClick:U},{default:l(()=>[_("确定")]),_:1})])]),default:l(()=>[o(R,{ref:"willFormRef",model:e.form,"label-width":"auto","label-position":"left"},{default:l(()=>[o(m,{label:"付款公司"},{default:l(()=>[o(s,{modelValue:e.form.payCompany,"onUpdate:modelValue":r[0]||(r[0]=a=>e.form.payCompany=a)},null,8,["modelValue"])]),_:1}),o(m,{label:"到款类型"},{default:l(()=>[o(g,{modelValue:e.form.payType,"onUpdate:modelValue":r[1]||(r[1]=a=>e.form.payType=a)},{default:l(()=>[o(i,{label:"预定金",value:1}),o(i,{label:"首款",value:2}),o(i,{label:"二次款",value:3}),o(i,{label:"尾款",value:4}),o(i,{label:"转款",value:5})]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"到款金额"},{default:l(()=>[o(s,{modelValue:e.form.payPrice,"onUpdate:modelValue":r[2]||(r[2]=a=>e.form.payPrice=a)},null,8,["modelValue"])]),_:1}),o(m,{label:"到款时间"},{default:l(()=>[o(u,{modelValue:e.form.payTime,"onUpdate:modelValue":r[3]||(r[3]=a=>e.form.payTime=a),type:"date","value-format":"YYYY-MM-DD",placeholder:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),o(m,{label:"收款账户"},{default:l(()=>[o(s,{modelValue:e.form.account,"onUpdate:modelValue":r[4]||(r[4]=a=>e.form.account=a)},null,8,["modelValue"])]),_:1}),o(F,{gutter:20},{default:l(()=>[o(w,{span:12},{default:l(()=>[o(m,{label:"付款凭证"},{default:l(()=>[f("div",oe,[o(p,{src:e.form.payImg,"preview-src-list":[e.form.payImg],fit:"contain",style:{width:"100px",height:"100px"}},{error:l(()=>[f("div",le,x(e.form.payImg==""?"请上传图片":"加载失败"),1)]),_:1},8,["src","preview-src-list"]),o(k,{ref_key:"uploadRef1",ref:v,"show-file-list":!1,"on-success":(a,Y,q)=>{e.form.payImg=a.url},"before-upload":V,"http-request":a=>I(a,1),accept:"image/*"},{default:l(()=>[o(c,{type:"primary",loading:b.value},{default:l(()=>[_("上传文件")]),_:1},8,["loading"])]),_:1},8,["on-success","http-request"])])]),_:1})]),_:1}),o(w,{span:12},{default:l(()=>[o(m,{label:"到款凭证"},{default:l(()=>[f("div",ae,[o(p,{src:e.form.receiveImg,"preview-src-list":[e.form.receiveImg],fit:"contain",style:{width:"100px",height:"100px"}},{error:l(()=>[f("div",te,x(e.form.receiveImg==""?"请上传图片":"加载失败"),1)]),_:1},8,["src","preview-src-list"]),o(k,{ref_key:"uploadRef2",ref:E,"show-file-list":!1,"on-success":(a,Y,q)=>{e.form.receiveImg=a.url},"before-upload":V,"http-request":a=>I(a,2),accept:"image/*"},{default:l(()=>[o(c,{type:"primary",loading:h.value},{default:l(()=>[_("上传文件")]),_:1},8,["loading"])]),_:1},8,["on-success","http-request"])])]),_:1})]),_:1})]),_:1}),o(m,{label:"备注"},{default:l(()=>[o(s,{type:"textarea",modelValue:e.form.remark,"onUpdate:modelValue":r[5]||(r[5]=a=>e.form.remark=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}});export{xe as _};
