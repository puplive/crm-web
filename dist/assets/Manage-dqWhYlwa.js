import{d as Q,l as m,s as W,o as g,b as y,O as v,R as e,i as r,P as n,F as k,V as q,e as X,Y as Z,a6 as ee,L as B,h as D}from"./index-CtnNdf6I.js";import{E as le}from"./el-dialog-DEJ9dVvg.js";/* empty css                   *//* empty css                     */import{E as te}from"./el-row-CSw3K5cu.js";import{E as oe}from"./el-col-BpxPCBCU.js";/* empty css                 */import"./el-tag-KEahQFCf.js";import{a as ae,E as ie}from"./el-select-DnOT36de.js";import"./el-scrollbar-Dw8Ar6kz.js";import"./el-popper-SAL9BUsy.js";import{E as re}from"./el-pagination-Bzv--AYV.js";import{E as de,a as se}from"./el-table-column-DHpIfOkA.js";import"./el-checkbox-C2MQbk-S.js";import"./el-tooltip-l0sNRNKZ.js";import{E as ne}from"./el-progress-D_X_92wx.js";/* empty css                  */import{T as pe}from"./index-tFodNW4D.js";import{b as me,a as ue,c as fe,d as ce,e as he,f as be}from"./index-DXJLhd0_.js";import{g as _e}from"./index-CZkEka7D.js";import{g as ge}from"./index-BedJEuTf.js";/* empty css                   *//* empty css                       */import{a as s}from"./request-DHQWaQl0.js";import{E as ve}from"./index-Dvqc6v-z.js";import{E as xe}from"./index-PIZdvO1Z.js";import{E as Ee,a as Ve}from"./index-qc8ItvZn.js";import{E as we}from"./index-CjOWhDaN.js";import"./index-Bv0E6nsW.js";import"./index-Byn9vuEU.js";import"./use-form-item-BN_RNhUa.js";import"./scroll-BvKGa0_I.js";import"./vnode-gJ_8xiR2.js";import"./refs-ciGNFZLD.js";import"./event-BB_Ol6Sd.js";import"./_Uint8Array-BOmxGtCQ.js";import"./isEqual-DgFD6c0N.js";import"./castArray-BV9SS4mm.js";import"./_initCloneObject-cQg_1Bx8.js";import"./isArrayLikeObject-BxEywAV2.js";import"./cloneDeep-o7KqRFGl.js";import"./_baseClone-CuiIdAb9.js";/* empty css                                                              *//* empty css                       *//* empty css                 *//* empty css                          */import"./index-DqJoKz2d.js";import"./index-CYJzgcAt.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./arrays-6TrVLtTe.js";import"./index-DgBTPY3H.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-DCjROIz4.js";const Ce={class:"s-flex-col",style:{height:"100%"}},ye={class:"s-table-operations"},ke={class:"s-flex-auto",style:{"min-height":"0"}},Ue={class:"s-table-pagination"},Ie={class:"dialog-footer"},ql=Q({__name:"Manage",setup(Pe){Z();const f=ee().query.id,w=m([]),U=m(null),x=m(null),u=m(!1),E=m(!1),o=W({id:"",exhibitionId:f,hallCode:"",positionCode:"",standardPrice:0,specialPrice:0,specialUnit:1,length:0,width:0,remark:"",exhibitor:"",exhibitorId:""}),F={hallCode:[{required:!0,message:"请输入大厅号",trigger:"blur"}],positionCode:[{required:!0,message:"请输入位置号",trigger:"blur"}],standardPrice:[{required:!0,message:"请输入标准展位单价",trigger:"blur"},{validator:(t,l,a)=>{l<=0?a(new Error("不能小于0")):a()}}],specialPrice:[{required:!0,message:"请输入特装展位单价",trigger:"blur"},{validator:(t,l,a)=>{l<=0?a(new Error("不能小于0")):a()}}],specialUnit:[{required:!0,message:"请选择单位",trigger:"blur"}],length:[{required:!0,message:"请输入长度",trigger:"blur"},{validator:(t,l,a)=>{l<=0?a(new Error("必须大于0")):a()}}],width:[{required:!0,message:"请输入宽度",trigger:"blur"},{validator:(t,l,a)=>{l<=0?a(new Error("必须大于0")):a()}}]};let V=m([]);_e().then(t=>{t.code===0&&(V.value=t.data)});const R=m([]),b=()=>{me({exhibitionId:f}).then(t=>{t.code===0?w.value=t.data:w.value=[]})},T=async t=>{E.value=!0,u.value=!0,await B(),x.value.resetFields(),o.hallCode=t.hallCode,o.positionCode=t.positionCode,o.standardPrice=t.standardPrice,o.specialPrice=t.specialPrice,o.specialUnit=t.specialUnit.indexOf("个")>-1?2:1,o.length=t.length,o.width=t.width,o.remark=t.remark,o.exhibitor=t.exhibitor,o.id=t.id},S=()=>{let t=U.value.getSelectionRows().map(l=>l.id);if(t.length===0){s.warning("请选择需要删除的数据");return}I(t)},I=t=>{ve.confirm("此操作将永久删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{ue({id:t}).then(l=>{l.code===0?(s.success("删除成功"),b()):s.error(l.msg)})}).catch(()=>{})},M=async()=>{E.value=!1,u.value=!0,o.remark="",await B(),x.value.resetFields()},L=()=>{x.value.validate(t=>{if(t)if(E.value){let l=o;l.exhibitor=l.exhibitorId?V.value.find(a=>a.id===o.exhibitorId).name:"",fe(l).then(a=>{a.code===0?(s.success("编辑成功"),u.value=!1,b()):s.error(a.msg)})}else{let{id:l,...a}=o;a.exhibitor=a.exhibitorId?V.value.find(c=>c.id===o.exhibitorId).name:"",ce(a).then(c=>{c.code===0?(s.success("新增成功"),u.value=!1,b()):s.error(c.msg)})}else return!1})},P=m([]);ge({exhibitionId:f}).then(t=>{t.code===0&&(P.value=t.data)});const O=()=>{he({exhibitionId:f}).then(t=>{t.code===0?(window.open(t.data.url,"_self"),s.success("导出成功")):s.error(t.msg)})},N=t=>{const l=t.size/1024/1024<3;return l||s.error("文件大小不能超过 3MB!"),l},$=t=>{const l=new FormData;l.append("file",t.file),l.append("exhibitionId",f),be(l).then(a=>{a.code===0?(s.success("导入成功"),b()):s.error(a.msg)})},A=t=>{console.log(t)};return f&&b(),(t,l)=>{const a=xe,c=ne,d=de,H=se,Y=re,_=ae,C=ie,p=Ee,h=we,z=oe,j=te,G=Ve,J=le;return g(),y(k,null,[v("div",Ce,[e(pe,{data:R.value,onSearch:A},null,8,["data"]),v("div",ye,[e(a,{size:"small",onClick:M},{default:r(()=>[n("新增")]),_:1}),e(c,{style:{display:"flex","margin-left":"10px","margin-right":"10px"},"show-file-list":!1,"before-upload":N,"http-request":$},{default:r(()=>[e(a,{size:"small"},{default:r(()=>[n("导入")]),_:1})]),_:1}),e(a,{size:"small",onClick:O},{default:r(()=>[n("导出")]),_:1}),e(a,{size:"small",onClick:S},{default:r(()=>[n("删除")]),_:1})]),v("div",ke,[e(H,{ref_key:"tableRef",ref:U,data:w.value,border:"","table-layout":"fixed",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:r(()=>[e(d,{type:"selection",width:"42"}),e(d,{prop:"id",label:"ID",width:"50"}),e(d,{prop:"hallCode",label:"展馆号"}),e(d,{prop:"positionCode",label:"展位号"}),e(d,{prop:"standardPrice",label:"标摊/元","min-width":"120"}),e(d,{prop:"specialPrice",label:"特装/元","min-width":"120"}),e(d,{prop:"specialUnit",label:"特装/㎡/个","min-width":"120"}),e(d,{prop:"length",label:"长"}),e(d,{prop:"width",label:"宽"}),e(d,{prop:"remark",label:"备注"}),e(d,{prop:"exhibitor",label:"参展商"}),e(d,{prop:"createTime",label:"创建时间","min-width":"120"}),e(d,{fixed:"right",label:"操作",width:"120"},{default:r(i=>[e(a,{link:"",type:"primary",size:"small",onClick:K=>T(i.row)},{default:r(()=>[n("编辑")]),_:2},1032,["onClick"]),e(a,{link:"",type:"primary",size:"small",onClick:K=>I([i.row.id])},{default:r(()=>[n("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),v("div",Ue,[e(Y,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:1e3})])]),e(J,{modelValue:u.value,"onUpdate:modelValue":l[10]||(l[10]=i=>u.value=i),title:E.value?"编辑":"新增展位信息",width:"500",draggable:""},{footer:r(()=>[v("div",Ie,[e(a,{onClick:l[9]||(l[9]=i=>u.value=!1)},{default:r(()=>[n("取消")]),_:1}),e(a,{type:"primary",onClick:L},{default:r(()=>[n("确定")]),_:1})])]),default:r(()=>[e(G,{ref_key:"formRef",ref:x,model:o,rules:F,"label-width":"auto"},{default:r(()=>[e(p,{label:"展馆号",prop:"hallCode"},{default:r(()=>[e(C,{modelValue:o.hallCode,"onUpdate:modelValue":l[0]||(l[0]=i=>o.hallCode=i),placeholder:"请选择"},{default:r(()=>[(g(!0),y(k,null,q(P.value,i=>(g(),D(_,{key:i.code,label:i.code,value:i.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"展位号",prop:"positionCode"},{default:r(()=>[e(h,{modelValue:o.positionCode,"onUpdate:modelValue":l[1]||(l[1]=i=>o.positionCode=i),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(p,{label:"标准展位",prop:"standardPrice"},{default:r(()=>[e(h,{modelValue:o.standardPrice,"onUpdate:modelValue":l[2]||(l[2]=i=>o.standardPrice=i),autocomplete:"off",type:"number"},{append:r(()=>[n("元/个")]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"特装展位",prop:"specialPrice"},{default:r(()=>[e(h,{modelValue:o.specialPrice,"onUpdate:modelValue":l[4]||(l[4]=i=>o.specialPrice=i),autocomplete:"off",type:"number"},{append:r(()=>[e(C,{modelValue:o.specialUnit,"onUpdate:modelValue":l[3]||(l[3]=i=>o.specialUnit=i),placeholder:"请选择",style:{width:"120px"}},{default:r(()=>[e(_,{label:"元/㎡",value:1}),e(_,{label:"元/个",value:2})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(j,null,{default:r(()=>[e(z,{span:12},{default:r(()=>[e(p,{label:"长",prop:"length"},{default:r(()=>[e(h,{modelValue:o.length,"onUpdate:modelValue":l[5]||(l[5]=i=>o.length=i),autocomplete:"off",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),e(z,{span:12},{default:r(()=>[e(p,{label:"宽",prop:"width"},{default:r(()=>[e(h,{modelValue:o.width,"onUpdate:modelValue":l[6]||(l[6]=i=>o.width=i),autocomplete:"off",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,{label:"备注"},{default:r(()=>[e(h,{modelValue:o.remark,"onUpdate:modelValue":l[7]||(l[7]=i=>o.remark=i),autocomplete:"off",type:"textarea"},null,8,["modelValue"])]),_:1}),e(p,{label:"参展商",prop:"exhibitorId"},{default:r(()=>[e(C,{modelValue:o.exhibitorId,"onUpdate:modelValue":l[8]||(l[8]=i=>o.exhibitorId=i),placeholder:"请选择"},{default:r(()=>[e(_,{label:"无",value:""}),(g(!0),y(k,null,q(X(V),i=>(g(),D(_,{key:i.id,label:i.name,value:i.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])],64)}}});export{ql as default};
