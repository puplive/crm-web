import{d as I,y as M,t as u,b as f,$ as r,X as b,i as l,a7 as m,o as a,Y as d,J as w,a1 as V,Z as x,h as s,ak as p}from"./index-BG7LMbPz.js";import{E as J,a as X,_ as Y}from"./sx-CscwSk2q.js";/* empty css              */import"./tag-BxsgDYqE.js";import"./select-DcNk0NOX.js";import"./scrollbar-xaBfH7uM.js";import"./popper-R5cqvFUB.js";import{E as Z,a as q}from"./table-column-BLWQpRWR.js";import{E as A,a as H}from"./checkbox-B5sVTVQz.js";/* empty css                */import{E as K}from"./link--Q0vObNM.js";/* empty css                       */import{E as O}from"./button-DLuphGs-.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_lang-Dl78oWgH.js";/* empty css                                              */import{a as g}from"./index-CCA3igtE.js";/* empty css                *//* empty css                    *//* empty css                */import{E as W}from"./index-BlpqpxR-.js";import"./isEqual-Dii6UJBR.js";import"./_initCloneObject-DYjwbyGr.js";import"./use-form-item-7ZRTO0yW.js";import"./index-S97IM6Lh.js";import"./event-BB_Ol6Sd.js";import"./dropdown-C6o-NvvM.js";import"./scroll-DLMVdQfx.js";import"./castArray-C0fgwSex.js";import"./focus-trap-CcMYm46r.js";import"./form-item-6jvYYqHN.js";import"./_baseClone-W1Y196kT.js";/* empty css                      */import"./index-HgxG7OIY.js";import"./refs-Cs7McP6f.js";import"./index-CqxLOyh3.js";import"./vnode-Dos8Cr6u.js";import"./aria-KgdLjl5h.js";import"./validator-CFn3_VVd.js";const ee={class:"s-flex-col",style:{height:"100%"}},te={class:"s-table-operations"},oe=b("img",{style:{width:"17px"},src:Y,alt:""},null,-1),ae={class:"s-flex-auto",style:{"min-height":"0"}},le={class:"s-table-pagination"},Ze=I({__name:"Shared",setup(re){const c=M({page:1,perPage:20}),C=u(0),E=u({}),S=u([]),k=u(null),B=u([]),z=e=>{E.value=e,c.page=1,_()},_=async()=>{g.getList({status:3,...c,...E.value}).then(e=>{e.code===0&&(S.value=e.data.data,C.value=e.data.total)})},F=e=>{g.getClues({id:e}).then(o=>{o.code===0?(m.success("领取成功"),_()):m.error(o.msg)})},P=()=>{let e=k.value.getSelectionRows().map(o=>o.id);if(e.length===0){m.error("请选择需要领取的线索");return}F(e)},T=()=>{let e=k.value.getSelectionRows().map(o=>o.id);if(e.length===0){m.error("请选择需要删除的线索");return}W.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{g.del({id:e}).then(o=>{o.code===0?(m.success("删除成功"),_()):m.error(o.msg)})}).catch(()=>{})};g.getSearchField().then(e=>{e.code===0&&(B.value=e.data)});const N=u([]);(()=>{g.getCustomField().then(e=>{e.code===0&&(N.value=e.data,U())})})(),_();const h=u([]),y=u([]),U=()=>{setTimeout(()=>{let e=[];k.value.columns.forEach(o=>{o.label&&e.push(o.label)}),y.value=e.join(",").split(","),h.value=e.join(",").split(",")},0)},i=e=>h.value.length===0&&y.value.length===0?!0:h.value.includes(e);return(e,o)=>{const v=O,D=A,L=H,R=J,n=q,G=K,$=Z,j=X;return a(),f("div",ee,[r(Q,{data:B.value,onSearch:z},null,8,["data"]),b("div",te,[r(v,{onClick:P},{default:l(()=>[d("领取")]),_:1}),r(v,{onClick:T},{default:l(()=>[d("删除")]),_:1}),r(R,{placement:"bottom-end",trigger:"click"},{reference:l(()=>[r(v,{size:"",link:""},{default:l(()=>[oe]),_:1})]),default:l(()=>[r(L,{modelValue:h.value,"onUpdate:modelValue":o[0]||(o[0]=t=>h.value=t)},{default:l(()=>[b("ul",null,[(a(!0),f(w,null,V(y.value,t=>(a(),f("li",{class:"s-checkbox_item",key:t},[r(D,{label:t,value:t},{default:l(()=>[d(x(t),1)]),_:2},1032,["label","value"])]))),128))])]),_:1},8,["modelValue"])]),_:1})]),b("div",ae,[r($,{ref_key:"tableRef",ref:k,data:S.value,border:"","table-layout":"fixed",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:l(()=>[r(n,{type:"selection",width:"42"}),i("序号")?(a(),s(n,{key:0,type:"index",label:"序号",width:"60"})):p("",!0),i("企业名称")?(a(),s(n,{key:1,prop:"companyName",label:"企业名称",width:"180"},{default:l(t=>[r(G,{href:"/market/clues/info?type=1&id="+t.row.id+"&exhibitionId="+t.row.exhibitionId+"&authUser="+t.row.authUser,type:"primary"},{default:l(()=>[d(x(t.row.companyName),1)]),_:2},1032,["href"])]),_:1})):p("",!0),i("展会名称")?(a(),s(n,{key:2,prop:"exhibitionName",label:"展会名称",width:"180"})):p("",!0),i("展会联系人")?(a(),s(n,{key:3,prop:"exhibitionContact",label:"展会联系人","min-width":"120"})):p("",!0),i("职位")?(a(),s(n,{key:4,prop:"duties",label:"职位"})):p("",!0),i("手机号")?(a(),s(n,{key:5,prop:"phone",label:"手机号","min-width":"120"})):p("",!0),i("跟进状态")?(a(),s(n,{key:6,prop:"recordStatus",label:"跟进状态","min-width":"120"},{default:l(t=>[d(x({0:"无",1:"电话邀约",2:"客户拜访",3:"初步方案",4:"停滞"}[t.row.recordStatus]),1)]),_:1})):p("",!0),i("持有人")?(a(),s(n,{key:7,prop:"authUser",label:"持有人"})):p("",!0),(a(!0),f(w,null,V(N.value,t=>(a(),f(w,{key:t.key},[i(t.name)?(a(),s(n,{key:0,prop:t.key,label:t.name,"min-width":"120"},null,8,["prop","label"])):p("",!0)],64))),128)),i("操作")?(a(),s(n,{key:8,fixed:"right",label:"操作",width:"120"},{default:l(t=>[r(v,{link:"",type:"primary",onClick:ie=>F([t.row.id])},{default:l(()=>[d(" 领取 ")]),_:2},1032,["onClick"])]),_:1})):p("",!0)]),_:1},8,["data"])]),b("div",le,[r(j,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50,100],total:C.value,"current-page":c.page,"onUpdate:currentPage":o[1]||(o[1]=t=>c.page=t),"page-size":c.perPage,"onUpdate:pageSize":o[2]||(o[2]=t=>c.perPage=t),onChange:_},null,8,["total","current-page","page-size"])])])}}});export{Ze as default};
