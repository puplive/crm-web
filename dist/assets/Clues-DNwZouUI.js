import{d as J,s as K,l as i,o as h,f as k,P as p,S as t,w as a,Q as r,F as x,V as P,c as D}from"./index-Q273XHf8.js";import{E as W}from"./el-dialog-C8sC26KZ.js";/* empty css                   *//* empty css                     */import"./el-input-Dg3qt5Bb.js";import"./el-tag-DqRVPKx1.js";/* empty css                  */import"./el-scrollbar-0l_cZ0S_.js";import{E as X}from"./el-pagination-B5PtXqbH.js";import{E as Y,a as Z}from"./el-table-column-DSWDUPh9.js";import"./el-checkbox-CUmpTspT.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-button-DXeH7ULc.js";import{T as ee}from"./index-BzjwArE3.js";import{a as c}from"./index-DBmaC9vZ.js";import{e as te}from"./index-DPQZKfRy.js";import{g as le}from"./index-CbDVv6TD.js";/* empty css                   *//* empty css                       */import{E as s}from"./request-CQ37sLB9.js";import{E as oe}from"./index-BTJsYqsj.js";import{E as ae}from"./index-nVic9h1r.js";import{E as ie,a as re}from"./index-Bkne1dct.js";import{E as ne,a as se}from"./index-Bvt8dlHX.js";import"./index-CUKUieZ5.js";import"./index-CRFYaBQA.js";import"./constants-D7u2-Egf.js";import"./scroll-BIoQ-qBU.js";import"./vnode-CembcOEi.js";import"./isEqual-DPHZFWxr.js";import"./typescript-CjU46sqC.js";import"./index-j8eE0ruH.js";import"./isArrayLikeObject-BKJ0Asn3.js";/* empty css                                                              *//* empty css                       *//* empty css                 *//* empty css                          */import"./index-TOYvJhkT.js";import"./index-DM6p5gww.js";import"./arrays-6TrVLtTe.js";import"./index-mpwgweJ1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-Dg3P4JN7.js";import"./index-r5W6hzzQ.js";const ue={class:"s-flex-col",style:{height:"100%"}},de={class:"s-table-operations"},me={class:"s-flex-auto",style:{"min-height":"0"}},pe={class:"s-table-pagination"},ce={class:"dialog-footer"},fe={class:"dialog-footer"},st=J({__name:"Clues",setup(ve){const m=K({page:1,perPage:10}),E=i(0),y=i({}),C=i([]),b=i(null),S=i([]),V=i([]),M=l=>{y.value=l,m.page=1,d()},d=async()=>{c.getList({status:1,...m,...y.value}).then(l=>{l.code===0&&(C.value=l.data.data,E.value=l.data.total)})},f=i({}),v=i(!1),z=i(null),N=l=>{f.value.id=l.id,v.value=!0},$=()=>{z.value.validate(l=>{l&&c.changeIntention(f.value).then(e=>{e.code===0?(s.success("转为意向成功"),d(),v.value=!1):s.error(e.msg)})})},L=()=>{let l=b.value.getSelectionRows().map(e=>e.id);if(l.length===0){s.warning("请选择需要删除的线索");return}oe.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c.del({id:l}).then(e=>{e.code===0?(s.success("删除成功"),d()):s.error(e.msg)})}).catch(()=>{})},g=i({}),_=i(!1),F=i(null),U=i([]),q=()=>{let l=b.value.getSelectionRows().map(e=>e.id);if(l.length===0){s.warning("请选择需要转移的线索");return}g.value.id=l,_.value=!0},O=()=>{F.value.validate(l=>{l&&c.changeUser(g.value).then(e=>{e.code===0?(s.success("转移成功"),_.value=!1,d()):s.error(e.msg)})})},Q=()=>{let l=b.value.getSelectionRows().map(e=>e.id);if(l.length===0){s.warning("请选择需要移至公海的线索");return}c.changePublic({id:l}).then(e=>{e.code===0?(s.success("移至公海成功"),d()):s.error(e.msg)})},j=()=>{console.log("import")},A=()=>{console.log("export")};return c.getSearchField().then(l=>{l.code===0&&(S.value=l.data)}),te().then(l=>{l.code===0&&(V.value=l.data)}),le().then(l=>{l.code===0&&(U.value=l.data)}),d(),(l,e)=>{const n=ae,u=Y,G=Z,H=X,I=re,R=ie,w=ne,T=se,B=W;return h(),k(x,null,[p("div",ue,[t(ee,{data:S.value,onSearch:M},null,8,["data"]),p("div",de,[t(n,{size:"small",onClick:e[0]||(e[0]=o=>l.$router.push("/market/clues/add"))},{default:a(()=>[r("新增")]),_:1}),t(n,{size:"small",onClick:j},{default:a(()=>[r("导入")]),_:1}),t(n,{size:"small",onClick:A},{default:a(()=>[r("导出")]),_:1}),t(n,{size:"small",onClick:q},{default:a(()=>[r("转移给他人")]),_:1}),t(n,{size:"small",onClick:Q},{default:a(()=>[r("移至公海")]),_:1}),t(n,{size:"small",onClick:L},{default:a(()=>[r("删除")]),_:1})]),p("div",me,[t(G,{ref_key:"tableRef",ref:b,data:C.value,border:"","table-layout":"fixed",height:"100%","header-row-class-name":"s-table-header"},{default:a(()=>[t(u,{type:"selection",width:"42"}),t(u,{prop:"companyName",label:"公司名称",width:"180"}),t(u,{prop:"exhibitionContact",label:"联系方式",width:"180"}),t(u,{prop:"duties",label:"职务"}),t(u,{prop:"phone",label:"电话"}),t(u,{prop:"recordTime",label:"记录时间",width:"180"}),t(u,{prop:"recordText",label:"记录内容"}),t(u,{prop:"authUser",label:"授权人"}),t(u,{fixed:"right",label:"操作",width:"120"},{default:a(o=>[t(n,{link:"",type:"primary",size:"small",onClick:ge=>N(o.row)},{default:a(()=>[r(" 转为意向客户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),p("div",pe,[t(H,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:E.value,"current-page":m.page,"onUpdate:currentPage":e[1]||(e[1]=o=>m.page=o),"page-size":m.perPage,"onUpdate:pageSize":e[2]||(e[2]=o=>m.perPage=o),onChange:d},null,8,["total","current-page","page-size"])])]),t(B,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=o=>v.value=o),title:"转为意向客户",width:"500",draggable:""},{footer:a(()=>[p("div",ce,[t(n,{onClick:e[4]||(e[4]=o=>v.value=!1)},{default:a(()=>[r("取消")]),_:1}),t(n,{type:"primary",onClick:$},{default:a(()=>[r("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"willFormRef",ref:z,model:f.value,"label-width":"auto"},{default:a(()=>[t(w,{label:"项目",prop:"exhibitionId",rules:[{required:!0,message:"请选择项目"}]},{default:a(()=>[t(R,{modelValue:f.value.exhibitionId,"onUpdate:modelValue":e[3]||(e[3]=o=>f.value.exhibitionId=o),placeholder:""},{default:a(()=>[(h(!0),k(x,null,P(V.value,o=>(h(),D(I,{key:o.id,label:o.exhibitionName,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=o=>_.value=o),title:"转移销售线索",width:"500",draggable:""},{footer:a(()=>[p("div",fe,[t(n,{onClick:e[7]||(e[7]=o=>_.value=!1)},{default:a(()=>[r("取消")]),_:1}),t(n,{type:"primary",onClick:O},{default:a(()=>[r("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"moveFormRef",ref:F,model:g.value,"label-width":"auto"},{default:a(()=>[t(w,{label:""},{default:a(()=>[r("是否将选中的销售线索转移？")]),_:1}),t(w,{label:"销售线索所有人",prop:"userId",rules:[{required:!0,message:"请选择销售线索所有人"}]},{default:a(()=>[t(R,{modelValue:g.value.userId,"onUpdate:modelValue":e[6]||(e[6]=o=>g.value.userId=o),placeholder:""},{default:a(()=>[(h(!0),k(x,null,P(U.value,o=>(h(),D(I,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});export{st as default};
