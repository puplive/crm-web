import{d as q,t as n,y as M,o as N,h as L,i as a,X as g,$ as l,Y as c,a7 as f}from"./index-C62Y5jI7.js";import{E as S}from"./dialog-DhFPGCBL.js";/* empty css                */import{a as $,E as z}from"./form-item-C7bXw_a9.js";import{E as O}from"./row-RX20h4PI.js";import{E as X}from"./col-DLs4mIAP.js";import{E as A}from"./progress-BFD7ptVf.js";import{E as G}from"./button-BcEWd77Y.js";import{E as H}from"./image-viewer-BYcE8cxL.js";import{E as J}from"./date-picker-BLGGdf3M.js";/* empty css              */import"./scrollbar-CM8r5mxf.js";import"./popper-P6szMbtS.js";import"./tag-CmESFHCf.js";import{E as K,a as Q}from"./select-6TRvRKKL.js";import{p as W}from"./index-BAab64Nq.js";import{u as Z}from"./index-CeUYIJdx.js";/* empty css                */import{E as j}from"./index-CVJW_qQJ.js";const ee={style:{"text-align":"center"}},le={style:{"text-align":"center"}},oe={class:"dialog-footer"},Ie=q({__name:"EditPayment",emits:["callback"],setup(ae,{expose:x,emit:T}){const _=n(!1),v=n(null),E=n(null),e=M({show:!1,form:{id:0,payCompany:"",payType:0,payPrice:"",payTime:"",account:"",payImg:"",receiveImg:"",remark:""}}),C=()=>{_.value=!0,W.edit(e.form).then(t=>{t.code===0?(f.success("修改成功"),e.show=!1,P("callback")):f.error(t.msg),_.value=!1}).catch(t=>{_.value=!1})},U=t=>{e.show=!0,e.form.id=t.id,e.form.payCompany=t.payCompany,e.form.payType=t.payType,e.form.payPrice=t.payPrice,e.form.payTime=t.payTime,e.form.account=t.account,e.form.payImg=t.payImg,e.form.receiveImg=t.receiveImg,e.form.remark=t.remark},V=t=>t.size/1024/1024>3?(f.error("文件大小不能超过 3MB!"),!1):!0,b=n(!1),h=n(!1),I=(t,r)=>{let s,m;r===1?(s=b,m=v):(s=h,m=E),s.value=!0;let p=new FormData;return p.append("upload",t.file),new Promise((y,u)=>{Z(p).then(i=>{i.code===0?y(i.data):(u(i),f.error("上传失败"),m.value.clearFiles()),s.value=!1}).catch(i=>{u(i),f.error("上传失败"),m.value.clearFiles(),s.value=!1})})},P=T;return x({setEdit:U}),(t,r)=>{const s=j,m=$,p=K,y=Q,u=J,i=H,d=G,k=A,w=X,F=O,D=z,R=S;return N(),L(R,{modelValue:e.show,"onUpdate:modelValue":r[7]||(r[7]=o=>e.show=o),title:"编辑付款信息",width:"500",draggable:""},{footer:a(()=>[g("div",oe,[l(d,{onClick:r[6]||(r[6]=o=>e.show=!1)},{default:a(()=>[c("取消")]),_:1}),l(d,{type:"primary",onClick:C},{default:a(()=>[c("确定")]),_:1})])]),default:a(()=>[l(D,{ref:"willFormRef",model:e.form,"label-width":"auto","label-position":"left"},{default:a(()=>[l(m,{label:"付款公司"},{default:a(()=>[l(s,{modelValue:e.form.payCompany,"onUpdate:modelValue":r[0]||(r[0]=o=>e.form.payCompany=o)},null,8,["modelValue"])]),_:1}),l(m,{label:"到款类型"},{default:a(()=>[l(y,{modelValue:e.form.payType,"onUpdate:modelValue":r[1]||(r[1]=o=>e.form.payType=o)},{default:a(()=>[l(p,{label:"预定金",value:1}),l(p,{label:"首款",value:2}),l(p,{label:"二次款",value:3}),l(p,{label:"尾款",value:4}),l(p,{label:"转款",value:5})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"到款金额"},{default:a(()=>[l(s,{modelValue:e.form.payPrice,"onUpdate:modelValue":r[2]||(r[2]=o=>e.form.payPrice=o)},null,8,["modelValue"])]),_:1}),l(m,{label:"到款时间"},{default:a(()=>[l(u,{modelValue:e.form.payTime,"onUpdate:modelValue":r[3]||(r[3]=o=>e.form.payTime=o),type:"date","value-format":"YYYY-MM-DD",placeholder:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(m,{label:"收款账户"},{default:a(()=>[l(s,{modelValue:e.form.account,"onUpdate:modelValue":r[4]||(r[4]=o=>e.form.account=o)},null,8,["modelValue"])]),_:1}),l(F,{gutter:20},{default:a(()=>[l(w,{span:12},{default:a(()=>[l(m,{label:"付款凭证"},{default:a(()=>[g("div",ee,[l(i,{src:e.form.payImg,"preview-src-list":[e.form.payImg],fit:"contain",style:{width:"100px",height:"100px"}},null,8,["src","preview-src-list"]),l(k,{ref_key:"uploadRef1",ref:v,"show-file-list":!1,"on-success":(o,B,Y)=>{e.form.payImg=o.url},"before-upload":V,"http-request":o=>I(o,1),accept:"image/*"},{default:a(()=>[l(d,{type:"primary",loading:b.value},{default:a(()=>[c("上传文件")]),_:1},8,["loading"])]),_:1},8,["on-success","http-request"])])]),_:1})]),_:1}),l(w,{span:12},{default:a(()=>[l(m,{label:"到款凭证"},{default:a(()=>[g("div",le,[l(i,{src:e.form.receiveImg,"preview-src-list":[e.form.receiveImg],fit:"contain",style:{width:"100px",height:"100px"}},null,8,["src","preview-src-list"]),l(k,{ref_key:"uploadRef2",ref:E,"show-file-list":!1,"on-success":(o,B,Y)=>{e.form.receiveImg=o.url},"before-upload":V,"http-request":o=>I(o,2),accept:"image/*"},{default:a(()=>[l(d,{type:"primary",loading:h.value},{default:a(()=>[c("上传文件")]),_:1},8,["loading"])]),_:1},8,["on-success","http-request"])])]),_:1})]),_:1})]),_:1}),l(m,{label:"备注"},{default:a(()=>[l(s,{type:"textarea",modelValue:e.form.remark,"onUpdate:modelValue":r[5]||(r[5]=o=>e.form.remark=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}});export{Ie as _};
