import{d as I,l as _,s as R,o as x,h as B,i as t,O as w,R as o,P as f}from"./index-CtnNdf6I.js";import{E as D}from"./el-dialog-DEJ9dVvg.js";/* empty css                   *//* empty css                     */import{E as N}from"./el-progress-D_X_92wx.js";/* empty css                  *//* empty css                 *//* empty css                 */import{i as z}from"./index-D_n6cQhx.js";import{u as A}from"./index-BtD7h2aH.js";/* empty css                   */import{a as n}from"./request-DHQWaQl0.js";import{E as M}from"./index-CjOWhDaN.js";import{E as P,a as h}from"./index-qc8ItvZn.js";import{E as q,a as G}from"./index-DqJoKz2d.js";import{E as L}from"./index-PIZdvO1Z.js";const O={class:"dialog-footer"},re=I({__name:"ApplyInvoice",emits:["callback"],setup(S,{expose:V,emit:v}){const s=_(!1),i=_(null),e=R({show:!1,form:{paymentId:"",title:"",socialCode:"",contact:"",phone:"",email:"",type:"",status:"",invoiceCode:"",img:""}}),b=()=>{z.apply(e.form).then(m=>{m.code===0?(n.success("申请成功"),e.show=!1,C("callback")):n.error(m.msg)})},g=m=>{e.show=!0,e.form.paymentId=m.id,e.form.title=m.title,e.form.socialCode=m.socialCode,e.form.contact=m.contact,e.form.phone=m.phone,e.form.email=m.email,e.form.type=m.type,e.form.status=m.status,e.form.invoiceCode=m.invoiceCode,e.form.img=m.img},y=m=>m.size/1024/1024>3?(n.error("文件大小不能超过 3MB!"),!1):!0,E=m=>{s.value=!0;let l=new FormData;return l.append("upload",m.file),new Promise((d,u)=>{A(l).then(r=>{r.code===0?d(r.data):(u(r),n.error("上传失败"),i.value.clearFiles()),s.value=!1}).catch(r=>{u(r),n.error("上传失败"),i.value.clearFiles(),s.value=!1})})},C=v;return V({setApply:g}),(m,l)=>{const d=M,u=P,r=q,c=G,p=L,U=N,k=h,F=D;return x(),B(F,{modelValue:e.show,"onUpdate:modelValue":l[9]||(l[9]=a=>e.show=a),title:"申请发票",width:"500",draggable:""},{footer:t(()=>[w("div",O,[o(p,{onClick:l[8]||(l[8]=a=>e.show=!1)},{default:t(()=>[f("取消")]),_:1}),o(p,{type:"primary",onClick:b,loading:s.value},{default:t(()=>[f("确定")]),_:1},8,["loading"])])]),default:t(()=>[o(k,{ref:"willFormRef",model:e.form,"label-width":"auto"},{default:t(()=>[o(u,{label:"发票抬头"},{default:t(()=>[o(d,{modelValue:e.form.title,"onUpdate:modelValue":l[0]||(l[0]=a=>e.form.title=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(u,{label:"社会信用代码"},{default:t(()=>[o(d,{modelValue:e.form.socialCode,"onUpdate:modelValue":l[1]||(l[1]=a=>e.form.socialCode=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(u,{label:"联系人"},{default:t(()=>[o(d,{modelValue:e.form.contact,"onUpdate:modelValue":l[2]||(l[2]=a=>e.form.contact=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(u,{label:"手机号"},{default:t(()=>[o(d,{modelValue:e.form.phone,"onUpdate:modelValue":l[3]||(l[3]=a=>e.form.phone=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(u,{label:"邮箱"},{default:t(()=>[o(d,{modelValue:e.form.email,"onUpdate:modelValue":l[4]||(l[4]=a=>e.form.email=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(u,{label:"发票类型"},{default:t(()=>[o(c,{modelValue:e.form.type,"onUpdate:modelValue":l[5]||(l[5]=a=>e.form.type=a)},{default:t(()=>[o(r,{value:1},{default:t(()=>[f("电子专票")]),_:1}),o(r,{value:2},{default:t(()=>[f("电子普票")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(u,{label:"开票状态"},{default:t(()=>[o(c,{modelValue:e.form.status,"onUpdate:modelValue":l[6]||(l[6]=a=>e.form.status=a)},{default:t(()=>[o(r,{value:0},{default:t(()=>[f("待开票")]),_:1}),o(r,{value:1},{default:t(()=>[f("已开票")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(u,{label:"发票号"},{default:t(()=>[o(d,{modelValue:e.form.invoiceCode,"onUpdate:modelValue":l[7]||(l[7]=a=>e.form.invoiceCode=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(u,{label:"发票附件",prop:"img"},{default:t(()=>[o(U,{ref_key:"uploadRef",ref:i,"on-success":(a,T,$)=>{e.form.img=a.url},"before-upload":y,"http-request":E},{default:t(()=>[o(p,{link:"",type:"primary",size:"small"},{default:t(()=>[f("上传附件")]),_:1})]),_:1},8,["on-success"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}});export{re as _};
