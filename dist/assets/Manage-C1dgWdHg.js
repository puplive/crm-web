import{d as J,l as u,s as K,o as h,f as w,P as g,S as e,w as r,Q as d,F as y,W as I,a as X,Z as Y,a7 as ee,M as B,c as D}from"./index-2aYhEfiu.js";import{E as le}from"./el-dialog-Dj4d0NL7.js";/* empty css                   *//* empty css                     */import{E as te}from"./el-row-DLnKy4Mb.js";import{E as oe}from"./el-col-CNvIaGxL.js";/* empty css                 */import"./el-tag-DEQn3BBa.js";/* empty css                  */import"./el-scrollbar-JM19k7gi.js";import{E as ae}from"./el-pagination-FJ2BRzhx.js";import{E as re,a as ie}from"./el-table-column-D8USuWGl.js";import"./el-checkbox-jhWtjFty.js";import"./el-tooltip-l0sNRNKZ.js";import{E as se}from"./el-progress-D5vqklLn.js";import"./el-button-C2v4k8Zj.js";import{T as ne}from"./index-D5hd_hOH.js";import{b as de,a as pe,c as ue,d as me,e as fe,f as ce}from"./index-BvA1fgwE.js";import{g as be}from"./index-6LKIGZ3E.js";import{g as he}from"./index-DFZxZMlL.js";/* empty css                   *//* empty css                       */import{a as n}from"./request-DGY6ZXaw.js";import{E as ge}from"./index-Cyhhekyk.js";import{E as _e}from"./index-C0Xydbjt.js";import{a as ve,E as Ee}from"./index-Oru7lFDG.js";import{E as xe,a as Ve}from"./index-yKOwpRzH.js";import{E as Ce}from"./index-BBt01TFP.js";import"./index-Ga3ExfOt.js";import"./index-CEPkAMCe.js";import"./scroll-BqFvnGQ7.js";import"./vnode-Db8THcXe.js";import"./refs-ByM3bxT1.js";import"./event-BB_Ol6Sd.js";import"./typescript-CjCqGPvF.js";import"./_initCloneObject-CXsAjWMD.js";import"./isEqual-muhTt11x.js";import"./isArrayLikeObject-D0jOOsK0.js";import"./cloneDeep-COAyp7A6.js";import"./_baseClone-V1zuux7r.js";/* empty css                                                              *//* empty css                       *//* empty css                 *//* empty css                          */import"./index-BwXeZSLN.js";import"./index-Dpy4Dzp_.js";import"./arrays-6TrVLtTe.js";import"./index-qolnmvCq.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-QKlq2Y5A.js";import"./castArray-ngPrO6o4.js";const we={class:"s-flex-col",style:{height:"100%"}},ye={class:"s-table-operations"},ke={class:"s-flex-auto",style:{"min-height":"0"}},Ue={class:"s-table-pagination"},Pe={class:"dialog-footer"},ql=J({__name:"Manage",setup(qe){Y();const f=ee().query.id,x=u([]),k=u(null),_=u(null),m=u(!1),V=u(!1),o=K({id:"",exhibitionId:f,hallCode:"",positionCode:"",standardPrice:0,specialPrice:0,specialUnit:1,length:0,width:0,remark:"",exhibitor:""}),F={hallCode:[{required:!0,message:"请输入大厅号",trigger:"blur"}],positionCode:[{required:!0,message:"请输入位置号",trigger:"blur"}],standardPrice:[{required:!0,message:"请输入标准展位单价",trigger:"blur"},{validator:(t,l,i)=>{l<=0?i(new Error("不能小于0")):i()}}],specialPrice:[{required:!0,message:"请输入特装展位单价",trigger:"blur"},{validator:(t,l,i)=>{l<=0?i(new Error("不能小于0")):i()}}],specialUnit:[{required:!0,message:"请选择单位",trigger:"blur"}],length:[{required:!0,message:"请输入长度",trigger:"blur"},{validator:(t,l,i)=>{l<=0?i(new Error("必须大于0")):i()}}],width:[{required:!0,message:"请输入宽度",trigger:"blur"},{validator:(t,l,i)=>{l<=0?i(new Error("必须大于0")):i()}}],exhibitor:[{required:!0,message:"请选择展商",trigger:"blur"}]};let U=u([]);be().then(t=>{t.code===0&&(U.value=t.data)});const T=u([]),b=()=>{de({exhibitionId:f}).then(t=>{t.code===0?x.value=t.data:x.value=[]})},R=async t=>{V.value=!0,m.value=!0,await B(),_.value.resetFields(),o.hallCode=t.hallCode,o.positionCode=t.positionCode,o.standardPrice=t.standardPrice,o.specialPrice=t.specialPrice,o.specialUnit=t.specialUnit.indexOf("个")>-1?2:1,o.length=t.length,o.width=t.width,o.remark=t.remark,o.exhibitor=t.exhibitor,o.id=t.id},S=()=>{let t=k.value.getSelectionRows().map(l=>l.id);if(t.length===0){n.warning("请选择需要删除的数据");return}P(t)},P=t=>{ge.confirm("此操作将永久删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{pe({id:t}).then(l=>{l.code===0?(n.success("删除成功"),b()):n.error(l.msg)})}).catch(()=>{})},M=async()=>{V.value=!1,m.value=!0,o.remark="",await B(),_.value.resetFields()},L=()=>{_.value.validate(t=>{if(t)if(V.value)ue(o).then(i=>{i.code===0?(n.success("编辑成功"),m.value=!1,b()):n.error(i.msg)});else{let{id:l,...i}=o;me(i).then(v=>{v.code===0?(n.success("新增成功"),m.value=!1,b()):n.error(v.msg)})}else return!1})},q=u([]);he({exhibitionId:f}).then(t=>{t.code===0&&(q.value=t.data)});const N=()=>{fe({exhibitionId:f}).then(t=>{t.code===0?(window.open(t.data.url,"_self"),n.success("导出成功")):n.error(t.msg)})},O=t=>{const l=t.size/1024/1024<3;return l||n.error("文件大小不能超过 3MB!"),l},$=t=>{const l=new FormData;l.append("file",t.file),l.append("exhibitionId",f),ce(l).then(i=>{i.code===0?(n.success("导入成功"),b()):n.error(i.msg)})},A=t=>{console.log(t)};return f&&b(),(t,l)=>{const i=_e,v=se,s=re,H=ie,Q=ae,E=ve,C=Ee,p=xe,c=Ce,z=oe,W=te,Z=Ve,j=le;return h(),w(y,null,[g("div",we,[e(ne,{data:T.value,onSearch:A},null,8,["data"]),g("div",ye,[e(i,{size:"small",onClick:M},{default:r(()=>[d("新增")]),_:1}),e(v,{style:{display:"flex","margin-left":"10px","margin-right":"10px"},"show-file-list":!1,"before-upload":O,"http-request":$},{default:r(()=>[e(i,{size:"small"},{default:r(()=>[d("导入")]),_:1})]),_:1}),e(i,{size:"small",onClick:N},{default:r(()=>[d("导出")]),_:1}),e(i,{size:"small",onClick:S},{default:r(()=>[d("删除")]),_:1})]),g("div",ke,[e(H,{ref_key:"tableRef",ref:k,data:x.value,border:"","table-layout":"fixed",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:r(()=>[e(s,{type:"selection",width:"42"}),e(s,{prop:"id",label:"ID",width:"50"}),e(s,{prop:"hallCode",label:"展馆号"}),e(s,{prop:"positionCode",label:"展位号"}),e(s,{prop:"standardPrice",label:"标摊/元"}),e(s,{prop:"specialPrice",label:"特装/元"}),e(s,{prop:"specialUnit",label:"特装/㎡/个"}),e(s,{prop:"length",label:"长"}),e(s,{prop:"width",label:"宽"}),e(s,{prop:"remark",label:"备注"}),e(s,{prop:"exhibitor",label:"参展商"}),e(s,{prop:"createTime",label:"创建时间"}),e(s,{fixed:"right",label:"操作",width:"120"},{default:r(a=>[e(i,{link:"",type:"primary",size:"small",onClick:G=>R(a.row)},{default:r(()=>[d("编辑")]),_:2},1032,["onClick"]),e(i,{link:"",type:"primary",size:"small",onClick:G=>P([a.row.id])},{default:r(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),g("div",Ue,[e(Q,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:1e3})])]),e(j,{modelValue:m.value,"onUpdate:modelValue":l[10]||(l[10]=a=>m.value=a),title:"新增展位信息",width:"500",draggable:""},{footer:r(()=>[g("div",Pe,[e(i,{onClick:l[9]||(l[9]=a=>m.value=!1)},{default:r(()=>[d("取消")]),_:1}),e(i,{type:"primary",onClick:L},{default:r(()=>[d("确定")]),_:1})])]),default:r(()=>[e(Z,{ref_key:"formRef",ref:_,model:o,rules:F,"label-width":"auto"},{default:r(()=>[e(p,{label:"展馆号",prop:"hallCode"},{default:r(()=>[e(C,{modelValue:o.hallCode,"onUpdate:modelValue":l[0]||(l[0]=a=>o.hallCode=a),placeholder:"请选择"},{default:r(()=>[(h(!0),w(y,null,I(q.value,a=>(h(),D(E,{key:a.code,label:a.code,value:a.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"展位号",prop:"positionCode"},{default:r(()=>[e(c,{modelValue:o.positionCode,"onUpdate:modelValue":l[1]||(l[1]=a=>o.positionCode=a),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(p,{label:"标准展位",prop:"standardPrice"},{default:r(()=>[e(c,{modelValue:o.standardPrice,"onUpdate:modelValue":l[2]||(l[2]=a=>o.standardPrice=a),autocomplete:"off",type:"number"},{append:r(()=>[d("元/个")]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"特装展位",prop:"specialPrice"},{default:r(()=>[e(c,{modelValue:o.specialPrice,"onUpdate:modelValue":l[4]||(l[4]=a=>o.specialPrice=a),autocomplete:"off",type:"number"},{append:r(()=>[e(C,{modelValue:o.specialUnit,"onUpdate:modelValue":l[3]||(l[3]=a=>o.specialUnit=a),placeholder:"请选择",style:{width:"120px"}},{default:r(()=>[e(E,{label:"元/㎡",value:1}),e(E,{label:"元/个",value:2})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(W,null,{default:r(()=>[e(z,{span:12},{default:r(()=>[e(p,{label:"长",prop:"length"},{default:r(()=>[e(c,{modelValue:o.length,"onUpdate:modelValue":l[5]||(l[5]=a=>o.length=a),autocomplete:"off",type:"number"},null,8,["modelValue"])]),_:1})]),_:1}),e(z,{span:12},{default:r(()=>[e(p,{label:"宽",prop:"width"},{default:r(()=>[e(c,{modelValue:o.width,"onUpdate:modelValue":l[6]||(l[6]=a=>o.width=a),autocomplete:"off",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,{label:"备注"},{default:r(()=>[e(c,{modelValue:o.remark,"onUpdate:modelValue":l[7]||(l[7]=a=>o.remark=a),autocomplete:"off",type:"textarea"},null,8,["modelValue"])]),_:1}),e(p,{label:"参展商",prop:"exhibitor"},{default:r(()=>[e(C,{modelValue:o.exhibitor,"onUpdate:modelValue":l[8]||(l[8]=a=>o.exhibitor=a),placeholder:"请选择"},{default:r(()=>[(h(!0),w(y,null,I(X(U),a=>(h(),D(E,{key:a.id,label:a.name,value:a.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});export{ql as default};
