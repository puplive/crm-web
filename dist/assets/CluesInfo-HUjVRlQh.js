import{d as W,l as k,o as i,f as C,P as n,S as e,w as l,F as M,W as P,Q as u,c as x,R as p,_ as oe,$ as ae,e as ce,s as le,a as F,X as D,Z as fe,a7 as _e}from"./index-rYXJSjHO.js";import{E as se}from"./el-dialog-srVvAwvk.js";/* empty css                   *//* empty css                 */import"./el-tag-BCnVUjfS.js";/* empty css                  */import{a as ve}from"./el-scrollbar-Dc3VBZ37.js";import{E as be,a as ye}from"./el-tab-pane-BXM-hVde.js";/* empty css                     */import{E as he,a as ge}from"./el-table-column-BP1d5Idq.js";import"./el-checkbox-TEGN2b8U.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-button-yqFtCuRJ.js";/* empty css                 */import{c as te,b as G,d as we,g as Ve,e as ke,f as Ce,h as Ee,i as xe}from"./index-BlVWZPpq.js";/* empty css                   */import{a as _}from"./request-CHwQCMB7.js";import{E as ne}from"./index-B8JMf390.js";import{a as X,E as Z}from"./index-D_3gAFtR.js";import{E as H}from"./index-C5jhmULH.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as Ie}from"./index-B5PIDRBE.js";import{E as ue,a as ie}from"./index-C1sCOCWW.js";/* empty css                       */import{E as Q}from"./index-Bl1Da4Uv.js";import{E as Ne,a as Ue}from"./index-DUQDkFbX.js";import"./index-T0VhGgb7.js";import"./index-C795gJ14.js";import"./scroll-CHhzDVQi.js";import"./vnode-D7rUXEAG.js";import"./refs-TiiT8yrX.js";import"./event-BB_Ol6Sd.js";import"./_initCloneObject-BURpA47R.js";import"./isEqual-eiOngmSO.js";import"./typescript-gx-k8GPF.js";import"./index-BALNCkkw.js";import"./isArrayLikeObject-mVR8lczr.js";import"./castArray-ChZ7_KQN.js";import"./_baseClone-7pa3jfcD.js";import"./aria-KgdLjl5h.js";import"./validator-Bsy6TlaA.js";const re=E=>(oe("data-v-1e2f29a3"),E=E(),ae(),E),Te={class:"follow-up"},$e=re(()=>n("div",{class:"title"},"跟进记录",-1)),Se={class:"form"},Fe={class:"item"},Le=re(()=>n("label",null,"跟进状态",-1)),Be={class:"record"},Re={class:"list"},Ae={class:"p1"},ze={class:"p2"},De=W({__name:"FollowUp",props:["clueId"],setup(E,{expose:B}){const I=E,v=k(""),r=k(0),d=k(0),N=k(""),R=()=>{te.add({clueId:I.clueId,text:v.value,status:r.value,contactId:d.value,contactName:N.value}).then(g=>{g.code===0?(_.success("跟进记录添加成功"),U()):_.error(g.msg)})},A=k([]),U=()=>{te.getList({clueId:I.clueId}).then(g=>{g.code===0&&(A.value=g.data)})};U();const b=k([]),h=()=>{G.getList({clueId:I.clueId}).then(g=>{g.code===0&&(b.value=g.data)})};return h(),B({getContactList:h}),(g,f)=>{const o=ne,w=X,T=Z,q=H,y=ve;return i(),C("div",Te,[$e,n("div",Se,[e(o,{type:"textarea",placeholder:"请输入跟进内容",modelValue:v.value,"onUpdate:modelValue":f[0]||(f[0]=t=>v.value=t)},null,8,["modelValue"]),n("div",Fe,[Le,e(T,{modelValue:r.value,"onUpdate:modelValue":f[1]||(f[1]=t=>r.value=t),placeholder:"跟进状态"},{default:l(()=>[e(w,{label:"未跟进",value:0}),e(w,{label:"电话邀约",value:1}),e(w,{label:"客户拜访",value:2}),e(w,{label:"初步方案",value:3}),e(w,{label:"停滞",value:4})]),_:1},8,["modelValue"]),e(T,{modelValue:d.value,"onUpdate:modelValue":f[2]||(f[2]=t=>d.value=t),placeholder:"联系人",onChange:f[3]||(f[3]=t=>{if(t===0)N.value="";else{let a=b.value.find($=>$.id===t);N.value=a?a.name:""}})},{default:l(()=>[e(w,{label:"联系人",value:0}),(i(!0),C(M,null,P(b.value,t=>(i(),x(w,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(q,{type:"primary",onClick:R},{default:l(()=>[u("提交")]),_:1})])]),n("div",Be,[e(y,null,{default:l(()=>[n("ul",Re,[(i(!0),C(M,null,P(A.value,(t,a)=>(i(),C("li",{key:a,class:"item"},[n("div",Ae,p(t.time),1),n("div",ze,"（联系人："+p(t.contact)+"）"+p(t.text),1)]))),128))])]),_:1})])])}}}),Me=de(De,[["__scopeId","data-v-1e2f29a3"]]),qe={class:"dialog-footer"},Ge=W({__name:"Move",emits:["callback"],setup(E,{expose:B,emit:I}){const v=k({}),r=k(!1),d=k(null),N=k([]),R=b=>{v.value.id=b,r.value=!0},A=()=>{d.value.validate(b=>{b&&we(v.value).then(h=>{h.code===0?(_.success("转移成功"),r.value=!1,U("callback")):_.error(h.msg)})})};Ie().then(b=>{b.code===0&&(N.value=b.data)});const U=I;return B({setMove:R}),(b,h)=>{const g=ue,f=X,o=Z,w=ie,T=H,q=se;return i(),x(q,{modelValue:r.value,"onUpdate:modelValue":h[2]||(h[2]=y=>r.value=y),title:"转移销售线索",width:"500",draggable:""},{footer:l(()=>[n("div",qe,[e(T,{onClick:h[1]||(h[1]=y=>r.value=!1)},{default:l(()=>[u("取消")]),_:1}),e(T,{type:"primary",onClick:A},{default:l(()=>[u("确定")]),_:1})])]),default:l(()=>[e(w,{ref_key:"moveFormRef",ref:d,model:v.value,"label-width":"auto"},{default:l(()=>[e(g,{label:""},{default:l(()=>[u("是否将选中的销售线索转移？")]),_:1}),e(g,{label:"销售线索所有人",prop:"userId",rules:[{required:!0,message:"请选择销售线索所有人"}]},{default:l(()=>[e(o,{modelValue:v.value.userId,"onUpdate:modelValue":h[0]||(h[0]=y=>v.value.userId=y),placeholder:""},{default:l(()=>[(i(!0),C(M,null,P(N.value,y=>(i(),x(f,{key:y.id,label:y.name,value:y.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),J=E=>(oe("data-v-d414e46e"),E=E(),ae(),E),je={class:"clues-info"},Pe={class:"clues-info-header"},Oe={class:"clues-info-header-left"},Qe={class:"p1"},We={class:"p2"},Xe={key:0},Ze={key:1},He={class:"clues-info-header-right"},Je={class:"clues-info-content"},Ke={class:"clues-info-left"},Ye={style:{}},el={class:"title-bar"},ll=J(()=>n("label",{for:""},"公司信息",-1)),tl={key:0},ol={key:1},al={key:2},sl=J(()=>n("p",{style:{padding:"10px 0"}},"展位订单",-1)),nl=J(()=>n("p",{style:{padding:"10px 0","margin-top":"10px"}},"物料订单",-1)),dl={class:"clues-info-right"},ul=W({__name:"CluesInfo",setup(E){const B=fe(),I=_e(),v=I.query.type,r=I.query.id;I.query.exhibitionId;const d=k({customField:[]}),N=k([]),R=()=>{Ve().then(t=>{t.code===0&&(N.value=t.data)})},A=ce(()=>{let t=[];for(let a in d.value.customFieldTrans){let $=d.value.customFieldTrans[a],L=N.value.find(V=>V.key===a);t.push({key:a,value:$,type:L?L.type:1,name:L?L.name:""})}return t}),U=[{date:"2016-05-03",name:"Tom",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-02",name:"Tom",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-04",name:"Tom",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-01",name:"Tom",address:"No. 189, Grove St, Los Angeles"}],b=()=>{ke({id:r}).then(t=>{t.code===0&&(d.value=t.data)})},h=()=>{Q.confirm("确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ce({id:[r]}).then(t=>{t.code===0?(_.success("删除成功"),setTimeout(()=>{B.go(-1)},1e3)):_.error(t.msg)})}).catch(()=>{console.log("cancel")})},g=()=>{console.log(d.value.isNew),Ee({id:r,status:d.value.isNew}).then(t=>{t.code===0?_.success("修改成功"):_.error(t.msg)})},f=()=>{G.getList({clueId:r}).then(t=>{t.code===0&&(o.list=t.data)})},o=le({show:!1,isEdit:!1,list:[],form:{clueId:r,name:"",duties:"",type:0,mobile:"",tel:"",email:"",wechat:"",status:1},setAdd:()=>{o.show=!0,o.isEdit=!1,o.form={clueId:r,name:"",duties:"",type:0,mobile:"",tel:"",email:"",wechat:"",status:1}},setEdit:t=>{o.show=!0,o.isEdit=!0,o.form=t,o.form.clueId=r},add:()=>{G.add(o.form).then(t=>{t.code===0?(_.success("添加成功"),o.show=!1,f(),w.value.getContactList()):_.error(t.msg)})},edit:()=>{G.edit(o.form).then(t=>{t.code===0?(_.success("修改成功"),o.show=!1,f(),w.value.getContactList()):(_.error(t.msg),f())})},del:t=>{Q.confirm("确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{G.del({id:t}).then(a=>{a.code===0?(_.success("删除成功"),f(),w.value.getContactList()):_.error(a.msg)})})}}),w=k(null),T=k(null),q=()=>{Q.confirm("确定退展？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{xe({id:r}).then(t=>{t.code===0?(_.success("退展成功"),setTimeout(()=>{B.go(-1)},1e3)):_.error(t.msg)})})},y=le({activeName:1,change:t=>{y.activeName=t,t===1&&(R(),f()),b()}});return b(),R(),f(),(t,a)=>{const $=Ne,L=Ue,V=H,c=ue,m=he,j=ge,K=ie,O=be,me=ye,z=ne,S=X,Y=Z,pe=se;return i(),C(M,null,[n("div",je,[n("div",Pe,[n("div",Oe,[n("div",Qe,p(d.value.companyName),1),n("div",We,[F(v)==="2"?(i(),C("span",Xe,"所属展商："+p(d.value.companyName),1)):D("",!0),F(v)==="2"?(i(),C("span",Ze,[u("新展商： "),e(L,{"model-value":d.value.isNew,"onUpdate:modelValue":a[0]||(a[0]=s=>d.value.isNew=s),onChange:g},{default:l(()=>[e($,{value:!0,style:{"margin-right":"10px"}},{default:l(()=>[u("是")]),_:1}),e($,{value:!1},{default:l(()=>[u("否")]),_:1})]),_:1},8,["model-value"])])):D("",!0),n("span",null,"客户经理："+p(d.value.authUser),1)])]),n("div",He,[F(v)==="2"?(i(),C(M,{key:0},[d.value.isExit?(i(),x(V,{key:0,type:"info",size:"small",plain:"",disabled:""},{default:l(()=>[u("已退展")]),_:1})):(i(),x(V,{key:1,type:"primary",size:"small",onClick:q},{default:l(()=>[u("退展")]),_:1}))],64)):D("",!0),e(V,{type:"primary",size:"small",onClick:a[1]||(a[1]=()=>{T.value.setMove([F(r)])})},{default:l(()=>[u("转他人")]),_:1})])]),n("div",Je,[n("div",Ke,[e(me,{modelValue:y.activeName,"onUpdate:modelValue":a[3]||(a[3]=s=>y.activeName=s),onTabChange:y.change,type:"border-card",class:"demo-tabs",style:{height:"100%"}},{default:l(()=>[e(O,{label:"资料",name:1},{default:l(()=>[n("div",Ye,[e(K,{ref_key:"form",ref:d,"label-width":"auto"},{default:l(()=>[n("div",el,[ll,e(V,{type:"default",onClick:a[2]||(a[2]=s=>t.$router.push({name:"CluesEdit",query:{id:F(r)}})),size:"small"},{default:l(()=>[u("编辑")]),_:1}),e(V,{type:"default",onClick:h,size:"small"},{default:l(()=>[u("删除")]),_:1})]),e(c,{label:"企业名称"},{default:l(()=>[n("span",null,p(d.value.companyName),1)]),_:1}),e(c,{label:"联系人"},{default:l(()=>[n("span",null,p(d.value.contactName),1)]),_:1}),e(c,{label:"国家"},{default:l(()=>[n("span",null,p(d.value.country),1)]),_:1}),e(c,{label:"省份"},{default:l(()=>[n("span",null,p(d.value.province),1)]),_:1}),e(c,{label:"城市"},{default:l(()=>[n("span",null,p(d.value.city),1)]),_:1}),e(c,{label:"详细地址",prop:"address"},{default:l(()=>[n("span",null,p(d.value.address),1)]),_:1}),e(c,{label:"企业品牌",prop:""},{default:l(()=>[n("span",null,p(d.value.companyBrand&&d.value.companyBrand.length>0?d.value.companyBrand.join(","):""),1)]),_:1}),(i(!0),C(M,null,P(A.value,(s,ee)=>(i(),x(c,{key:s.key,label:s.name},{default:l(()=>[s.type===5?(i(),C("span",tl,p(s.value.join("，")),1)):s.type===7?(i(),C("span",ol,p(s.value.join("，")),1)):(i(),C("span",al,p(s.value),1))]),_:2},1032,["label"]))),128)),e(c,{label:"参展联系人",prop:""},{default:l(()=>[e(V,{size:"small",onClick:o.setAdd},{default:l(()=>[u("添加")]),_:1},8,["onClick"])]),_:1}),e(j,{border:"",data:o.list,"show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:l(()=>[e(m,{prop:"name",label:"姓名"}),e(m,{prop:"duties",label:"职务"}),e(m,{prop:"type",label:"类别"},{default:l(s=>[u(p(["无","展位","财务","市场","现场"][s.row.type]),1)]),_:1}),e(m,{prop:"mobile",label:"手机号"}),e(m,{prop:"tel",label:"电话"}),e(m,{prop:"email",label:"邮箱"}),e(m,{prop:"wechat",label:"微信"}),e(m,{prop:"status",label:"在职状态"},{default:l(s=>[u(p(["","在职","离职","调岗"][s.row.status]),1)]),_:1}),e(m,{prop:"isExhibitionContact",label:"展会联系人"},{default:l(s=>[u(p(s.row.isExhibitionContact===1?"是":"否"),1)]),_:1}),e(m,{label:"操作",fixed:"right",width:"150"},{default:l(s=>[e(V,{type:"text",size:"small",onClick:ee=>o.setEdit(s.row)},{default:l(()=>[u("编辑")]),_:2},1032,["onClick"]),e(V,{type:"text",size:"small",onClick:ee=>o.del(s.row.id)},{default:l(()=>[u("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},512)])]),_:1}),F(v)==="2"?(i(),x(O,{key:0,label:"订单",name:2},{default:l(()=>[n("div",null,[e(V,{type:"primary"},{default:l(()=>[u("签订合同")]),_:1})]),sl,e(j,{data:U,border:"","show-overflow-tooltip":""},{default:l(()=>[e(m,{prop:"date",label:"Date",width:"180"}),e(m,{prop:"name",label:"Name",width:"180"}),e(m,{prop:"address",label:"Address"})]),_:1}),nl,e(j,{data:U,border:"","show-overflow-tooltip":""},{default:l(()=>[e(m,{prop:"date",label:"Date",width:"180"}),e(m,{prop:"name",label:"Name",width:"180"}),e(m,{prop:"address",label:"Address"})]),_:1})]),_:1})):D("",!0),F(v)==="2"?(i(),x(O,{key:1,label:"合同",name:3},{default:l(()=>[e(j,{data:U,border:"","show-overflow-tooltip":""},{default:l(()=>[e(m,{prop:"date",label:"Date",width:"180"}),e(m,{prop:"name",label:"Name",width:"180"}),e(m,{prop:"address",label:"Address"})]),_:1})]),_:1})):D("",!0)]),_:1},8,["modelValue","onTabChange"])]),n("div",dl,[e(Me,{ref_key:"followUp",ref:w,clueId:F(r)},null,8,["clueId"])])])]),e(pe,{title:o.isEdit?"编辑":"添加联系人",modelValue:o.show,"onUpdate:modelValue":a[14]||(a[14]=s=>o.show=s),width:"500px"},{footer:l(()=>[e(V,{type:"default",onClick:a[13]||(a[13]=s=>o.show=!1)},{default:l(()=>[u("取消")]),_:1}),o.isEdit?(i(),x(V,{key:0,type:"primary",onClick:o.edit},{default:l(()=>[u("修改")]),_:1},8,["onClick"])):(i(),x(V,{key:1,type:"primary",onClick:o.add},{default:l(()=>[u("添加")]),_:1},8,["onClick"]))]),default:l(()=>[e(K,{model:o.form,"label-width":"auto"},{default:l(()=>[e(c,{label:"姓名"},{default:l(()=>[e(z,{modelValue:o.form.name,"onUpdate:modelValue":a[4]||(a[4]=s=>o.form.name=s)},null,8,["modelValue"])]),_:1}),e(c,{label:"职务"},{default:l(()=>[e(z,{modelValue:o.form.duties,"onUpdate:modelValue":a[5]||(a[5]=s=>o.form.duties=s)},null,8,["modelValue"])]),_:1}),e(c,{label:"类别"},{default:l(()=>[e(Y,{modelValue:o.form.type,"onUpdate:modelValue":a[6]||(a[6]=s=>o.form.type=s)},{default:l(()=>[e(S,{label:"无",value:0}),e(S,{label:"展位",value:1}),e(S,{label:"财务",value:2}),e(S,{label:"市场",value:3}),e(S,{label:"现场",value:4})]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"手机号"},{default:l(()=>[e(z,{modelValue:o.form.mobile,"onUpdate:modelValue":a[7]||(a[7]=s=>o.form.mobile=s)},null,8,["modelValue"])]),_:1}),e(c,{label:"电话"},{default:l(()=>[e(z,{modelValue:o.form.tel,"onUpdate:modelValue":a[8]||(a[8]=s=>o.form.tel=s)},null,8,["modelValue"])]),_:1}),e(c,{label:"邮箱"},{default:l(()=>[e(z,{modelValue:o.form.email,"onUpdate:modelValue":a[9]||(a[9]=s=>o.form.email=s)},null,8,["modelValue"])]),_:1}),e(c,{label:"微信"},{default:l(()=>[e(z,{modelValue:o.form.wechat,"onUpdate:modelValue":a[10]||(a[10]=s=>o.form.wechat=s)},null,8,["modelValue"])]),_:1}),e(c,{label:"在职状态"},{default:l(()=>[e(Y,{modelValue:o.form.status,"onUpdate:modelValue":a[11]||(a[11]=s=>o.form.status=s)},{default:l(()=>[e(S,{label:"在职",value:1}),e(S,{label:"离职",value:2}),e(S,{label:"调岗",value:3})]),_:1},8,["modelValue"])]),_:1}),o.isEdit?(i(),x(c,{key:0,label:"展会联系人"},{default:l(()=>[e(L,{modelValue:o.form.isExhibitionContact,"onUpdate:modelValue":a[12]||(a[12]=s=>o.form.isExhibitionContact=s),class:"ml-4"},{default:l(()=>[e($,{value:1},{default:l(()=>[u("是")]),_:1}),e($,{value:0},{default:l(()=>[u("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})):D("",!0)]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),e(Ge,{ref_key:"moveRef",ref:T,onCallback:b},null,512)],64)}}}),Hl=de(ul,[["__scopeId","data-v-d414e46e"]]);export{Hl as default};
