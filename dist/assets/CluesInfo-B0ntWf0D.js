import{d as W,l as k,o as u,f as C,P as n,S as e,w as l,F as D,W as P,Q as i,c as x,R as p,_ as oe,$ as ae,e as ce,s as le,a as S,X as q,Z as fe,a7 as _e}from"./index-DwAgI1Tl.js";import{E as se}from"./el-dialog-DMsbJQVF.js";/* empty css                   *//* empty css                 */import"./el-tag-D6VPebGv.js";/* empty css                  */import{a as ve}from"./el-scrollbar-DTrg2_7X.js";import{E as be,a as ye}from"./el-tab-pane-BfJ08zyz.js";/* empty css                     */import{E as he,a as ge}from"./el-table-column-CvwqpgAn.js";import"./el-checkbox-CRfvpewy.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-button-GUz3KSyk.js";/* empty css                 */import{c as te,b as G,d as we,g as Ve,e as ke,f as Ce,h as Ee,i as xe}from"./index-Ds0FgR9u.js";/* empty css                   */import{a as _}from"./request-BwuiVass.js";import{E as ne}from"./index-GYZblRXP.js";import{a as X,E as Z}from"./index-C036lfxA.js";import{E as H}from"./index-lrMaDoJ7.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as Ie}from"./index-ybtfLND-.js";import{E as ue,a as re}from"./index-nY2QOu6q.js";/* empty css                       */import{E as Q}from"./index-CDOkj85A.js";import{E as Ne,a as Ue}from"./index-C9PHBgDn.js";import"./index-BbG6rCDq.js";import"./index-D16Dp-E5.js";import"./scroll-JpeTjL8h.js";import"./vnode-D3ksiN5I.js";import"./refs-Dc-3pehd.js";import"./event-BB_Ol6Sd.js";import"./_initCloneObject-l7c9p7aB.js";import"./isEqual-zCtjQBmP.js";import"./typescript-CxgQ9MvV.js";import"./index-hKUcKImx.js";import"./isArrayLikeObject-Bza-7IAp.js";import"./castArray-BpHTYSK8.js";import"./_baseClone-sCyLxnY1.js";import"./aria-KgdLjl5h.js";import"./validator-BLI_r8Zw.js";const ie=E=>(oe("data-v-1e2f29a3"),E=E(),ae(),E),Te={class:"follow-up"},$e=ie(()=>n("div",{class:"title"},"跟进记录",-1)),Se={class:"form"},Fe={class:"item"},Le=ie(()=>n("label",null,"跟进状态",-1)),Be={class:"record"},Re={class:"list"},Ae={class:"p1"},ze={class:"p2"},De=W({__name:"FollowUp",props:["clueId"],setup(E,{expose:F}){const I=E,v=k(""),r=k(0),d=k(0),N=k(""),L=()=>{te.add({clueId:I.clueId,text:v.value,status:r.value,contactId:d.value,contactName:N.value}).then(g=>{g.code===0?(_.success("跟进记录添加成功"),U()):_.error(g.msg)})},B=k([]),U=()=>{te.getList({clueId:I.clueId}).then(g=>{g.code===0&&(B.value=g.data)})};U();const b=k([]),h=()=>{G.getList({clueId:I.clueId}).then(g=>{g.code===0&&(b.value=g.data)})};return h(),F({getContactList:h}),(g,c)=>{const o=ne,w=X,T=Z,M=H,y=ve;return u(),C("div",Te,[$e,n("div",Se,[e(o,{type:"textarea",placeholder:"请输入跟进内容",modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=t=>v.value=t)},null,8,["modelValue"]),n("div",Fe,[Le,e(T,{modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=t=>r.value=t),placeholder:"跟进状态"},{default:l(()=>[e(w,{label:"未跟进",value:0}),e(w,{label:"电话邀约",value:1}),e(w,{label:"客户拜访",value:2}),e(w,{label:"初步方案",value:3}),e(w,{label:"停滞",value:4})]),_:1},8,["modelValue"]),e(T,{modelValue:d.value,"onUpdate:modelValue":c[2]||(c[2]=t=>d.value=t),placeholder:"联系人",onChange:c[3]||(c[3]=t=>{if(t===0)N.value="";else{let a=b.value.find(R=>R.id===t);N.value=a?a.name:""}})},{default:l(()=>[e(w,{label:"联系人",value:0}),(u(!0),C(D,null,P(b.value,t=>(u(),x(w,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(M,{type:"primary",onClick:L},{default:l(()=>[i("提交")]),_:1})])]),n("div",Be,[e(y,null,{default:l(()=>[n("ul",Re,[(u(!0),C(D,null,P(B.value,(t,a)=>(u(),C("li",{key:a,class:"item"},[n("div",Ae,p(t.time),1),n("div",ze,"（联系人："+p(t.contact)+"）"+p(t.text),1)]))),128))])]),_:1})])])}}}),Me=de(De,[["__scopeId","data-v-1e2f29a3"]]),qe={class:"dialog-footer"},Ge=W({__name:"Move",emits:["callback"],setup(E,{expose:F,emit:I}){const v=k({}),r=k(!1),d=k(null),N=k([]),L=b=>{v.value.id=b,r.value=!0},B=()=>{d.value.validate(b=>{b&&we(v.value).then(h=>{h.code===0?(_.success("转移成功"),r.value=!1,U("callback")):_.error(h.msg)})})};Ie().then(b=>{b.code===0&&(N.value=b.data)});const U=I;return F({setMove:L}),(b,h)=>{const g=ue,c=X,o=Z,w=re,T=H,M=se;return u(),x(M,{modelValue:r.value,"onUpdate:modelValue":h[2]||(h[2]=y=>r.value=y),title:"转移销售线索",width:"500",draggable:""},{footer:l(()=>[n("div",qe,[e(T,{onClick:h[1]||(h[1]=y=>r.value=!1)},{default:l(()=>[i("取消")]),_:1}),e(T,{type:"primary",onClick:B},{default:l(()=>[i("确定")]),_:1})])]),default:l(()=>[e(w,{ref_key:"moveFormRef",ref:d,model:v.value,"label-width":"auto"},{default:l(()=>[e(g,{label:""},{default:l(()=>[i("是否将选中的销售线索转移？")]),_:1}),e(g,{label:"销售线索所有人",prop:"userId",rules:[{required:!0,message:"请选择销售线索所有人"}]},{default:l(()=>[e(o,{modelValue:v.value.userId,"onUpdate:modelValue":h[0]||(h[0]=y=>v.value.userId=y),placeholder:""},{default:l(()=>[(u(!0),C(D,null,P(N.value,y=>(u(),x(c,{key:y.id,label:y.name,value:y.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),J=E=>(oe("data-v-a6004c4e"),E=E(),ae(),E),je={class:"clues-info"},Pe={class:"clues-info-header"},Oe={class:"clues-info-header-left"},Qe={class:"p1"},We={class:"p2"},Xe={key:0},Ze={key:1},He={class:"clues-info-header-right"},Je={class:"clues-info-content"},Ke={class:"clues-info-left"},Ye={style:{}},el={class:"title-bar"},ll=J(()=>n("label",{for:""},"公司信息",-1)),tl={key:0},ol={key:1},al={key:2},sl=J(()=>n("p",{style:{padding:"10px 0"}},"展位订单",-1)),nl=J(()=>n("p",{style:{padding:"10px 0","margin-top":"10px"}},"物料订单",-1)),dl={class:"clues-info-right"},ul=W({__name:"CluesInfo",setup(E){const F=fe(),I=_e(),v=I.query.type,r=I.query.id;I.query.exhibitionId;const d=k({customField:[]}),N=k([]),L=()=>{Ve().then(t=>{t.code===0&&(N.value=t.data)})},B=ce(()=>{let t=[];for(let a in d.value.customFieldTrans){let R=d.value.customFieldTrans[a],A=N.value.find(V=>V.key===a);t.push({key:a,value:R,type:A?A.type:1,name:A?A.name:""})}return t}),U=[{date:"2016-05-03",name:"Tom",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-02",name:"Tom",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-04",name:"Tom",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-01",name:"Tom",address:"No. 189, Grove St, Los Angeles"}],b=()=>{ke({id:r}).then(t=>{t.code===0&&(d.value=t.data)})},h=()=>{Q.confirm("确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ce({id:[r]}).then(t=>{t.code===0?(_.success("删除成功"),setTimeout(()=>{F.go(-1)},1e3)):_.error(t.msg)})}).catch(()=>{console.log("cancel")})},g=()=>{console.log(d.value.isNew),Ee({id:r,status:d.value.isNew}).then(t=>{t.code===0?_.success("修改成功"):_.error(t.msg)})},c=()=>{G.getList({clueId:r}).then(t=>{t.code===0&&(o.list=t.data)})},o=le({show:!1,isEdit:!1,list:[],form:{clueId:r,name:"",duties:"",type:0,mobile:"",tel:"",email:"",wechat:"",status:1},setAdd:()=>{o.show=!0,o.isEdit=!1,o.form={clueId:r,name:"",duties:"",type:0,mobile:"",tel:"",email:"",wechat:"",status:1}},setEdit:t=>{o.show=!0,o.isEdit=!0,o.form=t,o.form.clueId=r},add:()=>{G.add(o.form).then(t=>{t.code===0?(_.success("添加成功"),o.show=!1,c(),w.value.getContactList()):_.error(t.msg)})},edit:()=>{G.edit(o.form).then(t=>{t.code===0?(_.success("修改成功"),o.show=!1,c(),w.value.getContactList()):(_.error(t.msg),c())})},del:t=>{Q.confirm("确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{G.del({id:t}).then(a=>{a.code===0?(_.success("删除成功"),c(),w.value.getContactList()):_.error(a.msg)})})}}),w=k(null),T=k(null),M=()=>{Q.confirm("确定退展？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{xe({id:r}).then(t=>{t.code===0?(_.success("退展成功"),setTimeout(()=>{F.go(-1)},1e3)):_.error(t.msg)})})},y=le({activeName:1,change:t=>{y.activeName=t,t===1&&(L(),c()),b()}});return b(),L(),c(),(t,a)=>{const R=Ne,A=Ue,V=H,f=ue,m=he,j=ge,K=re,O=be,me=ye,z=ne,$=X,Y=Z,pe=se;return u(),C(D,null,[n("div",je,[n("div",Pe,[n("div",Oe,[n("div",Qe,p(d.value.companyName),1),n("div",We,[S(v)==="2"?(u(),C("span",Xe,"所属展商："+p(d.value.companyName),1)):q("",!0),S(v)==="2"?(u(),C("span",Ze,[i("新展商： "),e(A,{"model-value":d.value.isNew,"onUpdate:modelValue":a[0]||(a[0]=s=>d.value.isNew=s),onChange:g},{default:l(()=>[e(R,{value:!0,style:{"margin-right":"10px"}},{default:l(()=>[i("是")]),_:1}),e(R,{value:!1},{default:l(()=>[i("否")]),_:1})]),_:1},8,["model-value"])])):q("",!0),n("span",null,"客户经理："+p(d.value.authUser),1)])]),n("div",He,[S(v)==="2"?(u(),C(D,{key:0},[d.value.isExit?(u(),x(V,{key:0,type:"info",size:"small",plain:"",disabled:""},{default:l(()=>[i("已退展")]),_:1})):(u(),x(V,{key:1,type:"primary",size:"small",onClick:M},{default:l(()=>[i("退展")]),_:1}))],64)):q("",!0),e(V,{type:"primary",size:"small",onClick:a[1]||(a[1]=()=>{T.value.setMove([S(r)])})},{default:l(()=>[i("转他人")]),_:1})])]),n("div",Je,[n("div",Ke,[e(me,{modelValue:y.activeName,"onUpdate:modelValue":a[3]||(a[3]=s=>y.activeName=s),onTabChange:y.change,type:"border-card",class:"demo-tabs",style:{height:"100%"}},{default:l(()=>[e(O,{label:"资料",name:1},{default:l(()=>[n("div",Ye,[e(K,{ref_key:"form",ref:d,"label-width":"auto"},{default:l(()=>[n("div",el,[ll,e(V,{type:"default",onClick:a[2]||(a[2]=s=>t.$router.push({name:"CluesEdit",query:{id:S(r)}})),size:"small"},{default:l(()=>[i("编辑")]),_:1}),e(V,{type:"default",onClick:h,size:"small"},{default:l(()=>[i("删除")]),_:1})]),e(f,{label:"企业名称"},{default:l(()=>[n("span",null,p(d.value.companyName),1)]),_:1}),e(f,{label:"联系人"},{default:l(()=>[n("span",null,p(d.value.contactName),1)]),_:1}),e(f,{label:"国家"},{default:l(()=>[n("span",null,p(d.value.country),1)]),_:1}),e(f,{label:"省份"},{default:l(()=>[n("span",null,p(d.value.province),1)]),_:1}),e(f,{label:"城市"},{default:l(()=>[n("span",null,p(d.value.city),1)]),_:1}),e(f,{label:"详细地址",prop:"address"},{default:l(()=>[n("span",null,p(d.value.address),1)]),_:1}),e(f,{label:"企业品牌",prop:""},{default:l(()=>[n("span",null,p(d.value.companyBrand&&d.value.companyBrand.length>0?d.value.companyBrand.join(","):""),1)]),_:1}),(u(!0),C(D,null,P(B.value,(s,ee)=>(u(),x(f,{key:s.key,label:s.name},{default:l(()=>[s.type===5?(u(),C("span",tl,p(s.value.join("，")),1)):s.type===7?(u(),C("span",ol,p(s.value.join("，")),1)):(u(),C("span",al,p(s.value),1))]),_:2},1032,["label"]))),128)),e(f,{label:"参展联系人",prop:""},{default:l(()=>[e(V,{size:"small",onClick:o.setAdd},{default:l(()=>[i("添加")]),_:1},8,["onClick"])]),_:1}),e(j,{border:"",data:o.list,"show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:l(()=>[e(m,{prop:"name",label:"姓名"}),e(m,{prop:"duties",label:"职务"}),e(m,{prop:"type",label:"类别"},{default:l(s=>[i(p(["无","展位","财务","市场","现场"][s.row.type]),1)]),_:1}),e(m,{prop:"mobile",label:"手机号"}),e(m,{prop:"tel",label:"电话"}),e(m,{prop:"email",label:"邮箱"}),e(m,{prop:"wechat",label:"微信"}),e(m,{prop:"status",label:"在职状态"},{default:l(s=>[i(p(["","在职","离职","调岗"][s.row.status]),1)]),_:1}),e(m,{prop:"isExhibitionContact",label:"展会联系人"}),e(m,{label:"操作",fixed:"right",width:"150"},{default:l(s=>[e(V,{type:"text",size:"small",onClick:ee=>o.setEdit(s.row)},{default:l(()=>[i("编辑")]),_:2},1032,["onClick"]),e(V,{type:"text",size:"small",onClick:ee=>o.del(s.row.id)},{default:l(()=>[i("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},512)])]),_:1}),S(v)==="2"?(u(),x(O,{key:0,label:"订单",name:2},{default:l(()=>[n("div",null,[e(V,{type:"primary"},{default:l(()=>[i("签订合同")]),_:1})]),sl,e(j,{data:U,border:"","show-overflow-tooltip":""},{default:l(()=>[e(m,{prop:"date",label:"Date",width:"180"}),e(m,{prop:"name",label:"Name",width:"180"}),e(m,{prop:"address",label:"Address"})]),_:1}),nl,e(j,{data:U,border:"","show-overflow-tooltip":""},{default:l(()=>[e(m,{prop:"date",label:"Date",width:"180"}),e(m,{prop:"name",label:"Name",width:"180"}),e(m,{prop:"address",label:"Address"})]),_:1})]),_:1})):q("",!0),S(v)==="2"?(u(),x(O,{key:1,label:"合同",name:3},{default:l(()=>[e(j,{data:U,border:"","show-overflow-tooltip":""},{default:l(()=>[e(m,{prop:"date",label:"Date",width:"180"}),e(m,{prop:"name",label:"Name",width:"180"}),e(m,{prop:"address",label:"Address"})]),_:1})]),_:1})):q("",!0)]),_:1},8,["modelValue","onTabChange"])]),n("div",dl,[e(Me,{ref_key:"followUp",ref:w,clueId:S(r)},null,8,["clueId"])])])]),e(pe,{title:o.isEdit?"编辑":"添加联系人",modelValue:o.show,"onUpdate:modelValue":a[13]||(a[13]=s=>o.show=s),width:"500px"},{footer:l(()=>[e(V,{type:"default",onClick:a[12]||(a[12]=s=>o.show=!1)},{default:l(()=>[i("取消")]),_:1}),o.isEdit?(u(),x(V,{key:0,type:"primary",onClick:o.edit},{default:l(()=>[i("修改")]),_:1},8,["onClick"])):(u(),x(V,{key:1,type:"primary",onClick:o.add},{default:l(()=>[i("添加")]),_:1},8,["onClick"]))]),default:l(()=>[e(K,{model:o.form,"label-width":"auto"},{default:l(()=>[e(f,{label:"姓名"},{default:l(()=>[e(z,{modelValue:o.form.name,"onUpdate:modelValue":a[4]||(a[4]=s=>o.form.name=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"职务"},{default:l(()=>[e(z,{modelValue:o.form.duties,"onUpdate:modelValue":a[5]||(a[5]=s=>o.form.duties=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"类别"},{default:l(()=>[e(Y,{modelValue:o.form.type,"onUpdate:modelValue":a[6]||(a[6]=s=>o.form.type=s)},{default:l(()=>[e($,{label:"无",value:0}),e($,{label:"展位",value:1}),e($,{label:"财务",value:2}),e($,{label:"市场",value:3}),e($,{label:"现场",value:4})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"手机号"},{default:l(()=>[e(z,{modelValue:o.form.mobile,"onUpdate:modelValue":a[7]||(a[7]=s=>o.form.mobile=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"电话"},{default:l(()=>[e(z,{modelValue:o.form.tel,"onUpdate:modelValue":a[8]||(a[8]=s=>o.form.tel=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"邮箱"},{default:l(()=>[e(z,{modelValue:o.form.email,"onUpdate:modelValue":a[9]||(a[9]=s=>o.form.email=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"微信"},{default:l(()=>[e(z,{modelValue:o.form.wechat,"onUpdate:modelValue":a[10]||(a[10]=s=>o.form.wechat=s)},null,8,["modelValue"])]),_:1}),e(f,{label:"在职状态"},{default:l(()=>[e(Y,{modelValue:o.form.status,"onUpdate:modelValue":a[11]||(a[11]=s=>o.form.status=s)},{default:l(()=>[e($,{label:"在职",value:1}),e($,{label:"离职",value:2}),e($,{label:"调岗",value:3})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),e(Ge,{ref_key:"moveRef",ref:T,onCallback:b},null,512)],64)}}}),Hl=de(ul,[["__scopeId","data-v-a6004c4e"]]);export{Hl as default};
