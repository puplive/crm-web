import{d as H,s as J,l as i,o as h,f as k,P as p,S as t,w as a,Q as r,F as x,W as P,c as D}from"./index-g75ufP7d.js";import{E as K}from"./el-dialog-DSAGb08e.js";/* empty css                   *//* empty css                     */import"./el-input-D8XJmPrM.js";import"./el-tag-3xTPL-an.js";/* empty css                  */import"./el-scrollbar-CB0aBKmB.js";import{E as X}from"./el-pagination-C6INOyPw.js";import{E as Y,a as Z}from"./el-table-column-C7JUfLOg.js";import"./el-checkbox-BJ8UZ24J.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-button-CNOJgwLG.js";import{T as ee}from"./index-BiYq8-Zs.js";import{a as c}from"./index-BstPB4bA.js";import{e as te}from"./index-Cwi4Elpn.js";import{g as oe}from"./index-ExE_VvKT.js";/* empty css                   *//* empty css                       */import{E as s}from"./request--uz8TcEF.js";import{E as le}from"./index-BboYzVDa.js";import{E as ae}from"./index-D8caOcpg.js";import{E as ie,a as re}from"./index-CgK-lu4a.js";import{E as ne,a as se}from"./index-uMw6JbdF.js";import"./index-DjBQj6k2.js";import"./index-CQOAdKLS.js";import"./scroll-BzbWq0HX.js";import"./vnode-DqEnQ7T-.js";import"./refs-BBkqgsFQ.js";import"./event-BB_Ol6Sd.js";import"./isEqual-DI1axKtC.js";import"./typescript-BiM07qGq.js";import"./index-DooEcWLP.js";import"./isArrayLikeObject-DwSHuVlJ.js";/* empty css                                                              *//* empty css                       *//* empty css                 *//* empty css                          */import"./index-D8plI_pv.js";import"./index-rws0KOBe.js";import"./arrays-6TrVLtTe.js";import"./index-Cvhn5ebx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-uMnuo2_2.js";import"./castArray-BAmbttlM.js";const ue={class:"s-flex-col",style:{height:"100%"}},me={class:"s-table-operations"},de={class:"s-flex-auto",style:{"min-height":"0"}},pe={class:"s-table-pagination"},ce={class:"dialog-footer"},fe={class:"dialog-footer"},ut=H({__name:"Clues",setup(ve){const d=J({page:1,perPage:10}),E=i(0),y=i({}),C=i([]),b=i(null),S=i([]),V=i([]),M=o=>{y.value=o,d.page=1,m()},m=async()=>{c.getList({status:1,...d,...y.value}).then(o=>{o.code===0&&(C.value=o.data.data,E.value=o.data.total)})},f=i({}),v=i(!1),z=i(null),N=o=>{f.value.id=o.id,v.value=!0},$=()=>{z.value.validate(o=>{o&&c.changeIntention(f.value).then(e=>{e.code===0?(s.success("转为意向成功"),m(),v.value=!1):s.error(e.msg)})})},L=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){s.warning("请选择需要删除的线索");return}le.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c.del({id:o}).then(e=>{e.code===0?(s.success("删除成功"),m()):s.error(e.msg)})}).catch(()=>{})},g=i({}),_=i(!1),F=i(null),U=i([]),q=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){s.warning("请选择需要转移的线索");return}g.value.id=o,_.value=!0},O=()=>{F.value.validate(o=>{o&&c.changeUser(g.value).then(e=>{e.code===0?(s.success("转移成功"),_.value=!1,m()):s.error(e.msg)})})},Q=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){s.warning("请选择需要移至公海的线索");return}c.changePublic({id:o}).then(e=>{e.code===0?(s.success("移至公海成功"),m()):s.error(e.msg)})},W=()=>{console.log("import")},j=()=>{console.log("export")};return c.getSearchField().then(o=>{o.code===0&&(S.value=o.data)}),te().then(o=>{o.code===0&&(V.value=o.data)}),oe().then(o=>{o.code===0&&(U.value=o.data)}),m(),(o,e)=>{const n=ae,u=Y,A=Z,G=X,I=re,R=ie,w=ne,T=se,B=K;return h(),k(x,null,[p("div",ue,[t(ee,{data:S.value,onSearch:M},null,8,["data"]),p("div",me,[t(n,{size:"small",onClick:e[0]||(e[0]=l=>o.$router.push("/market/clues/add"))},{default:a(()=>[r("新增")]),_:1}),t(n,{size:"small",onClick:W},{default:a(()=>[r("导入")]),_:1}),t(n,{size:"small",onClick:j},{default:a(()=>[r("导出")]),_:1}),t(n,{size:"small",onClick:q},{default:a(()=>[r("转移给他人")]),_:1}),t(n,{size:"small",onClick:Q},{default:a(()=>[r("移至公海")]),_:1}),t(n,{size:"small",onClick:L},{default:a(()=>[r("删除")]),_:1})]),p("div",de,[t(A,{ref_key:"tableRef",ref:b,data:C.value,border:"","table-layout":"fixed",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:a(()=>[t(u,{type:"selection",width:"42"}),t(u,{prop:"companyName",label:"公司名称",width:"180"}),t(u,{prop:"exhibitionContact",label:"联系方式",width:"180"}),t(u,{prop:"duties",label:"职务"}),t(u,{prop:"phone",label:"电话"}),t(u,{prop:"recordTime",label:"记录时间",width:"180"}),t(u,{prop:"recordText",label:"记录内容"}),t(u,{prop:"authUser",label:"授权人"}),t(u,{fixed:"right",label:"操作",width:"120"},{default:a(l=>[t(n,{link:"",type:"primary",size:"small",onClick:ge=>N(l.row)},{default:a(()=>[r(" 转为意向客户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),p("div",pe,[t(G,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:E.value,"current-page":d.page,"onUpdate:currentPage":e[1]||(e[1]=l=>d.page=l),"page-size":d.perPage,"onUpdate:pageSize":e[2]||(e[2]=l=>d.perPage=l),onChange:m},null,8,["total","current-page","page-size"])])]),t(B,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=l=>v.value=l),title:"转为意向客户",width:"500",draggable:""},{footer:a(()=>[p("div",ce,[t(n,{onClick:e[4]||(e[4]=l=>v.value=!1)},{default:a(()=>[r("取消")]),_:1}),t(n,{type:"primary",onClick:$},{default:a(()=>[r("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"willFormRef",ref:z,model:f.value,"label-width":"auto"},{default:a(()=>[t(w,{label:"项目",prop:"exhibitionId",rules:[{required:!0,message:"请选择项目"}]},{default:a(()=>[t(R,{modelValue:f.value.exhibitionId,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value.exhibitionId=l),placeholder:""},{default:a(()=>[(h(!0),k(x,null,P(V.value,l=>(h(),D(I,{key:l.id,label:l.exhibitionName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=l=>_.value=l),title:"转移销售线索",width:"500",draggable:""},{footer:a(()=>[p("div",fe,[t(n,{onClick:e[7]||(e[7]=l=>_.value=!1)},{default:a(()=>[r("取消")]),_:1}),t(n,{type:"primary",onClick:O},{default:a(()=>[r("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"moveFormRef",ref:F,model:g.value,"label-width":"auto"},{default:a(()=>[t(w,{label:""},{default:a(()=>[r("是否将选中的销售线索转移？")]),_:1}),t(w,{label:"销售线索所有人",prop:"userId",rules:[{required:!0,message:"请选择销售线索所有人"}]},{default:a(()=>[t(R,{modelValue:g.value.userId,"onUpdate:modelValue":e[6]||(e[6]=l=>g.value.userId=l),placeholder:""},{default:a(()=>[(h(!0),k(x,null,P(U.value,l=>(h(),D(I,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});export{ut as default};
