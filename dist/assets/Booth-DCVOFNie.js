import{d as W,l as u,s as R,b as _,O as w,R as e,i as l,F as g,W as A,a5 as H,o as y,P as r,Q as b,e as J,am as K}from"./index-BLiDr1n_.js";import{E as X}from"./el-dialog-DAr0F5hy.js";/* empty css                   */import{E as Y}from"./el-progress-BCEc5fww.js";/* empty css                       */import{E as Z,a as ee}from"./el-radio-CJ_4b_cu.js";import{E as te}from"./el-pagination-D33X5CXi.js";/* empty css                 */import"./el-tag-DtGLuAiE.js";import"./el-select-CaFVpEUs.js";import"./el-scrollbar-tN_igFMk.js";import"./el-popper-CSR_9mKF.js";import{E as oe,a as ae}from"./el-table-column-CRwYqaTN.js";import"./el-checkbox-ioX7S3Yh.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                  */import{T as le}from"./index-CTBnx-z2.js";import{b as v,a as re}from"./index-CiLST17o.js";import{u as ie}from"./index-CoPD_AQR.js";/* empty css                       *//* empty css                   */import{E as ne}from"./index-D02rtp_c.js";import{E as $}from"./index-DE0cLpkk.js";import{c as s}from"./request-DA2je6Y6.js";import"./index-B-8-sGIa.js";import"./use-form-item-DRBnfQEp.js";import"./scroll-BHHbb1FS.js";import"./vnode-D7rdoAud.js";import"./refs-Gt6eqDUU.js";import"./event-BB_Ol6Sd.js";import"./cloneDeep-Dc0L07QG.js";import"./_baseClone-XUCCnA-s.js";import"./_initCloneObject-B8KKeT1n.js";import"./isEqual-CtARLntu.js";import"./index-DrkKMXWg.js";import"./castArray-CeJXah1L.js";import"./isArrayLikeObject-BnSSTs6_.js";import"./el-form-item-DzqyXppv.js";import"./el-date-picker-Dzn12EU_.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./arrays-6TrVLtTe.js";import"./index-D-Bc0rsi.js";/* empty css                          */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-9XSZMPl3.js";const pe={class:"s-flex-col",style:{height:"100%"}},se={class:"s-table-operations"},de={class:"s-flex-auto",style:{"min-height":"0"}},ue={class:"s-table-pagination"},rt=W({__name:"Booth",setup(me){A();const U=H(),m=u(!1),c=R({page:1,perPage:10}),E=u(0),x=u({}),S=U.query.id,k=u([]),V=u(null),C=u([]),p=R({show:!1,file:"",type:1,orderId:""}),P=a=>{x.value=a,c.page=1,f()},f=()=>{v.getList({...c,...x.value}).then(a=>{a.code===0?(k.value=a.data.data,E.value=a.data.total):k.value=[{}]})},D=a=>{$.confirm("是否确认要撤销订单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{v.revoke({id:a}).then(t=>{t.code===0?(s.success("撤销成功"),f()):s.error(t.msg)})}).catch(()=>{})},I=a=>{$.confirm("是否确认要删除订单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{v.del({id:a}).then(t=>{t.code===0?(s.success("删除成功"),f()):s.error(t.msg)})}).catch(()=>{})},T=()=>{},F=u(null);let d=u([]);const L=a=>{let t=a[0];d.value=[{name:t.name,size:t.size,uid:t.uid,status:"ready",percentage:0,raw:t}]},q=a=>{const t=a.size/1024/1024<3;return t||s.error("文件大小不能超过 3MB!"),t},B=a=>{p.show=!0,p.type=1,p.orderId=a,p.file="",d.value=[]},M=()=>{if(d.value.length===0){s.warning("请选择合同文件");return}m.value=!0;let a=new FormData;a.append("upload",d.value[0].raw),ie(a).then(t=>{t.code===0?v.receipt({orderId:p.orderId,type:p.type,url:t.data.url}).then(i=>{i.code===0?(s.success("上传成功"),p.show=!1,f()):s.error(i.msg),m.value=!1,console.log(m.value)}).catch(()=>{m.value=!1}):(s.error(t.msg),m.value=!1)}).catch(()=>{m.value=!1})};return v.getSearchField().then(a=>{a.code===0&&(C.value=a.data)}),re({clueId:S,exhibitionId:S}).then(a=>{a.code===0&&(C.value=a.data)}),f(),(a,t)=>{const i=ne,n=ae,N=oe,O=te,z=Z,j=ee,G=Y,Q=X;return y(),_(g,null,[w("div",pe,[e(le,{data:C.value,onSearch:P},null,8,["data"]),w("div",se,[e(i,{size:"small",onClick:T},{default:l(()=>[r("批量下载合同")]),_:1}),e(i,{size:"small",onClick:T},{default:l(()=>[r("导出")]),_:1})]),w("div",de,[e(N,{ref_key:"tableRef",ref:V,data:k.value,border:"",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:l(()=>[e(n,{type:"selection",width:"40",fixed:"left"}),e(n,{prop:"orderCode",label:"订单编号",width:"280"}),e(n,{prop:"companyName",label:"企业名称","min-width":"120"}),e(n,{prop:"hallCode",label:"展馆号"}),e(n,{prop:"positionCode",label:"展位号"}),e(n,{prop:"area",label:"面积"}),e(n,{prop:"num",label:"展位数量","min-width":"120"}),e(n,{prop:"orderPrice",label:"订单金额","min-width":"120"}),e(n,{prop:"orderType",label:"下单方式","min-width":"120"},{default:l(o=>[r(b(o.row.orderType===1?"代下单":"展商下单"),1)]),_:1}),e(n,{prop:"payStatus",label:"付款状态","min-width":"120"},{default:l(o=>[r(b({0:"未付款",1:"部分付款",2:"已付款"}[o.row.payStatus]),1)]),_:1}),e(n,{prop:"receivedPrice",label:"到款金额","min-width":"120"}),e(n,{prop:"contractStatus",label:"合同状态","min-width":"120"},{default:l(o=>[r(b({0:"未签订",1:"已签订",2:"已回执"}[o.row.contractStatus]),1)]),_:1}),e(n,{prop:"invoiceStatus",label:"发票状态","min-width":"120"},{default:l(o=>[r(b({0:"未申请",1:"待开票",2:"部分开票",3:"已开票"}[o.row.invoiceStatus]),1)]),_:1}),e(n,{prop:"clueUser",label:"所属人"}),e(n,{prop:"authUser",label:"下单人"}),e(n,{fixed:"right",label:"操作",width:"250"},{default:l(o=>[e(i,{link:"",type:"primary",onClick:h=>a.$router.push({name:"OrderBoothDetail",query:{id:o.row.id}})},{default:l(()=>[r("详情")]),_:2},1032,["onClick"]),o.row.orderStatus!==0?(y(),_(g,{key:0},[o.row.contractStatus===0?(y(),_(g,{key:0},[e(i,{link:"",type:"primary",onClick:h=>a.$router.push({name:"ContractTemplates",query:{id:o.row.id,type:1}})},{default:l(()=>[r("签订合同")]),_:2},1032,["onClick"]),e(i,{link:"",type:"primary",onClick:h=>B(o.row.id)},{default:l(()=>[r("上传合同")]),_:2},1032,["onClick"])],64)):(y(),_(g,{key:1},[e(i,{link:"",type:"primary",onClick:h=>a.$router.push({name:"ContractTemplates",query:{id:o.row.id,type:1}})},{default:l(()=>[r("更新合同")]),_:2},1032,["onClick"]),e(i,{link:"",type:"primary",onClick:h=>B(o.row.id)},{default:l(()=>[r("上传合同")]),_:2},1032,["onClick"])],64)),e(i,{link:"",type:"primary",onClick:h=>D(o.row.id)},{default:l(()=>[r("撤销")]),_:2},1032,["onClick"])],64)):(y(),_(g,{key:1},[e(i,{link:"",type:"",disabled:""},{default:l(()=>[r("已撤销")]),_:1}),e(i,{link:"",type:"danger",onClick:h=>I(o.row.id)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])],64))]),_:1})]),_:1},8,["data"])]),w("div",ue,[e(O,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:E.value,"current-page":c.page,"onUpdate:currentPage":t[0]||(t[0]=o=>c.page=o),"page-size":c.perPage,"onUpdate:pageSize":t[1]||(t[1]=o=>c.perPage=o),onChange:f},null,8,["total","current-page","page-size"])])]),e(Q,{modelValue:p.show,"onUpdate:modelValue":t[5]||(t[5]=o=>p.show=o),title:"上传合同",width:"400",draggable:""},{footer:l(()=>[e(i,{type:"primary",onClick:M,loading:m.value},{default:l(()=>[r("确定")]),_:1},8,["loading"]),e(i,{onClick:t[4]||(t[4]=o=>p.show=!1)},{default:l(()=>[r("取消")]),_:1})]),default:l(()=>[e(j,{modelValue:p.type,"onUpdate:modelValue":t[2]||(t[2]=o=>p.type=o)},{default:l(()=>[e(z,{value:1},{default:l(()=>[r("电子合同")]),_:1}),e(z,{value:2},{default:l(()=>[r("纸质合同")]),_:1})]),_:1},8,["modelValue"]),e(G,{ref_key:"uploadRef",ref:F,"auto-upload":!1,limit:1,"before-upload":q,"on-exceed":L,"file-list":J(d),"onUpdate:fileList":t[3]||(t[3]=o=>K(d)?d.value=o:d=o),style:{"margin-top":"10px"}},{default:l(()=>[e(i,{size:"small",type:"primary"},{default:l(()=>[r("点击上传")]),_:1})]),_:1},8,["file-list"])]),_:1},8,["modelValue"])],64)}}});export{rt as default};
