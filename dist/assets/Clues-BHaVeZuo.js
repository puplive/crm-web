import{d as H,s as J,l as r,o as h,f as k,P as p,S as t,w as a,Q as i,F as x,W as P,aj as K,c as D}from"./index-CeUaYvVA.js";import{E as X}from"./el-dialog-CMJ3crnE.js";/* empty css                   *//* empty css                     *//* empty css                 */import"./el-tag-Bffi55J-.js";/* empty css                  */import"./el-scrollbar-B3r7vdR_.js";import{E as Y}from"./el-pagination-D2v53lHM.js";import{E as Z,a as ee}from"./el-table-column-CNVENKfm.js";import"./el-checkbox-P28d__VQ.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-button-CG_o-Lai.js";import{T as te}from"./index-jtmw3YBc.js";import{a as c}from"./index-DMP8uAsi.js";import{e as oe}from"./index-Bn7VLrpD.js";import{g as le}from"./index-CPy5h9Jl.js";/* empty css                   *//* empty css                       */import{E as n}from"./request-BYjuyoE7.js";import{E as ae}from"./index-Yhf9aIxX.js";import{E as re}from"./index-Bd0HIxHa.js";import{E as ie,a as se}from"./index-BKFa2Ewl.js";import{E as ne,a as ue}from"./index-CQnDbio0.js";import"./index-CT8zzouX.js";import"./index-iYWA_S4l.js";import"./scroll-DsbyhrQW.js";import"./vnode-Dc4cRWui.js";import"./refs-Caa8iCgk.js";import"./event-BB_Ol6Sd.js";import"./_initCloneObject-1jg3Pr7d.js";import"./isEqual-DTRV5mK6.js";import"./typescript-CTRgrCvb.js";import"./aria-BUADUvnR.js";import"./index-nNlqqqFz.js";import"./isArrayLikeObject-CV9pJG-9.js";/* empty css                                                              *//* empty css                       *//* empty css                 *//* empty css                          */import"./index-Bc-gljCP.js";import"./index-DrL6iWLx.js";import"./arrays-6TrVLtTe.js";import"./index-C_90W4f6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-D8qVTIjr.js";import"./castArray-ta2Sfc5g.js";import"./_baseClone-C9EZC_0P.js";const me={class:"s-flex-col",style:{height:"100%"}},de={class:"s-table-operations"},pe={class:"s-flex-auto",style:{"min-height":"0"}},ce={class:"s-table-pagination"},fe={class:"dialog-footer"},ve={class:"dialog-footer"},ct=H({__name:"Clues",setup(ge){const d=J({page:1,perPage:10}),E=r(0),y=r({}),C=r([]),b=r(null),S=r([]),V=r([]),M=o=>{y.value=o,d.page=1,m()},m=async()=>{c.getList({status:1,...d,...y.value}).then(o=>{o.code===0&&(C.value=o.data.data,E.value=o.data.total)})},f=r({}),v=r(!1),z=r(null),N=o=>{f.value.id=o.id,v.value=!0},$=()=>{z.value.validate(o=>{o&&c.changeIntention(f.value).then(e=>{e.code===0?(n.success("转为意向成功"),m(),v.value=!1):n.error(e.msg)})})},L=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){n.warning("请选择需要删除的线索");return}ae.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c.del({id:o}).then(e=>{e.code===0?(n.success("删除成功"),m()):n.error(e.msg)})}).catch(()=>{})},g=r({}),_=r(!1),F=r(null),U=r([]),q=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){n.warning("请选择需要转移的线索");return}g.value.id=o,_.value=!0},j=()=>{F.value.validate(o=>{o&&c.changeUser(g.value).then(e=>{e.code===0?(n.success("转移成功"),_.value=!1,m()):n.error(e.msg)})})},O=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){n.warning("请选择需要移至公海的线索");return}c.changePublic({id:o}).then(e=>{e.code===0?(n.success("移至公海成功"),m()):n.error(e.msg)})},Q=()=>{K.push("/market/clues/import")},W=()=>{console.log("export")};return c.getSearchField().then(o=>{o.code===0&&(S.value=o.data)}),oe().then(o=>{o.code===0&&(V.value=o.data)}),le().then(o=>{o.code===0&&(U.value=o.data)}),m(),(o,e)=>{const s=re,u=Z,A=ee,G=Y,I=se,R=ie,w=ne,T=ue,B=X;return h(),k(x,null,[p("div",me,[t(te,{data:S.value,onSearch:M},null,8,["data"]),p("div",de,[t(s,{size:"small",onClick:e[0]||(e[0]=l=>o.$router.push("/market/clues/add"))},{default:a(()=>[i("新增")]),_:1}),t(s,{size:"small",onClick:Q},{default:a(()=>[i("导入")]),_:1}),t(s,{size:"small",onClick:W},{default:a(()=>[i("导出")]),_:1}),t(s,{size:"small",onClick:q},{default:a(()=>[i("转移给他人")]),_:1}),t(s,{size:"small",onClick:O},{default:a(()=>[i("移至公海")]),_:1}),t(s,{size:"small",onClick:L},{default:a(()=>[i("删除")]),_:1})]),p("div",pe,[t(A,{ref_key:"tableRef",ref:b,data:C.value,border:"","table-layout":"fixed",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:a(()=>[t(u,{type:"selection",width:"42"}),t(u,{prop:"companyName",label:"公司名称",width:"180"}),t(u,{prop:"exhibitionContact",label:"联系方式",width:"180"}),t(u,{prop:"duties",label:"职务"}),t(u,{prop:"phone",label:"电话"}),t(u,{prop:"recordTime",label:"记录时间",width:"180"}),t(u,{prop:"recordText",label:"记录内容"}),t(u,{prop:"authUser",label:"授权人"}),t(u,{fixed:"right",label:"操作",width:"120"},{default:a(l=>[t(s,{link:"",type:"primary",size:"small",onClick:_e=>N(l.row)},{default:a(()=>[i(" 转为意向客户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),p("div",ce,[t(G,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:E.value,"current-page":d.page,"onUpdate:currentPage":e[1]||(e[1]=l=>d.page=l),"page-size":d.perPage,"onUpdate:pageSize":e[2]||(e[2]=l=>d.perPage=l),onChange:m},null,8,["total","current-page","page-size"])])]),t(B,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=l=>v.value=l),title:"转为意向客户",width:"500",draggable:""},{footer:a(()=>[p("div",fe,[t(s,{onClick:e[4]||(e[4]=l=>v.value=!1)},{default:a(()=>[i("取消")]),_:1}),t(s,{type:"primary",onClick:$},{default:a(()=>[i("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"willFormRef",ref:z,model:f.value,"label-width":"auto"},{default:a(()=>[t(w,{label:"项目",prop:"exhibitionId",rules:[{required:!0,message:"请选择项目"}]},{default:a(()=>[t(R,{modelValue:f.value.exhibitionId,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value.exhibitionId=l),placeholder:""},{default:a(()=>[(h(!0),k(x,null,P(V.value,l=>(h(),D(I,{key:l.id,label:l.exhibitionName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=l=>_.value=l),title:"转移销售线索",width:"500",draggable:""},{footer:a(()=>[p("div",ve,[t(s,{onClick:e[7]||(e[7]=l=>_.value=!1)},{default:a(()=>[i("取消")]),_:1}),t(s,{type:"primary",onClick:j},{default:a(()=>[i("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"moveFormRef",ref:F,model:g.value,"label-width":"auto"},{default:a(()=>[t(w,{label:""},{default:a(()=>[i("是否将选中的销售线索转移？")]),_:1}),t(w,{label:"销售线索所有人",prop:"userId",rules:[{required:!0,message:"请选择销售线索所有人"}]},{default:a(()=>[t(R,{modelValue:g.value.userId,"onUpdate:modelValue":e[6]||(e[6]=l=>g.value.userId=l),placeholder:""},{default:a(()=>[(h(!0),k(x,null,P(U.value,l=>(h(),D(I,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});export{ct as default};
