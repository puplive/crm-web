import{d as z,l as f,o as c,b as y,R as l,i as o,O as w,P as d,h as C,Q as E,F as g,e as x,V as A}from"./index-BCumuH2l.js";import{E as Q}from"./el-dialog-Cr31W0vf.js";/* empty css                   *//* empty css                     *//* empty css                 */import"./el-tag-BkIRG4gH.js";import{E as j,a as G}from"./el-select-Dn8g1hD5.js";import"./el-scrollbar-DYhKSyot.js";import"./el-popper-DuA7pbMX.js";import{E as H,a as J}from"./el-tab-pane-DJRkihXT.js";import{E as K,a as W}from"./el-table-column-BOkQkY76.js";import{E as X}from"./el-checkbox-CCbI2xFo.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                  */import{a as u}from"./index-QsilTGDl.js";/* empty css                   *//* empty css                       */import{a as s}from"./request--qZdk5mN.js";import{E as Y}from"./index-D3W99q7A.js";import{E as Z}from"./index-CGEPfdHm.js";import{E as ee,a as te}from"./index-KsNwzYtN.js";import{E as le}from"./index-x58V2ps9.js";import"./index-BBCR1adM.js";import"./index-BNMC9-9K.js";import"./use-form-item-DPxtBdX-.js";import"./scroll-DEYraRnD.js";import"./vnode-DjHHQFRY.js";import"./refs-DC4vuWkM.js";import"./event-BB_Ol6Sd.js";import"./_Uint8Array-CjJrf9_z.js";import"./isEqual-Du7s0shl.js";import"./castArray--BTnThqL.js";import"./index-CqjYCCwr.js";import"./_initCloneObject-B8PdS-lA.js";import"./isArrayLikeObject-Y-BCkoqb.js";import"./rules-BWEfMqzk.js";import"./aria-KgdLjl5h.js";import"./validator-C_mxy1pJ.js";import"./_baseClone-7GzUapHy.js";const oe={class:"s-table-operations"},ae={class:"dialog-footer"},je=z({__name:"Custom",setup(ne){const V=u.customFieldTypes,_=f([]),R=f(null),m=f(!1),T=f("销售线索"),n=f({id:"",name:"",type:"",tips:""}),q=()=>{m.value=!0,n.value={id:"",name:"",type:"",tips:""}},$=t=>{m.value=!0,n.value.id=t.id,n.value.name=t.name,n.value.type=t.type,n.value.tips=t.tips},B=()=>{if(n.value.id)u.edit(n.value).then(t=>{t.code===0?(s.success("编辑成功"),m.value=!1,v()):s.error(t.msg)});else{let{id:t,...a}=n.value;u.add(a).then(r=>{r.code===0?(s.success("添加成功"),m.value=!1,v()):s.error(r.msg)})}},F=t=>{Y.confirm("此操作将永久删除该信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{console.log(t),u.customFieldDel({id:t.id}).then(a=>{a.code===0?(s.success("删除成功"),v()):s.error(a.msg)})}).catch(()=>{})},v=async()=>{u.getList().then(t=>{t.code===0&&(_.value=t.data)})},U=(t,a)=>{u.setRequired({id:t.id,status:t.isRequired}).then(r=>{r.code===0?s.success("修改成功"):(s.error(r.msg),_.value[a].isRequired=t.isRequired===0?1:0)})},D=(t,a)=>{u.setEnable({id:t.id,status:t.isEnable}).then(r=>{r.code===0?s.success("修改成功"):(s.error(r.msg),_.value[a].isEnable=t.isEnable===0?1:0)})};return v(),(t,a)=>{const r=Z,p=K,k=X,N=W,P=H,S=J,I=G,L=j,b=ee,h=le,M=te,O=Q;return c(),y(g,null,[l(S,{type:"border-card"},{default:o(()=>[l(P,{label:"销售客户"},{default:o(()=>[w("div",oe,[l(r,{size:"small",icon:"Plus",onClick:q},{default:o(()=>[d("线索字段")]),_:1})]),l(N,{data:_.value,"row-key":"id",border:"","default-expand-all":"","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:o(()=>[l(p,{prop:"name",label:"名称"},{default:o(e=>[e.row.type!=1&&e.row.type!=2?(c(),C(r,{key:0,type:"primary",link:"",onClick:i=>t.$router.push({path:"/settings/custom/field",query:{id:e.row.id,title:e.row.name,type:e.row.type}})},{default:o(()=>[d(E(e.row.name),1)]),_:2},1032,["onClick"])):(c(),y(g,{key:1},[d(E(e.row.name),1)],64))]),_:1}),l(p,{prop:"type",label:"类型"},{default:o(e=>[d(E((()=>{let i=x(V)[e.row.type];return i?i.label:""})()),1)]),_:1}),l(p,{prop:"isRequired",label:"必填"},{default:o(e=>[l(k,{modelValue:e.row.isRequired,"onUpdate:modelValue":i=>e.row.isRequired=i,"true-value":1,"false-value":0,onChange:i=>U(e.row,e.$index)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(p,{prop:"isEnable",label:"启用"},{default:o(e=>[l(k,{modelValue:e.row.isEnable,"onUpdate:modelValue":i=>e.row.isEnable=i,"true-value":1,"false-value":0,onChange:i=>D(e.row,e.$index)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(p,{label:"操作"},{default:o(e=>[l(r,{link:"",type:"primary",onClick:i=>$(e.row)},{default:o(()=>[d("编辑")]),_:2},1032,["onClick"]),l(r,{link:"",type:"danger",onClick:i=>F(e.row)},{default:o(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),l(O,{title:T.value,modelValue:m.value,"onUpdate:modelValue":a[4]||(a[4]=e=>m.value=e),style:{width:"400px"}},{footer:o(()=>[w("div",ae,[l(r,{onClick:a[3]||(a[3]=e=>m.value=!1)},{default:o(()=>[d("取 消")]),_:1}),l(r,{type:"primary",onClick:B},{default:o(()=>[d("确 定")]),_:1})])]),default:o(()=>[l(M,{ref_key:"addformRef",ref:R,model:n.value,"label-width":"100px"},{default:o(()=>[l(b,{label:"类型",prop:"type"},{default:o(()=>[l(L,{modelValue:n.value.type,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value.type=e)},{default:o(()=>[(c(!0),y(g,null,A(x(V),e=>(c(),C(I,{key:e.type,label:e.label,value:e.type},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(b,{label:"名称",prop:"name"},{default:o(()=>[l(h,{modelValue:n.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value.name=e)},null,8,["modelValue"])]),_:1}),l(b,{label:"提示",prop:"tips"},{default:o(()=>[l(h,{modelValue:n.value.tips,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value.tips=e),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])],64)}}});export{je as default};
