import{d as J,s as K,l as i,o as h,f as k,P as p,S as t,w as a,Q as r,R as X,F as x,W as P,aj as Y,c as D}from"./index-CqGmAY_u.js";import{E as Z}from"./el-dialog-v8QaKeiT.js";/* empty css                   *//* empty css                     *//* empty css                 */import"./el-tag-uPOr0Gox.js";/* empty css                  */import"./el-scrollbar-DStktWal.js";import{E as ee}from"./el-pagination-C94Vvszp.js";import{E as te,a as oe}from"./el-table-column-BN3t8Niw.js";import"./el-checkbox-BEIE1FTh.js";import"./el-tooltip-l0sNRNKZ.js";import{E as le}from"./el-link--dnIedoq.js";import"./el-button-DpzYuNCC.js";import{T as ae}from"./index-BGjDof29.js";import{a as c}from"./index-C_duR44S.js";import{e as ie}from"./index-Dp5RPssR.js";import{g as re}from"./index-CxVMG3W4.js";/* empty css                   *//* empty css                       */import{a as s}from"./request-BWe5mLiC.js";import{E as ne}from"./index-D5J-_Dfe.js";import{E as se}from"./index-Bd1qaB5O.js";import{E as me,a as ue}from"./index-CFhDgrYB.js";import{E as de,a as pe}from"./index-M5aUYcP_.js";import"./index-ChNZniro.js";import"./index-BJocUqJs.js";import"./scroll-Covgc6bg.js";import"./vnode-8cI36gNR.js";import"./refs-DIIzzgZO.js";import"./event-BB_Ol6Sd.js";import"./_initCloneObject-BTvP7gDY.js";import"./isEqual-BCKW0y_w.js";import"./typescript-B9iuFu41.js";import"./index-CN0jcStv.js";import"./isArrayLikeObject-bNXIFdAR.js";/* empty css                                                              *//* empty css                       *//* empty css                 *//* empty css                          */import"./index-CguX-oIt.js";import"./index-BXjaXClQ.js";import"./arrays-6TrVLtTe.js";import"./index-E146iEmP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-0OFKhMQ4.js";import"./castArray-Ds8PJccp.js";import"./_baseClone-CIKtdTEW.js";const ce={class:"s-flex-col",style:{height:"100%"}},fe={class:"s-table-operations"},ve={class:"s-flex-auto",style:{"min-height":"0"}},ge={class:"s-table-pagination"},_e={class:"dialog-footer"},he={class:"dialog-footer"},gt=J({__name:"Clues",setup(be){const d=K({page:1,perPage:10}),y=i(0),E=i({}),C=i([]),b=i(null),S=i([]),V=i([]),N=o=>{E.value=o,d.page=1,u()},u=async()=>{c.getList({status:1,...d,...E.value}).then(o=>{o.code===0&&(C.value=o.data.data,y.value=o.data.total)})},f=i({}),v=i(!1),z=i(null),L=o=>{f.value.id=o.id,v.value=!0},M=()=>{z.value.validate(o=>{o&&c.changeIntention(f.value).then(e=>{e.code===0?(s.success("转为意向成功"),u(),v.value=!1):s.error(e.msg)})})},$=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){s.warning("请选择需要删除的线索");return}ne.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{c.del({id:o}).then(e=>{e.code===0?(s.success("删除成功"),u()):s.error(e.msg)})}).catch(()=>{})},g=i({}),_=i(!1),F=i(null),U=i([]),q=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){s.warning("请选择需要转移的线索");return}g.value.id=o,_.value=!0},j=()=>{F.value.validate(o=>{o&&c.changeUser(g.value).then(e=>{e.code===0?(s.success("转移成功"),_.value=!1,u()):s.error(e.msg)})})},O=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){s.warning("请选择需要移至公海的线索");return}c.changePublic({id:o}).then(e=>{e.code===0?(s.success("移至公海成功"),u()):s.error(e.msg)})},Q=()=>{Y.push("/market/clues/import")},W=()=>{console.log("export")};return c.getSearchField().then(o=>{o.code===0&&(S.value=o.data)}),ie().then(o=>{o.code===0&&(V.value=o.data)}),re().then(o=>{o.code===0&&(U.value=o.data)}),u(),(o,e)=>{const n=se,m=te,A=le,G=oe,H=ee,I=ue,R=me,w=de,T=pe,B=Z;return h(),k(x,null,[p("div",ce,[t(ae,{data:S.value,onSearch:N},null,8,["data"]),p("div",fe,[t(n,{size:"small",onClick:e[0]||(e[0]=l=>o.$router.push("/market/clues/add"))},{default:a(()=>[r("新增")]),_:1}),t(n,{size:"small",onClick:Q},{default:a(()=>[r("导入")]),_:1}),t(n,{size:"small",onClick:W},{default:a(()=>[r("导出")]),_:1}),t(n,{size:"small",onClick:q},{default:a(()=>[r("转移给他人")]),_:1}),t(n,{size:"small",onClick:O},{default:a(()=>[r("移至公海")]),_:1}),t(n,{size:"small",onClick:$},{default:a(()=>[r("删除")]),_:1})]),p("div",ve,[t(G,{ref_key:"tableRef",ref:b,data:C.value,border:"","table-layout":"fixed",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:a(()=>[t(m,{type:"selection",width:"42"}),t(m,{prop:"companyName",label:"公司名称",width:"180"},{default:a(l=>[t(A,{href:"/market/clues/info?id="+l.row.id+"&exhibitionId="+l.row.exhibitionId+"&authUser="+l.row.authUser,type:"primary"},{default:a(()=>[r(X(l.row.companyName),1)]),_:2},1032,["href"])]),_:1}),t(m,{prop:"exhibitionContact",label:"联系方式",width:"180"}),t(m,{prop:"duties",label:"职务"}),t(m,{prop:"phone",label:"电话"}),t(m,{prop:"recordTime",label:"记录时间",width:"180"}),t(m,{prop:"recordText",label:"记录内容"}),t(m,{prop:"authUser",label:"授权人"}),t(m,{fixed:"right",label:"操作",width:"120"},{default:a(l=>[t(n,{link:"",type:"primary",size:"small",onClick:we=>L(l.row)},{default:a(()=>[r(" 转为意向客户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),p("div",ge,[t(H,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:y.value,"current-page":d.page,"onUpdate:currentPage":e[1]||(e[1]=l=>d.page=l),"page-size":d.perPage,"onUpdate:pageSize":e[2]||(e[2]=l=>d.perPage=l),onChange:u},null,8,["total","current-page","page-size"])])]),t(B,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=l=>v.value=l),title:"转为意向客户",width:"500",draggable:""},{footer:a(()=>[p("div",_e,[t(n,{onClick:e[4]||(e[4]=l=>v.value=!1)},{default:a(()=>[r("取消")]),_:1}),t(n,{type:"primary",onClick:M},{default:a(()=>[r("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"willFormRef",ref:z,model:f.value,"label-width":"auto"},{default:a(()=>[t(w,{label:"项目",prop:"exhibitionId",rules:[{required:!0,message:"请选择项目"}]},{default:a(()=>[t(R,{modelValue:f.value.exhibitionId,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value.exhibitionId=l),placeholder:""},{default:a(()=>[(h(!0),k(x,null,P(V.value,l=>(h(),D(I,{key:l.id,label:l.exhibitionName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:_.value,"onUpdate:modelValue":e[8]||(e[8]=l=>_.value=l),title:"转移销售线索",width:"500",draggable:""},{footer:a(()=>[p("div",he,[t(n,{onClick:e[7]||(e[7]=l=>_.value=!1)},{default:a(()=>[r("取消")]),_:1}),t(n,{type:"primary",onClick:j},{default:a(()=>[r("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"moveFormRef",ref:F,model:g.value,"label-width":"auto"},{default:a(()=>[t(w,{label:""},{default:a(()=>[r("是否将选中的销售线索转移？")]),_:1}),t(w,{label:"销售线索所有人",prop:"userId",rules:[{required:!0,message:"请选择销售线索所有人"}]},{default:a(()=>[t(R,{modelValue:g.value.userId,"onUpdate:modelValue":e[6]||(e[6]=l=>g.value.userId=l),placeholder:""},{default:a(()=>[(h(!0),k(x,null,P(U.value,l=>(h(),D(I,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});export{gt as default};
