import{d as A,l as u,s as T,o as g,f as R,P as h,S as e,w as l,Q as r,R as v,c as w,W as C,F as V,a as H,at as J,Z as K,a7 as X}from"./index-Q273XHf8.js";import{E as Y}from"./el-dialog-C8sC26KZ.js";/* empty css                   */import{E as ee}from"./el-progress-DKdNvtRg.js";/* empty css                 */import{E as te}from"./el-pagination-B5PtXqbH.js";import"./el-input-Dg3qt5Bb.js";import"./el-tag-DqRVPKx1.js";/* empty css                  */import"./el-scrollbar-0l_cZ0S_.js";import{E as oe,a as ae}from"./el-table-column-DSWDUPh9.js";import"./el-checkbox-CUmpTspT.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-button-DXeH7ULc.js";import{T as le}from"./index-BzjwArE3.js";import{b as y,g as re}from"./index-Bar3g9kv.js";import{u as ie}from"./index-DJl-7uVy.js";/* empty css                       *//* empty css                   */import{E as U}from"./index-BTJsYqsj.js";import{E as p}from"./request-CQ37sLB9.js";import{E as ne}from"./index-nVic9h1r.js";import{E as se,a as pe}from"./index-TOYvJhkT.js";import"./index-CUKUieZ5.js";import"./index-CRFYaBQA.js";import"./constants-D7u2-Egf.js";import"./scroll-BIoQ-qBU.js";import"./vnode-CembcOEi.js";import"./typescript-CjU46sqC.js";import"./cloneDeep-C2LcNVwI.js";import"./index-Bvt8dlHX.js";import"./isEqual-DPHZFWxr.js";import"./index-Bkne1dct.js";import"./index-j8eE0ruH.js";import"./isArrayLikeObject-BKJ0Asn3.js";/* empty css                     *//* empty css                                                              *//* empty css                       *//* empty css                          */import"./index-DM6p5gww.js";import"./arrays-6TrVLtTe.js";import"./index-mpwgweJ1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-Dg3P4JN7.js";import"./index-r5W6hzzQ.js";const de={class:"s-flex-col",style:{height:"100%"}},ue={class:"s-table-operations"},me={class:"s-flex-auto",style:{"min-height":"0"}},ce={class:"s-table-pagination"},nt=A({__name:"Booth",setup(fe){K();const $=X(),m=u(!1),c=T({page:1,perPage:10}),E=u(0),z=u({}),x=$.query.id,b=u([]),P=u(null),k=u([]),s=T({show:!1,file:"",type:1,orderId:""}),D=a=>{z.value=a,c.page=1,f()},f=()=>{y.getList({...c,...z.value}).then(a=>{a.code===0?(b.value=a.data.data,E.value=a.data.total):b.value=[{}]})},I=a=>{U.confirm("是否确认要撤销订单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{y.revoke({id:a}).then(t=>{t.code===0?(p.success("撤销成功"),f()):p.error(t.msg)})}).catch(()=>{})},F=a=>{U.confirm("是否确认要删除订单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{y.del({id:a}).then(t=>{t.code===0?(p.success("删除成功"),f()):p.error(t.msg)})}).catch(()=>{})},S=()=>{},L=u(null);let d=u([]);const N=a=>{let t=a[0];d.value=[{name:t.name,size:t.size,uid:t.uid,status:"ready",percentage:0,raw:t}]},q=a=>{const t=a.size/1024/1024<3;return t||p.error("文件大小不能超过 3MB!"),t},M=a=>{s.show=!0,s.type=1,s.orderId=a,s.file="",d.value=[]},O=()=>{if(d.value.length===0){p.warning("请选择合同文件");return}m.value=!0;let a=new FormData;a.append("upload",d.value[0].raw),ie(a).then(t=>{t.code===0?y.receipt({orderId:s.orderId,type:s.type,url:t.data.url}).then(n=>{n.code===0?(p.success("上传成功"),s.show=!1,f()):p.error(n.msg),m.value=!1,console.log(m.value)}).catch(()=>{m.value=!1}):(p.error(t.msg),m.value=!1)}).catch(()=>{m.value=!1})};return y.getSearchField().then(a=>{a.code===0&&(k.value=a.data)}),re({clueId:x,exhibitionId:x}).then(a=>{a.code===0&&(k.value=a.data)}),f(),(a,t)=>{const n=ne,i=oe,j=ae,G=te,B=se,Q=pe,W=ee,Z=Y;return g(),R(V,null,[h("div",de,[e(le,{data:k.value,onSearch:D},null,8,["data"]),h("div",ue,[e(n,{size:"small",onClick:S},{default:l(()=>[r("批量下载合同")]),_:1}),e(n,{size:"small",onClick:S},{default:l(()=>[r("导出")]),_:1})]),h("div",me,[e(j,{ref_key:"tableRef",ref:P,data:b.value,border:"",height:"100%","header-row-class-name":"s-table-header"},{default:l(()=>[e(i,{type:"selection",width:"40"}),e(i,{prop:"orderCode",label:"订单编号",width:"280"}),e(i,{prop:"companyName",label:"企业名称"}),e(i,{prop:"hallCode",label:"展馆号"}),e(i,{prop:"positionCode",label:"展位号"}),e(i,{prop:"area",label:"面积"}),e(i,{prop:"num",label:"展位数量"}),e(i,{prop:"orderPrice",label:"订单金额"}),e(i,{prop:"orderType",label:"下单方式"},{default:l(o=>[r(v(o.row.orderType===1?"代下单":"展商下单"),1)]),_:1}),e(i,{prop:"payStatus",label:"付款状态"},{default:l(o=>[r(v({0:"未付款",1:"部分付款",2:"已付款"}[o.row.payStatus]),1)]),_:1}),e(i,{prop:"receivedPrice",label:"到款金额"}),e(i,{prop:"contractStatus",label:"合同状态"},{default:l(o=>[r(v({0:"未签订",1:"已签订",2:"已回执"}[o.row.contractStatus]),1)]),_:1}),e(i,{prop:"invoiceStatus",label:"发票状态"},{default:l(o=>[r(v({0:"未申请",1:"待开票",2:"部分开票",3:"已开票"}[o.row.invoiceStatus]),1)]),_:1}),e(i,{prop:"clueUser",label:"所属人"}),e(i,{prop:"authUser",label:"下单人"}),e(i,{fixed:"right",label:"操作",width:"260"},{default:l(o=>[e(n,{link:"",type:"primary",size:"small",onClick:_=>a.$router.push({name:"OrderBoothDetail",query:{id:o.row.id}})},{default:l(()=>[r("详情")]),_:2},1032,["onClick"]),o.row.contractStatus===0?(g(),w(n,{key:0,link:"",type:"primary",size:"small",onClick:_=>a.$router.push({name:"ContractTemplates",query:{id:o.row.id}})},{default:l(()=>[r("签订合同")]),_:2},1032,["onClick"])):C("",!0),o.row.contractStatus===1?(g(),w(n,{key:1,link:"",type:"primary",size:"small",onClick:_=>a.$router.push({name:"ContractTemplates",query:{id:o.row.id}})},{default:l(()=>[r("更新合同")]),_:2},1032,["onClick"])):C("",!0),e(n,{link:"",type:"primary",size:"small",onClick:_=>M(o.row.id)},{default:l(()=>[r("上传合同")]),_:2},1032,["onClick"]),o.row.orderStatus===1?(g(),w(n,{key:2,link:"",type:"primary",size:"small",onClick:_=>I(o.row.id)},{default:l(()=>[r("撤销")]),_:2},1032,["onClick"])):o.row.orderStatus===0?(g(),R(V,{key:3},[e(n,{link:"",type:"",size:"small",disabled:""},{default:l(()=>[r("已撤销")]),_:1}),e(n,{link:"",type:"primary",size:"small",onClick:_=>F(o.row.id)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])],64)):C("",!0)]),_:1})]),_:1},8,["data"])]),h("div",ce,[e(G,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:E.value,"current-page":c.page,"onUpdate:currentPage":t[0]||(t[0]=o=>c.page=o),"page-size":c.perPage,"onUpdate:pageSize":t[1]||(t[1]=o=>c.perPage=o),onChange:f},null,8,["total","current-page","page-size"])])]),e(Z,{modelValue:s.show,"onUpdate:modelValue":t[5]||(t[5]=o=>s.show=o),title:"上传合同",width:"400"},{footer:l(()=>[e(n,{type:"primary",onClick:O,loading:m.value},{default:l(()=>[r("确定")]),_:1},8,["loading"]),e(n,{onClick:t[4]||(t[4]=o=>s.show=!1)},{default:l(()=>[r("取消")]),_:1})]),default:l(()=>[e(Q,{modelValue:s.type,"onUpdate:modelValue":t[2]||(t[2]=o=>s.type=o)},{default:l(()=>[e(B,{value:1},{default:l(()=>[r("电子合同")]),_:1}),e(B,{value:2},{default:l(()=>[r("纸质合同")]),_:1})]),_:1},8,["modelValue"]),e(W,{ref_key:"uploadRef",ref:L,"auto-upload":!1,limit:1,"before-upload":q,"on-exceed":N,"file-list":H(d),"onUpdate:fileList":t[3]||(t[3]=o=>J(d)?d.value=o:d=o),style:{"margin-top":"10px"}},{default:l(()=>[e(n,{size:"small",type:"primary"},{default:l(()=>[r("点击上传")]),_:1})]),_:1},8,["file-list"])]),_:1},8,["modelValue"])],64)}}});export{nt as default};
