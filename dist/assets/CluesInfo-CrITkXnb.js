import{d as ae,l as g,o as u,b as y,O as d,R as e,i as l,F as U,U as H,P as s,h as w,Q as c,X as ne,Y as se,c as _e,s as ee,e as $,a3 as R,W as ve,a5 as be}from"./index-Bi2PROgv.js";import{E as ye}from"./el-dialog-D1SeEaY5.js";/* empty css                   *//* empty css                 */import"./el-tag-jHOogTHj.js";import{a as ie,E as de}from"./el-select-Dho0GD51.js";import{E as he}from"./el-scrollbar-DoWAqtmr.js";import"./el-popper-CtyNLmno.js";import{E as ke,a as we}from"./el-tab-pane-Dmgz8DY6.js";import{E as ge,a as Ce}from"./el-form-item-DkyF6cJE.js";import{E as Ve,a as Ee}from"./el-table-column-D_HaMcsg.js";import"./el-checkbox-9a5clquP.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                       */import{E as xe,a as Ie}from"./el-radio-B3dtIkky.js";import{b as le,d as q,g as Te,e as $e,f as Ue,h as Be,i as Ne}from"./index-C5HHRxnv.js";/* empty css                   */import{c as _}from"./request-DmoR3LNW.js";import{E as re}from"./index-CfuwN6yI.js";import{E as ue}from"./index-B5b1GjTk.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Fe}from"./Move.vue_vue_type_script_setup_true_lang-BL7aj6au.js";import{_ as Se}from"./GoodsOrderDetail.vue_vue_type_script_setup_true_lang-By2tc9uY.js";import{b as te,c as oe}from"./index-BPqtUPRX.js";/* empty css                       */import{E as z}from"./index-fpNmSqp-.js";import"./index-ADznZZz0.js";import"./use-form-item-BXJm_uA7.js";import"./scroll-D5N_J7DM.js";import"./vnode-BGV2TyWq.js";import"./refs-BNeaP4vs.js";import"./event-BB_Ol6Sd.js";import"./_initCloneObject-DbOGMf5u.js";import"./isEqual-Cw95faAZ.js";import"./castArray-C50MDmv2.js";import"./index-4cwUbFX_.js";import"./_baseClone-DhE4jdMd.js";import"./isArrayLikeObject-D8atm7ZF.js";import"./index-DoS3THrj.js";import"./aria-KgdLjl5h.js";import"./validator-CuwzED1f.js";const ce=C=>(ne("data-v-d448d0ad"),C=C(),se(),C),Le={class:"follow-up"},Pe=ce(()=>d("div",{class:"title"},"跟进记录",-1)),Re={class:"form"},De={class:"item"},ze=ce(()=>d("label",null,"跟进状态",-1)),qe={class:"record"},Me={class:"list"},je={class:"p1"},Ae={class:"p2"},Oe=ae({__name:"FollowUp",props:["clueId"],setup(C,{expose:M}){const B=C,E=g(""),b=g(0),r=g(0),F=g(""),j=()=>{le.add({clueId:B.clueId,text:E.value,status:b.value,contactId:r.value,contactName:F.value}).then(v=>{v.code===0?(_.success("跟进记录添加成功"),x()):_.error(v.msg)})},A=g([]),x=()=>{le.getList({clueId:B.clueId}).then(v=>{v.code===0&&(A.value=v.data)})};x();const D=g([]),O=()=>{q.getList({clueId:B.clueId}).then(v=>{v.code===0&&(D.value=v.data)})};return O(),M({getContactList:O}),(v,o)=>{const S=re,V=ie,G=de,L=ue,Q=he;return u(),y("div",Le,[Pe,d("div",Re,[e(S,{type:"textarea",placeholder:"请输入跟进内容",modelValue:E.value,"onUpdate:modelValue":o[0]||(o[0]=m=>E.value=m)},null,8,["modelValue"]),d("div",De,[ze,e(G,{modelValue:b.value,"onUpdate:modelValue":o[1]||(o[1]=m=>b.value=m),placeholder:"跟进状态"},{default:l(()=>[e(V,{label:"未跟进",value:0}),e(V,{label:"电话邀约",value:1}),e(V,{label:"客户拜访",value:2}),e(V,{label:"初步方案",value:3}),e(V,{label:"停滞",value:4})]),_:1},8,["modelValue"]),e(G,{modelValue:r.value,"onUpdate:modelValue":o[2]||(o[2]=m=>r.value=m),placeholder:"联系人",onChange:o[3]||(o[3]=m=>{if(m===0)F.value="";else{let N=D.value.find(X=>X.id===m);F.value=N?N.name:""}})},{default:l(()=>[e(V,{label:"联系人",value:0}),(u(!0),y(U,null,H(D.value,m=>(u(),w(V,{key:m.id,label:m.name,value:m.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(L,{type:"primary",onClick:j},{default:l(()=>[s("提交")]),_:1})])]),d("div",qe,[e(Q,null,{default:l(()=>[d("ul",Me,[(u(!0),y(U,null,H(A.value,(m,N)=>(u(),y("li",{key:N,class:"item"},[d("div",je,[s(c(m.time)+" ",1),d("span",null,c(m.authUser),1),s(),d("span",null,c({0:"无",1:"电话邀约",2:"客户拜访",3:"初步方案",4:"停滞"}[m.status]),1)]),d("div",Ae,"（联系人："+c(m.contact)+"）"+c(m.text),1)]))),128))])]),_:1})])])}}}),Ge=pe(Oe,[["__scopeId","data-v-d448d0ad"]]),J=C=>(ne("data-v-89ca0c2b"),C=C(),se(),C),Qe={class:"clues-info"},We={class:"clues-info-header"},Xe={class:"clues-info-header-left"},Ye={class:"p1"},He={class:"p2"},Je={key:0},Ke={key:1},Ze={class:"clues-info-header-right"},el={class:"clues-info-content"},ll={class:"clues-info-left"},tl={style:{}},ol={class:"title-bar"},al=J(()=>d("label",{for:""},"公司信息",-1)),nl={key:0},sl={key:1},il={key:2},dl=J(()=>d("p",{style:{padding:"10px 0"}},"展位订单",-1)),rl=J(()=>d("p",{style:{padding:"10px 0","margin-top":"10px"}},"物料订单",-1)),ul={class:"clues-info-right"},pl=ae({__name:"CluesInfo",setup(C){const M=ve(),B=be(),E=B.query.type,b=B.query.id;B.query.exhibitionId;const r=g({customField:[],orderPosition:[],orderMaterial:[],contract:[]}),F=g([]),j=()=>{Te().then(a=>{a.code===0&&(F.value=a.data)})},A=_e(()=>{let a=[];for(let n in r.value.customFieldTrans){let k=r.value.customFieldTrans[n],h=F.value.find(p=>p.key===n);a.push({key:n,value:k,type:h?h.type:1,name:h?h.name:""})}return a}),x=()=>{$e({id:b}).then(a=>{a.code===0&&(r.value=a.data)})},D=()=>{z.confirm("确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ue({id:[b]}).then(a=>{a.code===0?(_.success("删除成功"),setTimeout(()=>{M.go(-1)},1e3)):_.error(a.msg)})}).catch(()=>{console.log("cancel")})},O=()=>{console.log(r.value.isNew),Be({id:b,status:r.value.isNew}).then(a=>{a.code===0?_.success("修改成功"):_.error(a.msg)})},v=()=>{q.getList({clueId:b}).then(a=>{a.code===0&&(o.list=a.data)})},o=ee({show:!1,isEdit:!1,list:[],form:{clueId:b,name:"",duties:"",type:0,mobile:"",tel:"",email:"",wechat:"",status:1},setAdd:()=>{o.show=!0,o.isEdit=!1,o.form={clueId:b,name:"",duties:"",type:0,mobile:"",tel:"",email:"",wechat:"",status:1}},setEdit:a=>{o.show=!0,o.isEdit=!0,o.form=a,o.form.clueId=b},add:()=>{q.add(o.form).then(a=>{a.code===0?(_.success("添加成功"),o.show=!1,v(),S.value.getContactList()):_.error(a.msg)})},edit:()=>{q.edit(o.form).then(a=>{a.code===0?(_.success("修改成功"),o.show=!1,v(),S.value.getContactList()):(_.error(a.msg),v())})},del:a=>{z.confirm("确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{q.del({id:a}).then(n=>{n.code===0?(_.success("删除成功"),v(),S.value.getContactList()):_.error(n.msg)})})}}),S=g(null),V=g(null),G=()=>{z.confirm("确定退展？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ne({id:b}).then(a=>{a.code===0?(_.success("退展成功"),setTimeout(()=>{M.go(-1)},1e3)):_.error(a.msg)})})},L=ee({activeName:1,change:a=>{L.activeName=a,a===1&&(j(),v()),x()}}),Q=(a,n)=>{z.confirm("是否确认要撤销订单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let k=te.revoke;n===2&&(k=oe.revoke),k({id:a}).then(h=>{h.code===0?(_.success("撤销成功"),x()):_.error(h.msg)})}).catch(()=>{})},m=(a,n)=>{z.confirm("是否确认要删除订单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let k=te.del;n===2&&(k=oe.del),k({id:a}).then(h=>{h.code===0?(_.success("删除成功"),x()):_.error(h.msg)})}).catch(()=>{})},N=g(null),X=a=>{N.value.getDetail(a)};return x(),j(),v(),(a,n)=>{const k=xe,h=Ie,p=ue,f=ge,i=Ve,W=Ee,K=Ce,Y=ke,me=we,P=re,I=ie,Z=de,fe=ye;return u(),y(U,null,[d("div",Qe,[d("div",We,[d("div",Xe,[d("div",Ye,c(r.value.companyName),1),d("div",He,[$(E)==="2"?(u(),y("span",Je,"所属展商："+c(r.value.companyName),1)):R("",!0),$(E)==="2"?(u(),y("span",Ke,[s("新展商： "),e(h,{"model-value":r.value.isNew,"onUpdate:modelValue":n[0]||(n[0]=t=>r.value.isNew=t),onChange:O},{default:l(()=>[e(k,{value:!0,style:{"margin-right":"10px"}},{default:l(()=>[s("是")]),_:1}),e(k,{value:!1},{default:l(()=>[s("否")]),_:1})]),_:1},8,["model-value"])])):R("",!0),d("span",null,"客户经理："+c(r.value.authUser),1)])]),d("div",Ze,[$(E)==="2"?(u(),y(U,{key:0},[r.value.isExit?(u(),w(p,{key:0,type:"info",size:"small",plain:"",disabled:""},{default:l(()=>[s("已退展")]),_:1})):(u(),w(p,{key:1,type:"primary",size:"small",onClick:G},{default:l(()=>[s("退展")]),_:1}))],64)):R("",!0),e(p,{type:"primary",size:"small",onClick:n[1]||(n[1]=()=>{V.value.setMove([$(b)])})},{default:l(()=>[s("转他人")]),_:1})])]),d("div",el,[d("div",ll,[e(me,{modelValue:L.activeName,"onUpdate:modelValue":n[3]||(n[3]=t=>L.activeName=t),onTabChange:L.change,type:"border-card",class:"demo-tabs",style:{height:"100%"}},{default:l(()=>[e(Y,{label:"资料",name:1},{default:l(()=>[d("div",tl,[e(K,{ref_key:"form",ref:r,"label-width":"auto"},{default:l(()=>[d("div",ol,[al,e(p,{type:"default",onClick:n[2]||(n[2]=t=>a.$router.push({name:"CluesEdit",query:{id:$(b)}})),size:"small"},{default:l(()=>[s("编辑")]),_:1}),e(p,{type:"default",onClick:D,size:"small"},{default:l(()=>[s("删除")]),_:1})]),e(f,{label:"企业名称"},{default:l(()=>[d("span",null,c(r.value.companyName),1)]),_:1}),e(f,{label:"联系人"},{default:l(()=>[d("span",null,c(r.value.contactName),1)]),_:1}),e(f,{label:"国家"},{default:l(()=>[d("span",null,c(r.value.country),1)]),_:1}),e(f,{label:"省份"},{default:l(()=>[d("span",null,c(r.value.province),1)]),_:1}),e(f,{label:"城市"},{default:l(()=>[d("span",null,c(r.value.city),1)]),_:1}),e(f,{label:"详细地址",prop:"address"},{default:l(()=>[d("span",null,c(r.value.address),1)]),_:1}),e(f,{label:"企业品牌",prop:""},{default:l(()=>[d("span",null,c(r.value.companyBrand&&r.value.companyBrand.length>0?r.value.companyBrand.join(","):""),1)]),_:1}),(u(!0),y(U,null,H(A.value,(t,T)=>(u(),w(f,{key:t.key,label:t.name},{default:l(()=>[t.type===5?(u(),y("span",nl,c(t.value.join("，")),1)):t.type===7?(u(),y("span",sl,c(t.value.join("，")),1)):(u(),y("span",il,c(t.value),1))]),_:2},1032,["label"]))),128)),e(f,{label:"参展联系人",prop:""},{default:l(()=>[e(p,{size:"small",onClick:o.setAdd},{default:l(()=>[s("添加")]),_:1},8,["onClick"])]),_:1}),e(W,{border:"",data:o.list,"show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:l(()=>[e(i,{prop:"name",label:"姓名"}),e(i,{prop:"duties",label:"职务"}),e(i,{prop:"type",label:"类别"},{default:l(t=>[s(c(["无","展位","财务","市场","现场"][t.row.type]),1)]),_:1}),e(i,{prop:"mobile",label:"手机号"}),e(i,{prop:"tel",label:"电话"}),e(i,{prop:"email",label:"邮箱"}),e(i,{prop:"wechat",label:"微信"}),e(i,{prop:"status",label:"在职状态","min-width":"120"},{default:l(t=>[s(c(["","在职","离职","调岗"][t.row.status]),1)]),_:1}),e(i,{prop:"isExhibitionContact",label:"展会联系人"},{default:l(t=>[s(c(t.row.isExhibitionContact===1?"是":"否"),1)]),_:1}),e(i,{label:"操作",fixed:"right",width:"150"},{default:l(t=>[e(p,{link:"",type:"primary",onClick:T=>o.setEdit(t.row)},{default:l(()=>[s("编辑")]),_:2},1032,["onClick"]),e(p,{link:"",type:"danger",onClick:T=>o.del(t.row.id)},{default:l(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},512)])]),_:1}),$(E)==="2"?(u(),w(Y,{key:0,label:"订单",name:2},{default:l(()=>[dl,e(W,{data:r.value.orderPosition,border:"","show-overflow-tooltip":""},{default:l(()=>[e(i,{prop:"orderCode",label:"订单编号","min-width":"120"}),e(i,{prop:"brand",label:"品牌"}),e(i,{prop:"positionCode",label:"展位号"}),e(i,{prop:"price",label:"订单金额","min-width":"120"}),e(i,{label:"操作",width:"150",fixed:"right"},{default:l(t=>[e(p,{link:"",type:"primary",onClick:T=>a.$router.push({name:"OrderBoothDetail",query:{id:t.row.id}})},{default:l(()=>[s("详情")]),_:2},1032,["onClick"]),t.row.orderStatus===1?(u(),w(p,{key:0,link:"",type:"primary",onClick:T=>Q(t.row.id,1)},{default:l(()=>[s("撤销")]),_:2},1032,["onClick"])):(u(),y(U,{key:1},[e(p,{link:"",type:"info",disabled:""},{default:l(()=>[s("已撤销")]),_:1}),e(p,{link:"",type:"danger",onClick:T=>m(t.row.id,1)},{default:l(()=>[s("删除")]),_:2},1032,["onClick"])],64))]),_:1})]),_:1},8,["data"]),rl,e(W,{data:r.value.orderMaterial,border:"","show-overflow-tooltip":""},{default:l(()=>[e(i,{prop:"orderCode",label:"订单编号","min-width":"120"}),e(i,{prop:"positionCode",label:"展位号"}),e(i,{prop:"price",label:"订单金额","min-width":"120"}),e(i,{label:"操作",width:"150",fixed:"right"},{default:l(t=>[e(p,{link:"",type:"primary",onClick:T=>X(t.row.id)},{default:l(()=>[s("详情")]),_:2},1032,["onClick"]),t.row.orderStatus===1?(u(),w(p,{key:0,link:"",type:"primary",onClick:T=>Q(t.row.id,2)},{default:l(()=>[s("撤销")]),_:2},1032,["onClick"])):(u(),y(U,{key:1},[e(p,{link:"",type:"info",disabled:""},{default:l(()=>[s("已撤销")]),_:1}),e(p,{link:"",type:"danger",onClick:T=>m(t.row.id,2)},{default:l(()=>[s("删除")]),_:2},1032,["onClick"])],64))]),_:1})]),_:1},8,["data"])]),_:1})):R("",!0),$(E)==="2"?(u(),w(Y,{key:1,label:"合同",name:3},{default:l(()=>[e(W,{data:r.value.contract,border:"","show-overflow-tooltip":""},{default:l(()=>[e(i,{prop:"contractCode",label:"合同编号","min-width":"120"}),e(i,{prop:"contractType",label:"合同类型","min-width":"120"},{default:l(t=>[s(c({1:"展位合同",2:"物料合同",3:"展位+物料"}[t.row.contractType]),1)]),_:1}),e(i,{prop:"",label:"付款方式","min-width":"120"},{default:l(t=>[s(c("银行转账"))]),_:1}),e(i,{prop:"contractAmount",label:"合同金额","min-width":"120"}),e(i,{prop:"deposit",label:"预定金"}),e(i,{prop:"",label:"抵扣"}),e(i,{prop:"firstPayPrice",label:"一期款"}),e(i,{prop:"firstPayTime",label:"期限"}),e(i,{prop:"finalPayPrice",label:"尾款"}),e(i,{prop:"finalPayTime",label:"期限"}),e(i,{prop:"receivedPrice",label:"已收款"}),e(i,{prop:"unknownPrice",label:"未收款"}),e(i,{prop:"contractStatus",label:"合同状态","min-width":"120"},{default:l(t=>[s(c({0:"撤销",1:"已完成"}[t.row.contractStatus]),1)]),_:1}),e(i,{label:"操作",width:"150",fixed:"right"},{default:l(t=>[e(p,{link:"",type:"primary"},{default:l(()=>[s("详情")]),_:1}),t.row.orderStatus===1?(u(),w(p,{key:0,link:"",type:"primary"},{default:l(()=>[s("撤销")]),_:1})):(u(),y(U,{key:1},[e(p,{link:"",type:"info",disabled:""},{default:l(()=>[s("已撤销")]),_:1}),e(p,{link:"",type:"danger"},{default:l(()=>[s("删除")]),_:1})],64))]),_:1})]),_:1},8,["data"])]),_:1})):R("",!0)]),_:1},8,["modelValue","onTabChange"])]),d("div",ul,[e(Ge,{ref_key:"followUp",ref:S,clueId:$(b)},null,8,["clueId"])])])]),e(fe,{title:o.isEdit?"编辑":"添加联系人",modelValue:o.show,"onUpdate:modelValue":n[14]||(n[14]=t=>o.show=t),width:"500px",draggable:""},{footer:l(()=>[e(p,{type:"default",onClick:n[13]||(n[13]=t=>o.show=!1)},{default:l(()=>[s("取消")]),_:1}),o.isEdit?(u(),w(p,{key:0,type:"primary",onClick:o.edit},{default:l(()=>[s("修改")]),_:1},8,["onClick"])):(u(),w(p,{key:1,type:"primary",onClick:o.add},{default:l(()=>[s("添加")]),_:1},8,["onClick"]))]),default:l(()=>[e(K,{model:o.form,"label-width":"auto"},{default:l(()=>[e(f,{label:"姓名"},{default:l(()=>[e(P,{modelValue:o.form.name,"onUpdate:modelValue":n[4]||(n[4]=t=>o.form.name=t)},null,8,["modelValue"])]),_:1}),e(f,{label:"职务"},{default:l(()=>[e(P,{modelValue:o.form.duties,"onUpdate:modelValue":n[5]||(n[5]=t=>o.form.duties=t)},null,8,["modelValue"])]),_:1}),e(f,{label:"类别"},{default:l(()=>[e(Z,{modelValue:o.form.type,"onUpdate:modelValue":n[6]||(n[6]=t=>o.form.type=t)},{default:l(()=>[e(I,{label:"无",value:0}),e(I,{label:"展位",value:1}),e(I,{label:"财务",value:2}),e(I,{label:"市场",value:3}),e(I,{label:"现场",value:4})]),_:1},8,["modelValue"])]),_:1}),e(f,{label:"手机号"},{default:l(()=>[e(P,{modelValue:o.form.mobile,"onUpdate:modelValue":n[7]||(n[7]=t=>o.form.mobile=t)},null,8,["modelValue"])]),_:1}),e(f,{label:"电话"},{default:l(()=>[e(P,{modelValue:o.form.tel,"onUpdate:modelValue":n[8]||(n[8]=t=>o.form.tel=t)},null,8,["modelValue"])]),_:1}),e(f,{label:"邮箱"},{default:l(()=>[e(P,{modelValue:o.form.email,"onUpdate:modelValue":n[9]||(n[9]=t=>o.form.email=t)},null,8,["modelValue"])]),_:1}),e(f,{label:"微信"},{default:l(()=>[e(P,{modelValue:o.form.wechat,"onUpdate:modelValue":n[10]||(n[10]=t=>o.form.wechat=t)},null,8,["modelValue"])]),_:1}),e(f,{label:"在职状态"},{default:l(()=>[e(Z,{modelValue:o.form.status,"onUpdate:modelValue":n[11]||(n[11]=t=>o.form.status=t)},{default:l(()=>[e(I,{label:"在职",value:1}),e(I,{label:"离职",value:2}),e(I,{label:"调岗",value:3})]),_:1},8,["modelValue"])]),_:1}),o.isEdit?(u(),w(f,{key:0,label:"展会联系人"},{default:l(()=>[e(h,{modelValue:o.form.isExhibitionContact,"onUpdate:modelValue":n[12]||(n[12]=t=>o.form.isExhibitionContact=t),class:"ml-4"},{default:l(()=>[e(k,{value:1},{default:l(()=>[s("是")]),_:1}),e(k,{value:0},{default:l(()=>[s("否")]),_:1})]),_:1},8,["modelValue"])]),_:1})):R("",!0)]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),e(Fe,{ref_key:"moveRef",ref:V,onCallback:x},null,512),e(Se,{ref_key:"detailRef",ref:N},null,512)],64)}}}),et=pe(pl,[["__scopeId","data-v-89ca0c2b"]]);export{et as default};
