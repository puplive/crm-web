import{d as ue,t as d,y as re,z as U,c as ce,b as p,X as t,$ as o,i,J as w,a1 as y,Y as _,Z as b,a5 as pe,am as me,a7 as f,o as s,h as z,n as ve,a2 as _e,a3 as he}from"./index-B35sW-aj.js";import{E as be,a as fe}from"./table-column-mknPiwPB.js";import"./checkbox-sIbdl2aD.js";/* empty css                */import"./popper-BBb83dzG.js";import{E as ge}from"./scrollbar-C2oBSu3r.js";/* empty css              */import{E as xe}from"./input-number-DHmgSHk8.js";import"./tag-B1SDh5lN.js";import{E as we}from"./button-DjNKuFKs.js";import{E as ye}from"./image-viewer-CkmEEaUG.js";import{a as Ce,E as Ie}from"./form-item-BFhIrQ1a.js";/* empty css                      */import{E as Ee,a as ke}from"./select-BlcfRgt6.js";import{g as Ve,c as C}from"./index-DHs4HuP6.js";import{e as ze}from"./index-DLf7VRYS.js";import{g as Se}from"./index-Bzj2U6p6.js";import{h as qe}from"./index-ClhcpLcp.js";/* empty css                */import{E as De}from"./index-DDqT4Lzm.js";import{E as Ne,a as Ue,b as Be}from"./index-CyZx5QMt.js";import{_ as Me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-form-item-CR1DnBFV.js";import"./_initCloneObject-B44hSgFU.js";import"./event-BB_Ol6Sd.js";import"./isEqual-B_2UcdhL.js";import"./focus-trap-Dbp5ay4M.js";import"./index-DL9kizoD.js";import"./scroll-uWFJ1g_Z.js";import"./castArray-Dn1cwXOK.js";import"./_baseClone-CZF_EFSh.js";import"./dropdown-CFEpO3EK.js";import"./refs-DSS_LDrZ.js";const Z=S=>(_e("data-v-1d3dfbba"),S=S(),he(),S),Re={class:"goods-reserve"},Ze={class:"s-top_bar"},je={key:1,style:{width:"166px","text-align":"center",padding:"10px"}},Le={class:"row"},Te={class:"col col1"},$e={class:"goods-type"},Fe=["onClick"],Ae={class:"col col2"},He={class:"goods-list"},Je={class:"msg"},Oe=["title"],Pe=["title"],Xe=Z(()=>t("label",{for:""},"规格(尺寸)：",-1)),Ye=["title"],Ge=Z(()=>t("label",{for:""},"单  价：",-1)),Ke={class:"p"},Qe=Z(()=>t("label",{for:""},"库  存：",-1)),We={class:"col col3"},el={class:"table"},ll={class:"bottom-bar"},ol={class:"p1"},tl={class:"p2"},al=ue({__name:"Reserve",setup(S){const O=pe(),g=me(),n=d(g.query.exhibitionId?Number(g.query.exhibitionId):""),m=d(g.query.exhibitorId?Number(g.query.exhibitorId):""),r=d(g.query.hallCode||""),u=d(g.query.positionCode||""),P=g.query.clueId,q=d(0),I=d([]),E=d({}),x=d([]),j=d([]),L=d([]),T=d([]),D=d([]);re({});const X=(l,a=1)=>{C.addCart({exhibitorId:m.value,exhibitionId:n.value,hallCode:r.value,positionCode:u.value,id:l.id,num:a}).then(v=>{v.code===0?(f.success("添加成功"),h()):f.error(v.msg)})},Y=(l,a=1)=>{C.editCart({exhibitorId:m.value,exhibitionId:n.value,hallCode:r.value,positionCode:u.value,id:l.id,num:a}).then(v=>{v.code===0?f.success("成功"):f.error(v.msg),h()})},G=l=>{C.delCart({exhibitorId:m.value,exhibitionId:n.value,hallCode:r.value,positionCode:u.value,id:l.id,num:l.num}).then(a=>{a.code===0?(f.success("删除成功"),h()):f.error(a.msg)})},K=l=>{E.value=I.value[l]},Q=()=>{ze().then(l=>{l.code===0&&(j.value=l.data)})},$=()=>{Se({exhibitionId:n.value}).then(l=>{l.code===0&&(L.value=l.data)})},F=()=>{Ve({exhibitionId:n.value}).then(l=>{l.code===0&&(T.value=l.data)})},B=()=>{D.value=[],qe({exhibitionId:n.value,hallCode:r.value}).then(l=>{l.code===0&&(D.value=l.data)})},A=()=>{C.getMaterial({exhibitionId:n.value}).then(l=>{l.code===0&&(I.value=l.data,I.value.length>0?E.value=I.value[0]:E.value={})})},h=()=>{if(!n.value||!r.value||!u.value){x.value=[];return}C.getCart({exhibitorId:m.value,exhibitionId:n.value,hallCode:r.value,positionCode:u.value}).then(l=>{l.code===0&&(x.value=l.data)})},N=d(!1),W=()=>{N.value=!0,C.create({clueId:P,exhibitionId:n.value,exhibitorId:m.value,hallCode:r.value,positionCode:u.value,price:q.value,data:x.value.map(l=>({...l,remark:""}))}).then(l=>{l.code===0?(f.success("提交成功"),O.go(-1)):f.error(l.msg),N.value=!1}).catch(l=>{N.value=!1})};U(()=>n.value,l=>{r.value="",u.value="",m.value="",$(),F(),B(),A(),h()}),U(()=>m.value,l=>{h()}),U(()=>r.value,l=>{u.value="",B(),h()}),U(()=>u.value,l=>{h()});const ee=ce(()=>{let l=0;return x.value.forEach(a=>{l+=a.price*a.num}),q.value=l,l});return Q(),$(),F(),B(),A(),h(),(l,a)=>{const v=Ee,M=ke,k=Ce,H=De,le=Ne,oe=Ue,te=Be,ae=Ie,ie=ye,R=we,se=ge,V=fe,ne=xe,de=be;return s(),p("div",Re,[t("div",Ze,[o(ae,{inline:!0},{default:i(()=>[o(k,{label:"展会名称",style:{width:"220px"}},{default:i(()=>[o(M,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),placeholder:"请选择展会名称",disabled:""},{default:i(()=>[(s(!0),p(w,null,y(j.value,e=>(s(),z(v,{key:e.id,label:e.exhibitionName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(k,{label:"参展企业",style:{width:"220px"}},{default:i(()=>[o(M,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),placeholder:"请选择参展企业",disabled:""},{default:i(()=>[(s(!0),p(w,null,y(L.value,e=>(s(),z(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(k,{label:"展馆",style:{width:"220px"}},{default:i(()=>[o(M,{modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value=e),placeholder:"请选择展馆"},{default:i(()=>[(s(!0),p(w,null,y(T.value,e=>(s(),z(v,{key:e.code,label:e.code,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(k,{label:"展位号",style:{width:"220px"}},{default:i(()=>[o(te,{trigger:"click",style:{width:"100%"},"max-height":"300px",onCommand:a[4]||(a[4]=e=>{u.value=e})},{dropdown:i(()=>[D.value.length?(s(),z(oe,{key:0},{default:i(()=>[(s(!0),p(w,null,y(D.value,(e,c)=>(s(),z(le,{key:c,style:{width:"166px"},command:e},{default:i(()=>[_(b(e),1)]),_:2},1032,["command"]))),128))]),_:1})):(s(),p("div",je,"无数据"))]),default:i(()=>[o(H,{modelValue:u.value,"onUpdate:modelValue":a[3]||(a[3]=e=>u.value=e),autocomplete:"off","suffix-icon":"ArrowDown"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),t("div",Le,[t("div",Te,[t("ul",$e,[(s(!0),p(w,null,y(I.value,(e,c)=>(s(),p("li",{key:c,onClick:J=>K(c),class:ve({active:e.project===E.value.project})},b(e.project),11,Fe))),128))])]),t("div",Ae,[o(se,null,{default:i(()=>[t("div",He,[(s(!0),p(w,null,y(E.value.data,(e,c)=>(s(),p("li",{key:c},[o(ie,{style:{width:"100%",height:"200px"},src:e.img,"preview-src-list":[e.img],fit:"contain"},null,8,["src","preview-src-list"]),t("div",Je,[t("p",{class:"title",title:e.position},b(e.position),9,Oe),t("p",{class:"p",title:e.size},[Xe,_(b(e.size),1)],8,Pe),t("p",{class:"p",title:e.price+"元/"+e.unit},[Ge,t("span",null,b(e.price+"元/"+e.unit),1)],8,Ye),t("p",Ke,[Qe,_(b(e.stock),1)])]),o(R,{type:"primary",onClick:J=>X(e),disabled:e.stock<=0,style:{width:"100%"}},{default:i(()=>[_("加入购物车")]),_:2},1032,["onClick","disabled"])]))),128))])]),_:1})]),t("div",We,[t("div",el,[o(de,{data:x.value,border:""},{default:i(()=>[o(V,{label:"服务项目",prop:"project","min-width":"120"}),o(V,{label:"位置/版面",prop:"position","min-width":"120"}),o(V,{label:"规格",prop:"size"}),o(V,{label:"单价(RMB)",prop:"price","min-width":"120"}),o(V,{label:"数量",width:"200px"},{default:i(e=>[o(ne,{modelValue:e.row.num,"onUpdate:modelValue":c=>e.row.num=c,min:1,size:"small",onChange:(c,J)=>{Y(e.row,c)}},null,8,["modelValue","onUpdate:modelValue","onChange"]),o(R,{type:"danger",link:"",onClick:c=>G(e.row),style:{"margin-left":"10px"},icon:"Delete"},null,8,["onClick"])]),_:1})]),_:1},8,["data"])]),t("div",ll,[t("div",ol,[t("span",null,[_("已选物料 "),t("b",null,b(x.value.length),1),_(" 项")]),_(),t("span",null,[_("物料金额 "),t("b",null,"¥"+b(ee.value),1)])]),t("div",tl,[o(k,{label:"最终金额",style:{width:"100%","margin-bottom":"0"}},{default:i(()=>[o(H,{modelValue:q.value,"onUpdate:modelValue":a[5]||(a[5]=e=>q.value=e)},null,8,["modelValue"])]),_:1})]),o(R,{type:"primary",style:{width:"100%"},onClick:W,loading:N.value,disabled:x.value.length<=0},{default:i(()=>[_("提交")]),_:1},8,["loading","disabled"])])])])])}}}),jl=Me(al,[["__scopeId","data-v-1d3dfbba"]]);export{jl as default};
