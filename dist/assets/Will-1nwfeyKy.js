import{d as ie,l as d,s as P,O as ne,o as f,f as x,P as p,S as o,w as l,F as y,W as M,Q as i,R as k,c as I,X as L,_ as se,$ as de}from"./index-DwAgI1Tl.js";/* empty css                     *//* empty css                 */import"./el-tag-D6VPebGv.js";/* empty css                  */import"./el-scrollbar-DTrg2_7X.js";import{E as me}from"./el-dialog-DMsbJQVF.js";/* empty css                   *//* empty css                 */import{E as pe}from"./el-pagination-D4U8PUty.js";import{E as ue,a as ce}from"./el-table-column-CvwqpgAn.js";import"./el-checkbox-CRfvpewy.js";import"./el-tooltip-l0sNRNKZ.js";import{E as fe}from"./el-link-CT9P6rxy.js";import"./el-button-GUz3KSyk.js";/* empty css                        */import{a as _e,b as he,E as ge}from"./el-dropdown-item-T7Wu-lRy.js";import{T as ve}from"./index-Ftf6LD-q.js";import{a as h}from"./index-Ds0FgR9u.js";import{e as be}from"./index-CwLbDGAK.js";import{g as we}from"./index-ybtfLND-.js";/* empty css                   *//* empty css                       */import{a as m}from"./request-BwuiVass.js";import{E as Ie}from"./index-CDOkj85A.js";import{E as xe}from"./index-D16Dp-E5.js";import{E as ye}from"./index-lrMaDoJ7.js";import{E as ke}from"./index-C9PHBgDn.js";import{E as Ce,a as Ee}from"./index-nY2QOu6q.js";import{E as Se,a as ze}from"./index-C036lfxA.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_initCloneObject-l7c9p7aB.js";import"./isEqual-zCtjQBmP.js";import"./typescript-CxgQ9MvV.js";import"./index-BbG6rCDq.js";import"./scroll-JpeTjL8h.js";import"./vnode-D3ksiN5I.js";import"./refs-Dc-3pehd.js";import"./event-BB_Ol6Sd.js";import"./index-GYZblRXP.js";import"./isArrayLikeObject-Bza-7IAp.js";import"./castArray-BpHTYSK8.js";/* empty css                                                              *//* empty css                       *//* empty css                          */import"./index-kfaxJUyY.js";import"./arrays-6TrVLtTe.js";import"./index-BuECwlFc.js";import"./aria-KgdLjl5h.js";import"./validator-BLI_r8Zw.js";import"./_baseClone-sCyLxnY1.js";const C=w=>(se("data-v-0fba6ca4"),w=w(),de(),w),Ue={class:"s-flex-col",style:{height:"100%"}},Ne={class:"",style:{"margin-bottom":"10px"}},Re={class:"el-dropdown-link"},De={class:"s-table-operations"},Fe={class:"s-flex-auto",style:{"min-height":"0"}},Te={class:"s-table-pagination"},$e=C(()=>p("div",{style:{"font-size":"15px","margin-bottom":"2px",color:"#444"}},"请在下列线索中选择主线索，合并后：",-1)),Be=C(()=>p("p",null,"1. 被合并线索下的动态迁移到主线索下",-1)),Pe=C(()=>p("p",null,"2. 合并后的线索以主线索为主，并保留两条线索的所有记录",-1)),Me={class:"dialog-footer"},Le={class:"dialog-footer"},qe=ie({__name:"Will",setup(w){const E=d("全部"),S=d(""),_=P({page:1,perPage:10}),z=d(0),V=d({}),U=d([]),g=d(null),N=d([]),R=d([]),q=e=>{V.value=e,_.page=1,u()},u=async()=>{h.getList({status:2,exhibitionId:S.value,..._,...V.value}).then(e=>{e.code===0&&(U.value=e.data.data,z.value=e.data.total)})},r=P({show:!1,data:[],masterId:"",mergeId:"",ref:null,set:()=>{let e=g.value.getSelectionRows();if(e.length!==2){m.warning("请选择需要合并的线索，必须选择两个");return}r.show=!0,r.data=e,r.masterId=e[0].id,r.mergeId=e[1].id},sub:()=>{h.merge({masterId:r.masterId,mergeId:r.mergeId}).then(e=>{e.code===0?(m.success("合并成功"),r.show=!1,u()):m.error(e.msg)})}}),W=()=>{let e=g.value.getSelectionRows().map(a=>a.id);if(e.length===0){m.warning("请选择需要删除的线索");return}Ie.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{h.del({id:e}).then(a=>{a.code===0?(m.success("删除成功"),u()):m.error(a.msg)})}).catch(()=>{})},v=d({}),b=d(!1),D=d(null),F=d([]),O=()=>{let e=g.value.getSelectionRows().map(a=>a.id);if(e.length===0){m.warning("请选择需要转移的线索");return}v.value.id=e,b.value=!0},G=()=>{D.value.validate(e=>{e&&h.changeUser(v.value).then(a=>{a.code===0?(m.success("转移成功"),b.value=!1,u()):m.error(a.msg)})})},H=()=>{let e=g.value.getSelectionRows().map(a=>a.id);if(e.length===0){m.warning("请选择需要移至公海的线索");return}h.changePublic({id:e}).then(a=>{a.code===0?(m.success("移至公海成功"),u()):m.error(a.msg)})},Q=()=>{console.log("import")},X=()=>{console.log("export")};h.getSearchField().then(e=>{e.code===0&&(N.value=e.data)}),be().then(e=>{e.code===0&&(R.value=[{exhibitionName:"全部",id:""},...e.data])}),we().then(e=>{e.code===0&&(F.value=e.data)});const j=e=>{console.log(e),E.value=e.exhibitionName,S.value=e.id,u()};return u(),(e,a)=>{const A=ne("arrow-down"),J=xe,K=ge,Y=_e,Z=he,n=ye,s=ue,ee=fe,T=ce,oe=pe,te=ke,$=me,B=Ce,ae=ze,le=Se,re=Ee;return f(),x(y,null,[p("div",Ue,[p("div",Ne,[o(Z,{onCommand:j,style:{outline:"none"}},{dropdown:l(()=>[o(Y,null,{default:l(()=>[(f(!0),x(y,null,M(R.value,(t,c)=>(f(),I(K,{key:c,command:t},{default:l(()=>[i(k(t.exhibitionName),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:l(()=>[p("span",Re,[i(k(E.value),1),o(J,{class:"el-icon--right"},{default:l(()=>[o(A)]),_:1})])]),_:1})]),o(ve,{data:N.value,onSearch:q},null,8,["data"]),p("div",De,[o(n,{size:"small",onClick:O},{default:l(()=>[i("转移")]),_:1}),o(n,{size:"small",onClick:H},{default:l(()=>[i("移至公海")]),_:1}),o(n,{size:"small",onClick:r.set},{default:l(()=>[i("合并")]),_:1},8,["onClick"]),o(n,{size:"small",onClick:X},{default:l(()=>[i("导出")]),_:1}),o(n,{size:"small",onClick:W},{default:l(()=>[i("删除")]),_:1}),o(n,{size:"small",onClick:a[0]||(a[0]=t=>e.$router.push("/market/clues/add"))},{default:l(()=>[i("新建线索")]),_:1}),o(n,{size:"small",onClick:Q},{default:l(()=>[i("导入线索")]),_:1})]),p("div",Fe,[o(T,{ref_key:"tableRef",ref:g,data:U.value,border:"","table-layout":"fixed",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:l(()=>[o(s,{type:"selection",width:"42"}),o(s,{prop:"companyName",label:"公司名称",width:"180"},{default:l(t=>[o(ee,{href:"/market/clues/info?type=2&id="+t.row.id+"&exhibitionId="+t.row.exhibitionId+"&authUser="+t.row.authUser,type:"primary"},{default:l(()=>[i(k(t.row.companyName),1)]),_:2},1032,["href"])]),_:1}),o(s,{prop:"exhibitionContact",label:"联系方式",width:"180"}),o(s,{prop:"duties",label:"职务"}),o(s,{prop:"phone",label:"电话"}),o(s,{prop:"recordTime",label:"记录时间",width:"180"}),o(s,{prop:"recordText",label:"记录内容"}),o(s,{prop:"authUser",label:"授权人"}),o(s,{fixed:"right",label:"操作",width:"180"},{default:l(t=>[t.row.orderPositionStatus?(f(),I(n,{key:0,link:"",type:"primary",size:"small",onClick:c=>e.$router.push({name:"HallLayout",query:{clueId:t.row.id,exhibitionId:t.row.exhibitionId,exhibitorId:t.row.exhibitorId}})},{default:l(()=>[i(" 展位预定 ")]),_:2},1032,["onClick"])):L("",!0),t.row.orderMaterialStatus?(f(),I(n,{key:1,link:"",type:"primary",size:"small",onClick:c=>e.$router.push({name:"GoodsReserve",query:{clueId:t.row.id,exhibitionId:t.row.exhibitionId,exhibitorId:t.row.exhibitorId,hallCode:t.row.hallCode,positionCode:t.row.positionCode}})},{default:l(()=>[i(" 物料预定 ")]),_:2},1032,["onClick"])):L("",!0)]),_:1})]),_:1},8,["data"])]),p("div",Te,[o(oe,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:z.value,"current-page":_.page,"onUpdate:currentPage":a[1]||(a[1]=t=>_.page=t),"page-size":_.perPage,"onUpdate:pageSize":a[2]||(a[2]=t=>_.perPage=t),onChange:u},null,8,["total","current-page","page-size"])])]),o($,{modelValue:r.show,"onUpdate:modelValue":a[6]||(a[6]=t=>r.show=t),title:"合并销售线索",width:"500",draggable:""},{footer:l(()=>[p("div",Me,[o(n,{onClick:a[5]||(a[5]=t=>r.show=!1)},{default:l(()=>[i("取消")]),_:1}),o(n,{type:"primary",onClick:r.sub},{default:l(()=>[i("确定")]),_:1},8,["onClick"])])]),default:l(()=>[$e,Be,Pe,o(T,{data:r.data,border:"","show-overflow-tooltip":"","header-row-class-name":"s-table-header",onCurrentChange:a[4]||(a[4]=t=>{let c=r.masterId;r.masterId=t.id,r.mergeId=c})},{default:l(()=>[o(s,{label:"主线索",width:"70"},{default:l(t=>[o(te,{value:t.row.id,modelValue:r.masterId,"onUpdate:modelValue":a[3]||(a[3]=c=>r.masterId=c)},null,8,["value","modelValue"])]),_:1}),o(s,{prop:"companyName",label:"公司名称"}),o(s,{prop:"exhibitionName",label:"展会姓名"}),o(s,{prop:"authUser",label:"线索所有人"})]),_:1},8,["data"])]),_:1},8,["modelValue"]),o($,{modelValue:b.value,"onUpdate:modelValue":a[9]||(a[9]=t=>b.value=t),title:"转移销售线索",width:"500",draggable:""},{footer:l(()=>[p("div",Le,[o(n,{onClick:a[8]||(a[8]=t=>b.value=!1)},{default:l(()=>[i("取消")]),_:1}),o(n,{type:"primary",onClick:G},{default:l(()=>[i("确定")]),_:1})])]),default:l(()=>[o(re,{ref_key:"moveFormRef",ref:D,model:v.value,"label-width":"auto"},{default:l(()=>[o(B,{label:""},{default:l(()=>[i("是否将选中的销售线索转移？")]),_:1}),o(B,{label:"销售线索所有人",prop:"userId",rules:[{required:!0,message:"请选择销售线索所有人"}]},{default:l(()=>[o(le,{modelValue:v.value.userId,"onUpdate:modelValue":a[7]||(a[7]=t=>v.value.userId=t),placeholder:""},{default:l(()=>[(f(!0),x(y,null,M(F.value,t=>(f(),I(ae,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),Lo=Ve(qe,[["__scopeId","data-v-0fba6ca4"]]);export{Lo as default};
