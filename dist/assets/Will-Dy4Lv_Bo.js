import{d as J,l as m,s as V,b as v,O as u,R as o,i as a,F as x,N as K,o as w,U as D,h as F,P as r,Q as p,a3 as Z,X as ee,Y as te}from"./index-zlANHd7e.js";import{E as oe}from"./el-dialog-D13fHHlx.js";/* empty css                   */import{E as ae}from"./el-radio-C6ZLIxe9.js";import{E as ie}from"./el-pagination-BhbJw-zf.js";/* empty css                 */import"./el-tag-DUB2I-gd.js";import"./el-select-C2hARmzT.js";import"./el-scrollbar-CPay5iue.js";import"./el-popper-1GHiwXiB.js";import{E as le,a as ne}from"./el-table-column-UtBrofRD.js";import"./el-checkbox-DR4JUmmt.js";import"./el-tooltip-l0sNRNKZ.js";import{E as re}from"./el-link-DIJJZtUk.js";/* empty css                  *//* empty css                        */import{b as se,E as de,a as me}from"./el-dropdown-item-DQuq1G-Q.js";import{T as pe}from"./index-kQDDLAXP.js";import{_ as ue}from"./Move.vue_vue_type_script_setup_true_lang-DEDtFoNs.js";import{a as _}from"./index-C1Pko6pm.js";import{e as ce}from"./index-wH4mDk0e.js";import{d as he}from"./tool-BQQRKqby.js";/* empty css                   *//* empty css                       */import{c as s,b as _e}from"./request-TyN6Ve8j.js";import{E as fe}from"./index-C8NBWVyc.js";import{E as we}from"./index-DYWVEy4c.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-B_zZafk3.js";import"./use-form-item-5dcFKqpy.js";import"./scroll-DrF4-1Ea.js";import"./vnode-zJf0LmWf.js";import"./refs-CCR_WVx9.js";import"./event-BB_Ol6Sd.js";import"./isEqual-CisndQCM.js";import"./_initCloneObject-DoxQbTWm.js";import"./index-BLcBCAsv.js";import"./castArray-Bz547DyE.js";import"./el-form-item-AsVT0Bba.js";import"./_baseClone-CaM9o8tD.js";/* empty css                                                              */import"./index-Ck6OHcpz.js";import"./aria-KgdLjl5h.js";import"./validator-cTHiTXif.js";const y=b=>(ee("data-v-3a1e873a"),b=b(),te(),b),be={class:"s-flex-col",style:{height:"100%"}},ve={class:"",style:{"margin-bottom":"10px"}},xe={class:"s-table-operations"},ye={class:"s-flex-auto",style:{"min-height":"0"}},Ce={class:"s-table-pagination"},Ie=y(()=>u("div",{style:{"font-size":"15px","margin-bottom":"2px",color:"#444"}},"请在下列线索中选择主线索，合并后：",-1)),ke=y(()=>u("p",null,"1. 被合并线索下的动态迁移到主线索下",-1)),Ee=y(()=>u("p",null,"2. 合并后的线索以主线索为主，并保留两条线索的所有记录",-1)),Se={class:"dialog-footer"},Ne=J({__name:"Will",setup(b){const C=m("全部"),I=m(""),f=V({page:1,perPage:10}),k=m(0),E=m({}),S=m([]),g=m(null),N=m([]),z=m([]),T=t=>{E.value=t,f.page=1,c()},c=async()=>{_.getList({status:2,exhibitionId:I.value,...f,...E.value}).then(t=>{t.code===0&&(S.value=t.data.data,k.value=t.data.total)})},n=V({show:!1,data:[],masterId:"",mergeId:"",ref:null,set:()=>{let t=g.value.getSelectionRows();if(t.length!==2){s.warning("请选择需要合并的线索，必须选择两个");return}n.show=!0,n.data=t,n.masterId=t[0].id,n.mergeId=t[1].id},sub:()=>{_.merge({masterId:n.masterId,mergeId:n.mergeId}).then(t=>{t.code===0?(s.success("合并成功"),n.show=!1,c()):s.error(t.msg)})}}),B=()=>{let t=g.value.getSelectionRows().map(i=>i.id);if(t.length===0){s.warning("请选择需要删除的线索");return}fe.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{_.del({id:t}).then(i=>{i.code===0?(s.success("删除成功"),c()):s.error(i.msg)})}).catch(()=>{})},R=m(null),M=()=>{let t=g.value.getSelectionRows().map(i=>i.id);if(t.length===0){s.warning("请选择需要转移的线索");return}R.value.setMove(t)},L=()=>{let t=g.value.getSelectionRows().map(i=>i.id);if(t.length===0){s.warning("请选择需要移至公海的线索");return}_.changePublic({id:t}).then(i=>{i.code===0?(s.success("移至公海成功"),c()):s.error(i.msg)})},$=()=>{_.clueExport({status:2}).then(t=>{t.code===0?(s.success("导出成功"),he(t.data.url,"线索列表.xlsx")):s.error(t.msg)})};_.getSearchField().then(t=>{t.code===0&&(N.value=t.data)}),ce().then(t=>{t.code===0&&(z.value=[{exhibitionName:"全部",id:""},...t.data])});const W=t=>{C.value=t.exhibitionName,I.value=t.id,c()},P=m([]);return(()=>{_.getCustomField().then(t=>{t.code===0&&(P.value=t.data)})})(),c(),(t,i)=>{const q=K("arrow-down"),A=_e,d=we,G=de,H=me,O=se,l=ne,Q=re,U=le,X=ie,Y=ae,j=oe;return w(),v(x,null,[u("div",be,[u("div",ve,[o(O,{onCommand:W,"max-height":"80vh",placement:"bottom-start"},{dropdown:a(()=>[o(H,null,{default:a(()=>[(w(!0),v(x,null,D(z.value,(e,h)=>(w(),F(G,{key:h,command:e},{default:a(()=>[r(p(e.exhibitionName),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:a(()=>[o(d,{text:""},{default:a(()=>[r(p(C.value),1),o(A,{class:"el-icon--right"},{default:a(()=>[o(q)]),_:1})]),_:1})]),_:1})]),o(pe,{data:N.value,onSearch:T},null,8,["data"]),u("div",xe,[o(d,{size:"small",onClick:M},{default:a(()=>[r("转移")]),_:1}),o(d,{size:"small",onClick:L},{default:a(()=>[r("移至公海")]),_:1}),o(d,{size:"small",onClick:n.set},{default:a(()=>[r("合并")]),_:1},8,["onClick"]),o(d,{size:"small",onClick:$},{default:a(()=>[r("导出")]),_:1}),o(d,{size:"small",onClick:B},{default:a(()=>[r("删除")]),_:1})]),u("div",ye,[o(U,{ref_key:"tableRef",ref:g,data:S.value,border:"","table-layout":"fixed",height:"100%","cell-style":{minWidth:"120px"},"show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:a(()=>[o(l,{type:"selection",width:"42",fixed:"left"}),o(l,{type:"index",label:"序号",width:"60"}),o(l,{prop:"companyName",label:"企业名称",width:"180"},{default:a(e=>[o(Q,{href:"/market/clues/info?type=2&id="+e.row.id+"&exhibitionId="+e.row.exhibitionId+"&authUser="+e.row.authUser,type:"primary"},{default:a(()=>[r(p(e.row.companyName),1)]),_:2},1032,["href"])]),_:1}),o(l,{prop:"exhibitionName",label:"展会名称",width:"180"}),o(l,{prop:"positionCode",label:"展位号"}),o(l,{prop:"positionType",label:"展位类型","min-width":"120"},{default:a(e=>[r(p({1:"标准",2:"特装"}[e.row.positionType]),1)]),_:1}),o(l,{prop:"positionArea",label:"展位面积","min-width":"120"}),o(l,{prop:"contractPosition",label:"展位合同","min-width":"120"},{default:a(e=>[r(p({0:"未签订",1:"已签订",2:"已回执"}[e.row.contractPosition]),1)]),_:1}),o(l,{prop:"contractMaterial",label:"物料合同","min-width":"120"},{default:a(e=>[r(p({0:"未签订",1:"已签订",2:"已回执"}[e.row.contractMaterial]),1)]),_:1}),o(l,{prop:"isExit",label:"是否退展","min-width":"120"},{default:a(e=>[r(p({0:"否",1:"是"}[e.row.isExit]),1)]),_:1}),o(l,{prop:"exhibitionContact",label:"展会联系人","min-width":"120"}),o(l,{prop:"duties",label:"职位","min-width":"120"}),o(l,{prop:"phone",label:"手机号","min-width":"120"}),(w(!0),v(x,null,D(P.value,e=>(w(),v(x,{key:e.key},[e.name=="通讯地址"||e.name=="主营业务"?(w(),F(l,{key:0,prop:e.key,label:e.name,"min-width":"120"},null,8,["prop","label"])):Z("",!0)],64))),128)),o(l,{prop:"authUser",label:"持有人"}),o(l,{fixed:"right",label:"操作",width:"220"},{default:a(e=>[o(d,{link:"",type:"primary",onClick:h=>t.$router.push({name:"HallLayout",query:{clueId:e.row.id,exhibitionId:e.row.exhibitionId,exhibitorId:e.row.exhibitorId}})},{default:a(()=>[r(p(e.row.orderPositionStatus?"新增":"")+"展位预定 ",1)]),_:2},1032,["onClick"]),o(d,{link:"",type:"primary",onClick:h=>t.$router.push({name:"GoodsReserve",query:{clueId:e.row.id,exhibitionId:e.row.exhibitionId,exhibitorId:e.row.exhibitorId,hallCode:e.row.hallCode,positionCode:e.row.positionCode}})},{default:a(()=>[r(p(e.row.orderMaterialStatus?"新增":"")+"物料预定 ",1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),u("div",Ce,[o(X,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:k.value,"current-page":f.page,"onUpdate:currentPage":i[0]||(i[0]=e=>f.page=e),"page-size":f.perPage,"onUpdate:pageSize":i[1]||(i[1]=e=>f.perPage=e),onChange:c},null,8,["total","current-page","page-size"])])]),o(j,{modelValue:n.show,"onUpdate:modelValue":i[5]||(i[5]=e=>n.show=e),title:"合并销售线索",width:"500",draggable:""},{footer:a(()=>[u("div",Se,[o(d,{onClick:i[4]||(i[4]=e=>n.show=!1)},{default:a(()=>[r("取消")]),_:1}),o(d,{type:"primary",onClick:n.sub},{default:a(()=>[r("确定")]),_:1},8,["onClick"])])]),default:a(()=>[Ie,ke,Ee,o(U,{data:n.data,border:"","show-overflow-tooltip":"","header-row-class-name":"s-table-header",onCurrentChange:i[3]||(i[3]=e=>{let h=n.masterId;n.masterId=e.id,n.mergeId=h})},{default:a(()=>[o(l,{label:"主线索",width:"70"},{default:a(e=>[o(Y,{value:e.row.id,modelValue:n.masterId,"onUpdate:modelValue":i[2]||(i[2]=h=>n.masterId=h)},null,8,["value","modelValue"])]),_:1}),o(l,{prop:"companyName",label:"公司名称","min-width":"120"}),o(l,{prop:"exhibitionName",label:"展会姓名","min-width":"120"}),o(l,{prop:"authUser",label:"线索所有人","min-width":"120"})]),_:1},8,["data"])]),_:1},8,["modelValue"]),o(ue,{ref_key:"moveRef",ref:R,onCallback:c},null,512)],64)}}}),vt=ge(Ne,[["__scopeId","data-v-3a1e873a"]]);export{vt as default};
