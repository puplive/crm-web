import{d as re,l as b,s as j,e as ue,v as A,O as H,o as c,f as _,P as p,R as U,a as L,S as e,w as a,Q as m,F as h,V,Z as se,a8 as ce,c as g,W as pe,_ as me,$ as fe}from"./index-BcUC0sDV.js";import{E as _e}from"./el-dialog-CutjZf8L.js";import"./el-overlay-9cAl29CD.js";import{E as be}from"./el-col-CZx1mcsV.js";import{a as he}from"./el-scrollbar-CPGzXslm.js";import{E as Pe,a as ve}from"./el-form-item-CQBJaBhb.js";import{E as Ve}from"./el-input-CcUaxfjM.js";import{E as ge}from"./el-button-VGFtfg9t.js";import"./el-tag-C8ilQtop.js";import{E as ye,a as we}from"./el-select-CaF897-I.js";import{E as xe,a as Ce}from"./el-radio-CAJOd0xn.js";import{g as Ee}from"./index-DHg2I1DM.js";import{g as Ne}from"./index-CJkpuRTR.js";import{E as ke}from"./index-tw6LFjf8.js";import{_ as Ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-31U4gXR_.js";import"./scroll-BDce9M3E.js";import"./vnode-kX9WXZTf.js";import"./typescript-BxLz-5vR.js";import"./_initCloneObject-D14UNdyY.js";import"./isEqual-DmOeXhXa.js";import"./request-LfwzVzzV.js";const F=x=>(me("data-v-337f5b87"),x=x(),fe(),x),Fe={class:"booth-reserve"},Ie={class:"l"},Se={class:"title"},Be=F(()=>p("span",null,"北京展会",-1)),Oe=F(()=>p("div",{class:"img-box"},null,-1)),Re={class:"r"},qe={class:"form-box"},Je=F(()=>p("div",null,"预定展位",-1)),De={style:{"text-align":"center"}},$e={style:{padding:"15px"}},Te={class:"dialog-footer"},ze=re({__name:"Reserve",setup(x){const Q=se(),P=ce(),I=P.query.clueId,E=P.query.exhibitionId,W=P.query.exhibitorId,C=P.query.hallCode,Z=P.query.exhibitionName,K=b([]),S=b([]),B=b([]),O=b([]),R=b([]),q=b([]),J={1:"%",2:"￥"},l=j({clueId:I,exhibitionId:E,exhibitorId:W,add:[],discount:[],position:[{hallCode:C,positionCode:"",companyBrand:[],product:"",unitPrice:"",type:1,length:0,width:0,costPrice:0,addPrice:0,discountPrice:0,finalPrice:0,deposit:0,isOffset:1,payType:1,ratio:0}]});b({});const t=j({show:!1,index:0,form:{product:"",unitPrice:"",num:1,length:"",width:""}}),M=d=>{t.form.unitPrice=d.price,t.form.product=d.text,t.form.num=d.num},X=ue(()=>t.form.unitPrice?t.form.unitPrice+"元/"+(t.form.num===1?"":t.form.num)+"㎡":""),Y=()=>{l.position.push({hallCode:C,positionCode:"",companyBrand:[],product:"",unitPrice:"",type:1,length:0,width:0,costPrice:0,addPrice:0,discountPrice:0,finalPrice:0,deposit:0,isOffset:1,payType:1,ratio:0})},ee=()=>{Q.push({name:"BoothCreateOrder",query:{...P.query,data:JSON.stringify(l)}})},oe=d=>{t.show=!0,t.index=d,t.form.product="",t.form.unitPrice="",t.form.length="",t.form.width="",t.form.num=1},le=()=>{t.show=!1;let d=t.form.length*t.form.width,o=d*t.form.unitPrice/t.form.num,n=D(o),u=$(o);l.position[t.index].product=t.form.product,l.position[t.index].unitPrice=t.form.unitPrice,l.position[t.index].length=t.form.length,l.position[t.index].width=t.form.width,l.position[t.index].area=d,l.position[t.index].costPrice=Number(o.toFixed(2)),l.position[t.index].addPrice=Number(n.toFixed(2)),l.position[t.index].discountPrice=Number(u.toFixed(2)),l.position[t.index].finalPrice=Number((o+n-u).toFixed(2))},D=d=>{let o=0;return l.add.forEach(n=>{let u=JSON.parse(n);u.unit===1?o+=d*u.price/100:u.unit===2&&(o+=u.price)}),o},$=d=>{let o=0;return l.discount.forEach(n=>{let u=JSON.parse(n);u.unit===1?o+=d*u.price/100:u.unit===2&&(o+=u.price)}),o};A(()=>l.add,d=>{l.position.forEach(o=>{o.addPrice=Number(D(o.costPrice).toFixed(2)),o.finalPrice=Number((o.costPrice+o.addPrice-o.discountPrice).toFixed(2))})}),A(()=>l.discount,d=>{l.position.forEach(o=>{o.discountPrice=Number($(o.costPrice).toFixed(2)),o.finalPrice=Number((o.costPrice+o.addPrice-o.discountPrice).toFixed(2))})});const te=d=>{let o=l.position[d].costPrice,n=l.position[d].addPrice,u=l.position[d].discountPrice;return Number((o+n-u).toFixed(2))};return Ne({exhibitionId:E,hallCode:C}).then(d=>{S.value=d.data}),Ee({clueId:I,exhibitionId:E}).then(d=>{let o=d.data;B.value=o.attachPrice.add,O.value=o.attachPrice.discount,R.value=o.companyBrand,q.value=o.unitPrice,K.value=o.exhibitionHall}),(d,o)=>{const n=Pe,u=xe,T=Ce,y=we,w=ye,v=ge,f=Ve,ae=H("DeleteFilled"),z=ke,G=ve,ie=he,N=be,ne=H("Close"),de=_e;return c(),_(h,null,[p("div",Fe,[p("div",Ie,[p("div",Se,[p("span",null,U(L(Z)),1),Be,p("span",null,"展馆号："+U(L(C)),1)]),Oe]),p("div",Re,[p("div",qe,[e(ie,{height:"100%"},{default:a(()=>[e(G,{model:l,"label-width":"auto",class:"form"},{default:a(()=>[Je,e(n,{label:"企业名称"}),e(n,{label:"新展商"},{default:a(()=>[e(T,{modelValue:l.resource,"onUpdate:modelValue":o[0]||(o[0]=i=>l.resource=i)},{default:a(()=>[e(u,{value:"1"},{default:a(()=>[m("是")]),_:1}),e(u,{value:"2"},{default:a(()=>[m("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"加收"},{default:a(()=>[e(w,{modelValue:l.add,"onUpdate:modelValue":o[1]||(o[1]=i=>l.add=i),multiple:"",placeholder:"请选择"},{default:a(()=>[(c(!0),_(h,null,V(B.value,(i,r)=>(c(),g(y,{key:r,label:i.text+" "+i.price+J[i.unit],value:JSON.stringify(i)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"折扣"},{default:a(()=>[e(w,{modelValue:l.discount,"onUpdate:modelValue":o[2]||(o[2]=i=>l.discount=i),multiple:"",placeholder:"请选择"},{default:a(()=>[(c(!0),_(h,null,V(O.value,(i,r)=>(c(),g(y,{key:r,label:i.text+" "+i.price+J[i.unit],value:JSON.stringify(i)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(n,{label:""},{default:a(()=>[e(v,{icon:"Plus",onClick:Y},{default:a(()=>[m("添加展位")]),_:1})]),_:1}),(c(!0),_(h,null,V(l.position,(i,r)=>(c(),_("div",{class:"item",key:r},[e(n,{label:"展馆号"},{default:a(()=>[e(f,{modelValue:l.position[r].hallCode,"onUpdate:modelValue":s=>l.position[r].hallCode=s,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{label:"展位号"},{default:a(()=>[e(w,{modelValue:l.position[r].positionCode,"onUpdate:modelValue":s=>l.position[r].positionCode=s,multiple:"",filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"请选择"},{default:a(()=>[(c(!0),_(h,null,V(S.value,(s,k)=>(c(),g(y,{key:k,label:s,value:s},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{label:"品牌"},{default:a(()=>[e(w,{modelValue:l.position[r].companyBrand,"onUpdate:modelValue":s=>l.position[r].companyBrand=s,multiple:"",placeholder:"请选择"},{default:a(()=>[(c(!0),_(h,null,V(R.value,(s,k)=>(c(),g(y,{key:k,label:s,value:s},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{label:"展位类型"},{default:a(()=>[e(T,{modelValue:l.position[r].type,"onUpdate:modelValue":s=>l.position[r].type=s},{default:a(()=>[e(u,{value:1},{default:a(()=>[m("标准")]),_:1}),e(u,{value:2},{default:a(()=>[m("特装")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{label:"展位规格"},{default:a(()=>[e(v,{size:"small",onClick:s=>oe(r)},{default:a(()=>[m("添加")]),_:2},1032,["onClick"])]),_:2},1024),l.position[r].product?(c(),g(n,{key:0,label:" "},{default:a(()=>[p("div",null,U(l.position[r].product+" "+l.position[r].area+"㎡"),1)]),_:2},1024)):pe("",!0),e(n,{label:"展位原价"},{default:a(()=>[e(f,{modelValue:l.position[r].costPrice,"onUpdate:modelValue":s=>l.position[r].costPrice=s,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{label:"折后金额"},{default:a(()=>[e(f,{"model-value":te(r),disabled:""},null,8,["model-value"])]),_:2},1024),e(n,{label:"最终金额"},{default:a(()=>[e(f,{modelValue:l.position[r].finalPrice,"onUpdate:modelValue":s=>l.position[r].finalPrice=s},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),p("div",De,[e(v,{link:"",type:"danger",onClick:s=>l.position.splice(r,1)},{default:a(()=>[e(z,null,{default:a(()=>[e(ae)]),_:1})]),_:2},1032,["onClick"])])]))),128))]),_:1},8,["model"])]),_:1})]),p("div",$e,[e(v,{type:"primary",onClick:ee,style:{width:"100%"}},{default:a(()=>[m("确认")]),_:1})])])]),e(de,{modelValue:t.show,"onUpdate:modelValue":o[7]||(o[7]=i=>t.show=i),title:"添加规格",width:"500",draggable:""},{footer:a(()=>[p("div",Te,[e(v,{onClick:o[6]||(o[6]=i=>t.show=!1)},{default:a(()=>[m("取消")]),_:1}),e(v,{type:"primary",onClick:le},{default:a(()=>[m("确定")]),_:1})])]),default:a(()=>[e(G,{ref:"ggFormRef",model:t.form,"label-width":"auto"},{default:a(()=>[e(n,{label:"产品名称",prop:"product"},{default:a(()=>[e(w,{modelValue:t.form.product,"onUpdate:modelValue":o[3]||(o[3]=i=>t.form.product=i),placeholder:"",onChange:M},{default:a(()=>[(c(!0),_(h,null,V(q.value,i=>(c(),g(y,{key:i.id,label:i.text+" "+i.price+"/"+i.num+"/㎡",value:i},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"单价",prop:"unitPrice"},{default:a(()=>[e(f,{"model-value":X.value,disabled:""},null,8,["model-value"])]),_:1}),e(n,{label:"尺寸"},{default:a(()=>[e(N,{span:11},{default:a(()=>[e(f,{modelValue:t.form.length,"onUpdate:modelValue":o[4]||(o[4]=i=>t.form.length=i),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(N,{span:2,style:{display:"flex","align-items":"center","justify-content":"center","font-size":"20px"}},{default:a(()=>[e(z,null,{default:a(()=>[e(ne)]),_:1})]),_:1}),e(N,{span:11},{default:a(()=>[e(f,{modelValue:t.form.width,"onUpdate:modelValue":o[5]||(o[5]=i=>t.form.width=i),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{label:"面积"},{default:a(()=>[e(f,{"model-value":Number((t.form.length*t.form.width).toFixed(2)),autocomplete:"off",disabled:""},null,8,["model-value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),co=Ue(ze,[["__scopeId","data-v-337f5b87"]]);export{co as default};
