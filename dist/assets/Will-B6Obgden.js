import{d as Y,l as d,s as U,O as Z,o as g,f as v,P as p,S as o,w as l,F as x,W as V,Q as n,R as w,c as $,_ as ee,$ as oe}from"./index-BOSzKbVT.js";import{E as te}from"./el-dialog-DnaTYOZ4.js";/* empty css                   *//* empty css                 */import{E as ae}from"./el-pagination-DDfEQ-Ug.js";/* empty css                 */import"./el-tag-CR3igpSZ.js";/* empty css                  */import"./el-scrollbar-BV42RjRI.js";import{E as le,a as ie}from"./el-table-column-DRDs2I9X.js";import"./el-checkbox-HwFdVWYU.js";import"./el-tooltip-l0sNRNKZ.js";import{E as re}from"./el-link-BTGpGqxR.js";import"./el-button-BWxuPc72.js";/* empty css                        */import{a as ne,b as se,E as de}from"./el-dropdown-item-D6uMmoJ4.js";import{T as me}from"./index-C3_xAPF9.js";import{_ as pe}from"./Move.vue_vue_type_script_setup_true_lang-CpoeNWup.js";import{a as f}from"./index-Br1BDARd.js";import{e as ue}from"./index-Du_9KPpK.js";/* empty css                   *//* empty css                       */import{a as m}from"./request-BCFdPhKL.js";import{E as ce}from"./index-Cw98EAgc.js";import{E as _e}from"./index-DvdfzQbF.js";import{E as fe}from"./index-99D_Q421.js";import{E as he}from"./index-Bv6ghFfN.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DqTjPGIy.js";import"./scroll-BzEFW-U7.js";import"./vnode-CE-NbktL.js";import"./refs-D07kpPh3.js";import"./event-BB_Ol6Sd.js";import"./index-CMK7tC0s.js";import"./index-CBfn4hJm.js";import"./isEqual-Cnxg9xpu.js";import"./_initCloneObject-DZxmjp6G.js";import"./castArray-PMJlZl_l.js";import"./isArrayLikeObject-B94pMk4s.js";/* empty css                     *//* empty css                                                              *//* empty css                       *//* empty css                          */import"./index-Beycs0eO.js";import"./_baseClone-DGJ0ACQq.js";import"./index-D6DliFwa.js";import"./arrays-6TrVLtTe.js";import"./index-C91-d4UT.js";import"./index-sCs41nps.js";import"./aria-KgdLjl5h.js";import"./validator-CFIrDLBX.js";const I=b=>(ee("data-v-1c8af311"),b=b(),oe(),b),we={class:"s-flex-col",style:{height:"100%"}},be={class:"",style:{"margin-bottom":"10px"}},ve={class:"el-dropdown-link"},xe={class:"s-table-operations"},Ie={class:"s-flex-auto",style:{"min-height":"0"}},Ce={class:"s-table-pagination"},ke=I(()=>p("div",{style:{"font-size":"15px","margin-bottom":"2px",color:"#444"}},"请在下列线索中选择主线索，合并后：",-1)),ye=I(()=>p("p",null,"1. 被合并线索下的动态迁移到主线索下",-1)),Ee=I(()=>p("p",null,"2. 合并后的线索以主线索为主，并保留两条线索的所有记录",-1)),ze={class:"dialog-footer"},Se=Y({__name:"Will",setup(b){const C=d("全部"),k=d(""),_=U({page:1,perPage:10}),y=d(0),E=d({}),z=d([]),h=d(null),S=d([]),R=d([]),B=e=>{E.value=e,_.page=1,u()},u=async()=>{f.getList({status:2,exhibitionId:k.value,..._,...E.value}).then(e=>{e.code===0&&(z.value=e.data.data,y.value=e.data.total)})},i=U({show:!1,data:[],masterId:"",mergeId:"",ref:null,set:()=>{let e=h.value.getSelectionRows();if(e.length!==2){m.warning("请选择需要合并的线索，必须选择两个");return}i.show=!0,i.data=e,i.masterId=e[0].id,i.mergeId=e[1].id},sub:()=>{f.merge({masterId:i.masterId,mergeId:i.mergeId}).then(e=>{e.code===0?(m.success("合并成功"),i.show=!1,u()):m.error(e.msg)})}}),F=()=>{let e=h.value.getSelectionRows().map(a=>a.id);if(e.length===0){m.warning("请选择需要删除的线索");return}ce.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{f.del({id:e}).then(a=>{a.code===0?(m.success("删除成功"),u()):m.error(a.msg)})}).catch(()=>{})},N=d(null),P=()=>{let e=h.value.getSelectionRows().map(a=>a.id);if(e.length===0){m.warning("请选择需要转移的线索");return}N.value.setMove(e)},L=()=>{let e=h.value.getSelectionRows().map(a=>a.id);if(e.length===0){m.warning("请选择需要移至公海的线索");return}f.changePublic({id:e}).then(a=>{a.code===0?(m.success("移至公海成功"),u()):m.error(a.msg)})},M=()=>{console.log("import")},W=()=>{console.log("export")};f.getSearchField().then(e=>{e.code===0&&(S.value=e.data)}),ue().then(e=>{e.code===0&&(R.value=[{exhibitionName:"全部",id:""},...e.data])});const q=e=>{C.value=e.exhibitionName,k.value=e.id,u()},D=d([]);return(()=>{f.getCustomField().then(e=>{e.code===0&&(D.value=e.data)})})(),u(),(e,a)=>{const G=Z("arrow-down"),H=_e,O=de,Q=ne,j=se,s=fe,r=le,A=re,T=ie,J=ae,K=he,X=te;return g(),v(x,null,[p("div",we,[p("div",be,[o(j,{onCommand:q,style:{outline:"none"}},{dropdown:l(()=>[o(Q,null,{default:l(()=>[(g(!0),v(x,null,V(R.value,(t,c)=>(g(),$(O,{key:c,command:t},{default:l(()=>[n(w(t.exhibitionName),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:l(()=>[p("span",ve,[n(w(C.value),1),o(H,{class:"el-icon--right"},{default:l(()=>[o(G)]),_:1})])]),_:1})]),o(me,{data:S.value,onSearch:B},null,8,["data"]),p("div",xe,[o(s,{size:"small",onClick:P},{default:l(()=>[n("转移")]),_:1}),o(s,{size:"small",onClick:L},{default:l(()=>[n("移至公海")]),_:1}),o(s,{size:"small",onClick:i.set},{default:l(()=>[n("合并")]),_:1},8,["onClick"]),o(s,{size:"small",onClick:W},{default:l(()=>[n("导出")]),_:1}),o(s,{size:"small",onClick:F},{default:l(()=>[n("删除")]),_:1}),o(s,{size:"small",onClick:a[0]||(a[0]=t=>e.$router.push("/market/clues/add"))},{default:l(()=>[n("新建线索")]),_:1}),o(s,{size:"small",onClick:M},{default:l(()=>[n("导入线索")]),_:1})]),p("div",Ie,[o(T,{ref_key:"tableRef",ref:h,data:z.value,border:"","table-layout":"fixed",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:l(()=>[o(r,{type:"selection",width:"42"}),o(r,{prop:"companyName",label:"公司名称",width:"180"},{default:l(t=>[o(A,{href:"/market/clues/info?type=2&id="+t.row.id+"&exhibitionId="+t.row.exhibitionId+"&authUser="+t.row.authUser,type:"primary"},{default:l(()=>[n(w(t.row.companyName),1)]),_:2},1032,["href"])]),_:1}),o(r,{prop:"exhibitionContact",label:"联系方式",width:"180"}),o(r,{prop:"duties",label:"职务"}),o(r,{prop:"phone",label:"电话"}),o(r,{prop:"recordTime",label:"记录时间",width:"180"}),o(r,{prop:"recordText",label:"记录内容"}),o(r,{prop:"authUser",label:"授权人"}),(g(!0),v(x,null,V(D.value,t=>(g(),$(r,{key:t.key,prop:t.key,label:t.name},null,8,["prop","label"]))),128)),o(r,{fixed:"right",label:"操作",width:"200"},{default:l(t=>[o(s,{link:"",type:"primary",size:"small",onClick:c=>e.$router.push({name:"HallLayout",query:{clueId:t.row.id,exhibitionId:t.row.exhibitionId,exhibitorId:t.row.exhibitorId}})},{default:l(()=>[n(w(t.row.orderPositionStatus?"新增":"")+"展位预定 ",1)]),_:2},1032,["onClick"]),o(s,{link:"",type:"primary",size:"small",onClick:c=>e.$router.push({name:"GoodsReserve",query:{clueId:t.row.id,exhibitionId:t.row.exhibitionId,exhibitorId:t.row.exhibitorId,hallCode:t.row.hallCode,positionCode:t.row.positionCode}})},{default:l(()=>[n(w(t.row.orderMaterialStatus?"新增":"")+"物料预定 ",1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),p("div",Ce,[o(J,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:y.value,"current-page":_.page,"onUpdate:currentPage":a[1]||(a[1]=t=>_.page=t),"page-size":_.perPage,"onUpdate:pageSize":a[2]||(a[2]=t=>_.perPage=t),onChange:u},null,8,["total","current-page","page-size"])])]),o(X,{modelValue:i.show,"onUpdate:modelValue":a[6]||(a[6]=t=>i.show=t),title:"合并销售线索",width:"500",draggable:""},{footer:l(()=>[p("div",ze,[o(s,{onClick:a[5]||(a[5]=t=>i.show=!1)},{default:l(()=>[n("取消")]),_:1}),o(s,{type:"primary",onClick:i.sub},{default:l(()=>[n("确定")]),_:1},8,["onClick"])])]),default:l(()=>[ke,ye,Ee,o(T,{data:i.data,border:"","show-overflow-tooltip":"","header-row-class-name":"s-table-header",onCurrentChange:a[4]||(a[4]=t=>{let c=i.masterId;i.masterId=t.id,i.mergeId=c})},{default:l(()=>[o(r,{label:"主线索",width:"70"},{default:l(t=>[o(K,{value:t.row.id,modelValue:i.masterId,"onUpdate:modelValue":a[3]||(a[3]=c=>i.masterId=c)},null,8,["value","modelValue"])]),_:1}),o(r,{prop:"companyName",label:"公司名称"}),o(r,{prop:"exhibitionName",label:"展会姓名"}),o(r,{prop:"authUser",label:"线索所有人"})]),_:1},8,["data"])]),_:1},8,["modelValue"]),o(pe,{ref_key:"moveRef",ref:N,onCallback:u},null,512)],64)}}}),So=ge(Se,[["__scopeId","data-v-1c8af311"]]);export{So as default};
