import{d as Y,l as d,s as D,O as Z,o as f,f as v,P as p,S as t,w as a,F as x,W as T,Q as r,R as u,c as U,X as ee,_ as te,$ as oe}from"./index-CnZSDrTx.js";import{E as ae}from"./el-dialog-QPTvRhlP.js";/* empty css                   */import{E as le}from"./el-radio-Bsqvlqug.js";import{E as ie}from"./el-pagination-FdSeQtnZ.js";/* empty css                 */import"./el-tag-CqeFY_ag.js";import"./el-select-Dp_6BTY6.js";import"./el-scrollbar-Biylh7eA.js";import"./el-popper-CjnSP2rC.js";import{E as ne,a as re}from"./el-table-column-BeGdXhrV.js";import"./el-checkbox-C9Xq17fp.js";import"./el-tooltip-l0sNRNKZ.js";import{E as se}from"./el-link-DB_3GmQC.js";import"./el-button-PcvT78BB.js";/* empty css                        */import{a as de,b as me,E as pe}from"./el-dropdown-item-8Jl0QmYV.js";import{T as ue}from"./index-C3O9c73V.js";import{_ as ce}from"./Move.vue_vue_type_script_setup_true_lang-Bc-Xo4zO.js";import{a as w}from"./index-DJbRMSyI.js";import{e as he}from"./index-BanvD7g9.js";/* empty css                   *//* empty css                       */import{a as m}from"./request-DuPLO9ut.js";import{E as _e}from"./index-CACB1FTA.js";import{E as fe}from"./index--_DWiEan.js";import{E as we}from"./index-D3WNSepZ.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C3JCfczY.js";import"./scroll-Cj_m6eEx.js";import"./vnode-B2IoBO-f.js";import"./refs-BTuIepUY.js";import"./event-BB_Ol6Sd.js";import"./isEqual-ZGPUTl53.js";import"./_initCloneObject-BzJT1sN_.js";import"./index-CiJAOnbI.js";import"./castArray-BIWlv9Ow.js";import"./isArrayLikeObject-B_tCCL-e.js";import"./el-form-item-CA7IP6BC.js";import"./_baseClone-If5JTBnu.js";import"./el-date-picker-BwYDIgEg.js";import"./arrays-6TrVLtTe.js";import"./index-W37LwBMy.js";/* empty css                          */import"./index-D0qHFdzX.js";import"./aria-KgdLjl5h.js";import"./validator-CYX2kOhi.js";const y=b=>(te("data-v-7b3108c0"),b=b(),oe(),b),be={class:"s-flex-col",style:{height:"100%"}},ve={class:"",style:{"margin-bottom":"10px"}},xe={class:"el-dropdown-link"},ye={class:"s-table-operations"},Ce={class:"s-flex-auto",style:{"min-height":"0"}},Ie={class:"s-table-pagination"},ke=y(()=>p("div",{style:{"font-size":"15px","margin-bottom":"2px",color:"#444"}},"请在下列线索中选择主线索，合并后：",-1)),Ee=y(()=>p("p",null,"1. 被合并线索下的动态迁移到主线索下",-1)),ze=y(()=>p("p",null,"2. 合并后的线索以主线索为主，并保留两条线索的所有记录",-1)),Se={class:"dialog-footer"},Ne=Y({__name:"Will",setup(b){const C=d("全部"),I=d(""),_=D({page:1,perPage:10}),k=d(0),E=d({}),z=d([]),g=d(null),S=d([]),N=d([]),$=o=>{E.value=o,_.page=1,c()},c=async()=>{w.getList({status:2,exhibitionId:I.value,..._,...E.value}).then(o=>{o.code===0&&(z.value=o.data.data,k.value=o.data.total)})},n=D({show:!1,data:[],masterId:"",mergeId:"",ref:null,set:()=>{let o=g.value.getSelectionRows();if(o.length!==2){m.warning("请选择需要合并的线索，必须选择两个");return}n.show=!0,n.data=o,n.masterId=o[0].id,n.mergeId=o[1].id},sub:()=>{w.merge({masterId:n.masterId,mergeId:n.mergeId}).then(o=>{o.code===0?(m.success("合并成功"),n.show=!1,c()):m.error(o.msg)})}}),B=()=>{let o=g.value.getSelectionRows().map(l=>l.id);if(o.length===0){m.warning("请选择需要删除的线索");return}_e.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.del({id:o}).then(l=>{l.code===0?(m.success("删除成功"),c()):m.error(l.msg)})}).catch(()=>{})},R=d(null),F=()=>{let o=g.value.getSelectionRows().map(l=>l.id);if(o.length===0){m.warning("请选择需要转移的线索");return}R.value.setMove(o)},M=()=>{let o=g.value.getSelectionRows().map(l=>l.id);if(o.length===0){m.warning("请选择需要移至公海的线索");return}w.changePublic({id:o}).then(l=>{l.code===0?(m.success("移至公海成功"),c()):m.error(l.msg)})},L=()=>{console.log("import")},W=()=>{console.log("export")};w.getSearchField().then(o=>{o.code===0&&(S.value=o.data)}),he().then(o=>{o.code===0&&(N.value=[{exhibitionName:"全部",id:""},...o.data])});const q=o=>{C.value=o.exhibitionName,I.value=o.id,c()},P=d([]);return(()=>{w.getCustomField().then(o=>{o.code===0&&(P.value=o.data)})})(),c(),(o,l)=>{const A=Z("arrow-down"),G=fe,H=pe,O=de,Q=me,s=we,i=ne,X=se,V=re,j=ie,J=le,K=ae;return f(),v(x,null,[p("div",be,[p("div",ve,[t(Q,{onCommand:q,style:{outline:"none"}},{dropdown:a(()=>[t(O,null,{default:a(()=>[(f(!0),v(x,null,T(N.value,(e,h)=>(f(),U(H,{key:h,command:e},{default:a(()=>[r(u(e.exhibitionName),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:a(()=>[p("span",xe,[r(u(C.value),1),t(G,{class:"el-icon--right"},{default:a(()=>[t(A)]),_:1})])]),_:1})]),t(ue,{data:S.value,onSearch:$},null,8,["data"]),p("div",ye,[t(s,{size:"small",onClick:F},{default:a(()=>[r("转移")]),_:1}),t(s,{size:"small",onClick:M},{default:a(()=>[r("移至公海")]),_:1}),t(s,{size:"small",onClick:n.set},{default:a(()=>[r("合并")]),_:1},8,["onClick"]),t(s,{size:"small",onClick:W},{default:a(()=>[r("导出")]),_:1}),t(s,{size:"small",onClick:B},{default:a(()=>[r("删除")]),_:1}),t(s,{size:"small",onClick:l[0]||(l[0]=e=>o.$router.push("/market/clues/add"))},{default:a(()=>[r("新建线索")]),_:1}),t(s,{size:"small",onClick:L},{default:a(()=>[r("导入线索")]),_:1})]),p("div",Ce,[t(V,{ref_key:"tableRef",ref:g,data:z.value,border:"","table-layout":"fixed",height:"100%","cell-style":{minWidth:"120px"},"show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:a(()=>[t(i,{type:"selection",width:"42",fixed:"left"}),t(i,{type:"index",label:"序号",width:"60"}),t(i,{prop:"companyName",label:"企业名称",width:"180"},{default:a(e=>[t(X,{href:"/market/clues/info?type=1&id="+e.row.id+"&exhibitionId="+e.row.exhibitionId+"&authUser="+e.row.authUser,type:"primary"},{default:a(()=>[r(u(e.row.companyName),1)]),_:2},1032,["href"])]),_:1}),t(i,{prop:"exhibitionName",label:"展会名称",width:"180"}),t(i,{prop:"positionCode",label:"展位号"}),t(i,{prop:"positionType",label:"展位类型","min-width":"120"},{default:a(e=>[r(u({1:"标准",2:"特装"}[e.row.positionType]),1)]),_:1}),t(i,{prop:"positionArea",label:"展位面积","min-width":"120"}),t(i,{prop:"contractPosition",label:"展位合同","min-width":"120"},{default:a(e=>[r(u({0:"未签订",1:"已签订",2:"已回执"}[e.row.contractPosition]),1)]),_:1}),t(i,{prop:"contractMaterial",label:"物料合同","min-width":"120"},{default:a(e=>[r(u({0:"未签订",1:"已签订",2:"已回执"}[e.row.contractMaterial]),1)]),_:1}),t(i,{prop:"isExit",label:"是否退展","min-width":"120"},{default:a(e=>[r(u({0:"否",1:"是"}[e.row.isExit]),1)]),_:1}),t(i,{prop:"exhibitionContact",label:"展会联系人","min-width":"120"}),t(i,{prop:"duties",label:"职位","min-width":"120"}),t(i,{prop:"phone",label:"手机号","min-width":"120"}),(f(!0),v(x,null,T(P.value,e=>(f(),v(x,{key:e.key},[e.name=="通讯地址"||e.name=="主营业务"?(f(),U(i,{key:0,prop:e.key,label:e.name,"min-width":"120"},null,8,["prop","label"])):ee("",!0)],64))),128)),t(i,{prop:"authUser",label:"持有人"}),t(i,{fixed:"right",label:"操作",width:"200"},{default:a(e=>[t(s,{link:"",type:"primary",size:"small",onClick:h=>o.$router.push({name:"HallLayout",query:{clueId:e.row.id,exhibitionId:e.row.exhibitionId,exhibitorId:e.row.exhibitorId}})},{default:a(()=>[r(u(e.row.orderPositionStatus?"新增":"")+"展位预定 ",1)]),_:2},1032,["onClick"]),t(s,{link:"",type:"primary",size:"small",onClick:h=>o.$router.push({name:"GoodsReserve",query:{clueId:e.row.id,exhibitionId:e.row.exhibitionId,exhibitorId:e.row.exhibitorId,hallCode:e.row.hallCode,positionCode:e.row.positionCode}})},{default:a(()=>[r(u(e.row.orderMaterialStatus?"新增":"")+"物料预定 ",1)]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),p("div",Ie,[t(j,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:k.value,"current-page":_.page,"onUpdate:currentPage":l[1]||(l[1]=e=>_.page=e),"page-size":_.perPage,"onUpdate:pageSize":l[2]||(l[2]=e=>_.perPage=e),onChange:c},null,8,["total","current-page","page-size"])])]),t(K,{modelValue:n.show,"onUpdate:modelValue":l[6]||(l[6]=e=>n.show=e),title:"合并销售线索",width:"500",draggable:""},{footer:a(()=>[p("div",Se,[t(s,{onClick:l[5]||(l[5]=e=>n.show=!1)},{default:a(()=>[r("取消")]),_:1}),t(s,{type:"primary",onClick:n.sub},{default:a(()=>[r("确定")]),_:1},8,["onClick"])])]),default:a(()=>[ke,Ee,ze,t(V,{data:n.data,border:"","show-overflow-tooltip":"","header-row-class-name":"s-table-header",onCurrentChange:l[4]||(l[4]=e=>{let h=n.masterId;n.masterId=e.id,n.mergeId=h})},{default:a(()=>[t(i,{label:"主线索",width:"70"},{default:a(e=>[t(J,{value:e.row.id,modelValue:n.masterId,"onUpdate:modelValue":l[3]||(l[3]=h=>n.masterId=h)},null,8,["value","modelValue"])]),_:1}),t(i,{prop:"companyName",label:"公司名称","min-width":"120"}),t(i,{prop:"exhibitionName",label:"展会姓名","min-width":"120"}),t(i,{prop:"authUser",label:"线索所有人","min-width":"120"})]),_:1},8,["data"])]),_:1},8,["modelValue"]),t(ce,{ref_key:"moveRef",ref:R,onCallback:c},null,512)],64)}}}),It=ge(Ne,[["__scopeId","data-v-7b3108c0"]]);export{It as default};
