import{d as Z,l as u,s as S,o as y,f as T,P as g,S as e,w as o,Q as r,R as h,c as b,W as k,F as B,a as A,at as H,Z as J,a8 as K}from"./index-DSfyh7qj.js";import{E as X}from"./el-dialog-DZXcBrX2.js";import"./el-overlay-BLyRwpHF.js";import{E as Y}from"./el-progress-BZar_Spj.js";import{E as ee,a as te}from"./el-radio-BxUzKFIH.js";import{E as ae}from"./el-pagination-4x7X5RfY.js";import"./el-input-DQxUpFKv.js";import"./el-tag-B8NoJhAA.js";import"./el-select-CmSQ-fEx.js";import"./el-scrollbar-3Xjb0YVF.js";import{E as oe,a as le}from"./el-table-column-DQ7sI2Z5.js";import"./el-checkbox-Ay2RniBl.js";import"./el-tooltip-l0sNRNKZ.js";import{E as re}from"./el-button-DtFXXT9_.js";import{T as ie}from"./index-BC7wXjJr.js";import{c as w,b as se}from"./index-BqPuwUrk.js";import{u as ne}from"./index-tJNn4J0z.js";import{E as R}from"./el-message-box-CLaqu9_a.js";/* empty css                   */import{E as p}from"./request-B1oD2Ia0.js";import"./index-CEAPH9FP.js";import"./index-DibT7Pck.js";import"./scroll-zA0h5opS.js";import"./vnode-CWEG3rL2.js";import"./typescript-Qg-Y0DRo.js";import"./cloneDeep-DAUkvE0m.js";import"./el-form-item-BWN2Y97Q.js";import"./isEqual-vPRyluBr.js";import"./isArrayLikeObject-Drj7X30p.js";import"./el-date-picker-DeEKRfu_.js";import"./arrays-6TrVLtTe.js";import"./index-Cv6R63m-.js";/* empty css                          */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-BvzPSx-J.js";const pe={class:"s-flex-col",style:{height:"100%"}},de={class:"s-table-operations"},ue={class:"s-flex-auto",style:{"min-height":"0"}},me={class:"s-table-pagination"},Je=Z({__name:"Goods",setup(ce){J();const V=K(),m=u(!1),c=S({page:1,perPage:10}),C=u(0),E=u({});V.query.id;const v=u([]),U=u(null),$=u([]),n=S({show:!1,file:"",type:1,orderId:0}),P=l=>{E.value=l,c.page=1,f()},f=()=>{w.getList({...c,...E.value}).then(l=>{l.code===0?(v.value=l.data.data,C.value=l.data.total):v.value=[{}]})},D=l=>{R.confirm("是否确认要撤销订单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.revoke({id:l}).then(t=>{t.code===0?(p.success("撤销成功"),f()):p.error(t.msg)})}).catch(()=>{})},L=l=>{R.confirm("是否确认要删除订单?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.del({id:l}).then(t=>{t.code===0?(p.success("删除成功"),f()):p.error(t.msg)})}).catch(()=>{})},z=()=>{},F=u(null);let d=u([]);const N=l=>{let t=l[0];d.value=[{name:t.name,size:t.size,uid:t.uid,status:"ready",percentage:0,raw:t}]},q=l=>{const t=l.size/1024/1024<3;return t||p.error("文件大小不能超过 3MB!"),t},I=l=>{n.show=!0,n.type=1,n.orderId=l,n.file="",d.value=[]},M=()=>{if(d.value.length===0){p.warning("请选择合同文件");return}m.value=!0;let l=new FormData;l.append("upload",d.value[0].raw),ne(l).then(t=>{t.code===0?se.receipt({orderId:n.orderId,type:n.type,url:t.data.url}).then(i=>{i.code===0?(p.success("上传成功"),n.show=!1,f()):p.error(i.msg),m.value=!1}).catch(()=>{m.value=!1}):(p.error(t.msg),m.value=!1)}).catch(()=>{m.value=!1})};return f(),(l,t)=>{const i=re,s=oe,G=le,O=ae,x=ee,j=te,Q=Y,W=X;return y(),T(B,null,[g("div",pe,[e(ie,{data:$.value,onSearch:P},null,8,["data"]),g("div",de,[e(i,{size:"small",onClick:z},{default:o(()=>[r("批量下载合同")]),_:1}),e(i,{size:"small",onClick:z},{default:o(()=>[r("导出")]),_:1})]),g("div",ue,[e(G,{ref_key:"tableRef",ref:U,data:v.value,border:"","table-layout":"fixed",height:"100%","header-row-class-name":"s-table-header"},{default:o(()=>[e(s,{type:"selection",width:"50"}),e(s,{prop:"hallCode",label:"订单编号"}),e(s,{prop:"companyName",label:"企业名称"}),e(s,{prop:"hallCode",label:"展馆号"}),e(s,{prop:"positionCode",label:"展位号"}),e(s,{prop:"orderPrice",label:"订单金额"}),e(s,{prop:"orderType",label:"下单方式"},{default:o(a=>[r(h({1:"代下单",2:"展商下单"}[a.row.orderType]),1)]),_:1}),e(s,{prop:"payStatus",label:"付款状态"},{default:o(a=>[r(h({0:"未付款",1:"部分付款",2:"已付款"}[a.row.payStatus]),1)]),_:1}),e(s,{prop:"receivedPrice",label:"到款金额"}),e(s,{prop:"contractStatus",label:"合同状态"},{default:o(a=>[r(h({0:"未签订",1:"已签订",2:"已回执"}[a.row.contractStatus]),1)]),_:1}),e(s,{prop:"invoiceStatus",label:"发票状态"},{default:o(a=>[r(h({0:"未申请",1:"待开票",2:"部分开票",3:"已开票"}[a.row.invoiceStatus]),1)]),_:1}),e(s,{prop:"clueUser",label:"所属人"}),e(s,{prop:"authUser",label:"下单人"}),e(s,{fixed:"right",label:"操作",width:"300"},{default:o(a=>[e(i,{link:"",type:"primary",size:"small",onClick:_=>l.$router.push({name:"OrderBoothDetail",query:{id:a.row.id}})},{default:o(()=>[r("详情")]),_:2},1032,["onClick"]),a.row.contractStatus===0?(y(),b(i,{key:0,link:"",type:"primary",size:"small",onClick:_=>l.$router.push({name:"ContractTemplates",query:{id:a.row.id}})},{default:o(()=>[r("签订合同")]),_:2},1032,["onClick"])):k("",!0),a.row.contractStatus===1?(y(),b(i,{key:1,link:"",type:"primary",size:"small",onClick:_=>l.$router.push({name:"ContractTemplates",query:{id:a.row.id}})},{default:o(()=>[r("更新合同")]),_:2},1032,["onClick"])):k("",!0),e(i,{link:"",type:"primary",size:"small",onClick:_=>I(a.row.id)},{default:o(()=>[r("上传合同")]),_:2},1032,["onClick"]),a.row.orderStatus===1?(y(),b(i,{key:2,link:"",type:"primary",size:"small",onClick:_=>D(a.row.id)},{default:o(()=>[r("撤销")]),_:2},1032,["onClick"])):a.row.orderStatus===0?(y(),T(B,{key:3},[e(i,{link:"",type:"",size:"small",disabled:""},{default:o(()=>[r("已撤销")]),_:1}),e(i,{link:"",type:"primary",size:"small",onClick:_=>L(a.row.id)},{default:o(()=>[r("删除")]),_:2},1032,["onClick"])],64)):k("",!0)]),_:1})]),_:1},8,["data"])]),g("div",me,[e(O,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:C.value,"current-page":c.page,"onUpdate:currentPage":t[0]||(t[0]=a=>c.page=a),"page-size":c.perPage,"onUpdate:pageSize":t[1]||(t[1]=a=>c.perPage=a),onChange:f},null,8,["total","current-page","page-size"])])]),e(W,{modelValue:n.show,"onUpdate:modelValue":t[5]||(t[5]=a=>n.show=a),title:"上传合同",width:"400"},{footer:o(()=>[e(i,{type:"primary",onClick:M,loading:m.value},{default:o(()=>[r("确定")]),_:1},8,["loading"]),e(i,{onClick:t[4]||(t[4]=a=>n.show=!1)},{default:o(()=>[r("取消")]),_:1})]),default:o(()=>[e(j,{modelValue:n.type,"onUpdate:modelValue":t[2]||(t[2]=a=>n.type=a)},{default:o(()=>[e(x,{value:1},{default:o(()=>[r("电子合同")]),_:1}),e(x,{value:2},{default:o(()=>[r("纸质合同")]),_:1})]),_:1},8,["modelValue"]),e(Q,{ref_key:"uploadRef",ref:F,"auto-upload":!1,limit:1,"before-upload":q,"on-exceed":N,"file-list":A(d),"onUpdate:fileList":t[3]||(t[3]=a=>H(d)?d.value=a:d=a),style:{"margin-top":"10px"}},{default:o(()=>[e(i,{size:"small",type:"primary"},{default:o(()=>[r("点击上传")]),_:1})]),_:1},8,["file-list"])]),_:1},8,["modelValue"])],64)}}});export{Je as default};
