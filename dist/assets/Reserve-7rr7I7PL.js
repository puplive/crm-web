import{d as pe,l as f,s as Q,e as W,v as X,O as Z,o as s,f as _,P as c,R as k,a as K,S as o,w as l,Q as m,F as h,W as b,Z as me,a7 as fe,c as P,X as _e,_ as he,$ as ve}from"./index-F9QIZpl4.js";import{E as be}from"./el-dialog-CsoKM1SO.js";/* empty css                   */import{E as Pe}from"./el-col-BDS58wDW.js";import{a as ge}from"./el-scrollbar-pbkOUS7j.js";/* empty css                     *//* empty css                 */import"./el-button-TEngkHeb.js";import"./el-tag-BfL1dDGg.js";/* empty css                  *//* empty css                 */import{E as Ve}from"./el-image-viewer-3Z2EAGPS.js";import{g as ye}from"./index-BtrRJ4H7.js";import{g as we}from"./index-CFooN09I.js";import{E as Ee,a as Ne}from"./index-DG_sdTtQ.js";import{E as xe,a as Ce}from"./index-C169urea.js";import{E as ke,a as Ue}from"./index--0-wC6Rl.js";import{E as Fe}from"./index-C6QA_pUU.js";import{E as Ie}from"./index-DtRfdYvD.js";import{E as Se}from"./index-C5z8j5H4.js";import{_ as Be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-FoDl7pCX.js";import"./scroll-B0Hfy5Ls.js";import"./vnode-DIE62JHo.js";import"./refs-CRC1M4ll.js";import"./event-BB_Ol6Sd.js";import"./typescript-dhNqpO9x.js";import"./request-BYi_Abda.js";import"./_initCloneObject-Dw-py65Z.js";import"./isEqual-COh6LovZ.js";import"./castArray-DpqosLXt.js";import"./_baseClone-nR8gpNM8.js";const Oe=x=>(he("data-v-368d4650"),x=x(),ve(),x),Re={class:"booth-reserve"},qe={class:"l"},Je={class:"title"},De={class:"img-box"},$e={class:"r"},Te={class:"form-box"},ze=Oe(()=>c("div",null,"预定展位",-1)),Ge={style:{"text-align":"center"}},je={style:{padding:"15px"}},Ae={class:"dialog-footer"},He=pe({__name:"Reserve",setup(x){const M=me(),g=fe(),O=g.query.clueId,U=g.query.exhibitionId,Y=g.query.exhibitorId,E=g.query.hallCode,ee=g.query.exhibitionName,F=f([]),R=f([]),q=f([]),J=f([]),D=f([]),$=f([]),T={1:"%",2:"￥"},a=Q({clueId:O,exhibitionId:U,exhibitorId:Y,add:[],discount:[],position:[{hallCode:E,positionCode:"",companyBrand:[],product:"",unitPrice:"",type:1,length:0,width:0,costPrice:0,addPrice:0,discountPrice:0,finalPrice:0,deposit:0,isOffset:1,payType:1,ratio:0}]});f({});const t=Q({show:!1,index:0,form:{product:"",unitPrice:"",num:1,length:"",width:""}}),oe=r=>{t.form.unitPrice=Number(r.price),t.form.product=r.text,t.form.num=r.num},le=W(()=>t.form.unitPrice?t.form.unitPrice+"元/"+(t.form.num===1?"":t.form.num)+"㎡":""),te=()=>{a.position.push({hallCode:E,positionCode:"",companyBrand:[],product:"",unitPrice:"",type:1,length:0,width:0,costPrice:0,addPrice:0,discountPrice:0,finalPrice:0,deposit:0,isOffset:1,payType:1,ratio:0})},ae=()=>{M.push({name:"BoothCreateOrder",query:{...g.query,companyName:I.value,data:JSON.stringify(a)}})},ie=r=>{t.show=!0,t.index=r,t.form.product="",t.form.unitPrice="",t.form.length="",t.form.width="",t.form.num=1},ne=()=>{t.show=!1;let r=t.form.length*t.form.width,e=r*t.form.unitPrice/t.form.num,p=z(e),i=G(e);a.position[t.index].product=t.form.product,a.position[t.index].unitPrice=t.form.unitPrice,a.position[t.index].length=t.form.length,a.position[t.index].width=t.form.width,a.position[t.index].area=r,a.position[t.index].costPrice=Number(e.toFixed(2)),a.position[t.index].addPrice=Number(p.toFixed(2)),a.position[t.index].discountPrice=Number(i.toFixed(2)),a.position[t.index].finalPrice=Number((e+p-i).toFixed(2))},z=r=>{let e=0;return a.add.forEach(p=>{let i=JSON.parse(p);i.unit===1?e+=r*i.price/100:i.unit===2&&(e+=i.price)}),e},G=r=>{let e=0;return a.discount.forEach(p=>{let i=JSON.parse(p);i.unit===1?e+=r*i.price/100:i.unit===2&&(e+=i.price)}),e};X(()=>a.add,r=>{a.position.forEach(e=>{e.addPrice=Number(z(e.costPrice).toFixed(2)),e.finalPrice=Number((e.costPrice+e.addPrice-e.discountPrice).toFixed(2))})}),X(()=>a.discount,r=>{a.position.forEach(e=>{e.discountPrice=Number(G(e.costPrice).toFixed(2)),e.finalPrice=Number((e.costPrice+e.addPrice-e.discountPrice).toFixed(2))})});const re=r=>{let e=a.position[r].costPrice,p=a.position[r].addPrice,i=a.position[r].discountPrice;return Number((e+p-i).toFixed(2))};we({exhibitionId:U,hallCode:E}).then(r=>{R.value=r.data});const I=f(""),S=f(!0);ye({clueId:O,exhibitionId:U}).then(r=>{let e=r.data;q.value=e.attachPrice.add,J.value=e.attachPrice.discount,D.value=e.companyBrand,$.value=e.unitPrice,F.value=e.exhibitionHall,I.value=e.companyName,S.value=e.isNew});const j=W(()=>{let r=F.value.find(e=>e.code===E);return r?r.img:""});return(r,e)=>{const p=Ve,i=Ee,C=xe,A=Ce,V=Ue,y=ke,w=Fe,v=Ie,de=Z("DeleteFilled"),H=Se,L=Ne,ue=ge,B=Pe,se=Z("Close"),ce=be;return s(),_(h,null,[c("div",Re,[c("div",qe,[c("div",Je,[c("span",null,k(K(ee)),1),c("span",null,"展馆号："+k(K(E)),1)]),c("div",De,[o(p,{style:{width:"100%",height:"100%"},src:j.value,"preview-src-list":[j.value],fit:"scale-down",alt:"展馆图片"},null,8,["src","preview-src-list"])])]),c("div",$e,[c("div",Te,[o(ue,{height:"100%"},{default:l(()=>[o(L,{model:a,"label-width":"auto",class:"form"},{default:l(()=>[ze,o(i,{label:"企业名称"},{default:l(()=>[m(k(I.value),1)]),_:1}),o(i,{label:"新展商"},{default:l(()=>[o(A,{modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=n=>S.value=n),disabled:""},{default:l(()=>[o(C,{value:!0},{default:l(()=>[m("是")]),_:1}),o(C,{value:!1},{default:l(()=>[m("否")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"加收"},{default:l(()=>[o(y,{modelValue:a.add,"onUpdate:modelValue":e[1]||(e[1]=n=>a.add=n),multiple:"",placeholder:"请选择"},{default:l(()=>[(s(!0),_(h,null,b(q.value,(n,d)=>(s(),P(V,{key:d,label:n.text+" "+n.price+T[n.unit],value:JSON.stringify(n)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"折扣"},{default:l(()=>[o(y,{modelValue:a.discount,"onUpdate:modelValue":e[2]||(e[2]=n=>a.discount=n),multiple:"",placeholder:"请选择"},{default:l(()=>[(s(!0),_(h,null,b(J.value,(n,d)=>(s(),P(V,{key:d,label:n.text+" "+n.price+T[n.unit],value:JSON.stringify(n)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(i,{label:""},{default:l(()=>[o(w,{icon:"Plus",onClick:te},{default:l(()=>[m("添加展位")]),_:1})]),_:1}),(s(!0),_(h,null,b(a.position,(n,d)=>(s(),_("div",{class:"item",key:d},[o(i,{label:"展馆号"},{default:l(()=>[o(y,{modelValue:a.position[d].hallCode,"onUpdate:modelValue":u=>a.position[d].hallCode=u,placeholder:"请选择"},{default:l(()=>[(s(!0),_(h,null,b(F.value,(u,N)=>(s(),P(V,{key:N,label:u.code,value:u.code},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(i,{label:"展位号"},{default:l(()=>[o(y,{modelValue:a.position[d].positionCode,"onUpdate:modelValue":u=>a.position[d].positionCode=u,filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"请选择"},{default:l(()=>[(s(!0),_(h,null,b(R.value,(u,N)=>(s(),P(V,{key:N,label:u,value:u},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(i,{label:"品牌"},{default:l(()=>[o(y,{modelValue:a.position[d].companyBrand,"onUpdate:modelValue":u=>a.position[d].companyBrand=u,multiple:"",placeholder:"请选择"},{default:l(()=>[(s(!0),_(h,null,b(D.value,(u,N)=>(s(),P(V,{key:N,label:u,value:u},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(i,{label:"展位类型"},{default:l(()=>[o(A,{modelValue:a.position[d].type,"onUpdate:modelValue":u=>a.position[d].type=u},{default:l(()=>[o(C,{value:1},{default:l(()=>[m("标准")]),_:1}),o(C,{value:2},{default:l(()=>[m("特装")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(i,{label:"展位规格"},{default:l(()=>[o(w,{size:"small",onClick:u=>ie(d)},{default:l(()=>[m("添加")]),_:2},1032,["onClick"])]),_:2},1024),a.position[d].product?(s(),P(i,{key:0,label:" "},{default:l(()=>[c("div",null,k(a.position[d].product+" "+a.position[d].area+"㎡"),1)]),_:2},1024)):_e("",!0),o(i,{label:"展位原价"},{default:l(()=>[o(v,{modelValue:a.position[d].costPrice,"onUpdate:modelValue":u=>a.position[d].costPrice=u,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(i,{label:"折后金额"},{default:l(()=>[o(v,{"model-value":re(d),disabled:""},null,8,["model-value"])]),_:2},1024),o(i,{label:"最终金额"},{default:l(()=>[o(v,{modelValue:a.position[d].finalPrice,"onUpdate:modelValue":u=>a.position[d].finalPrice=u},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),c("div",Ge,[o(w,{link:"",type:"danger",onClick:u=>a.position.splice(d,1)},{default:l(()=>[o(H,null,{default:l(()=>[o(de)]),_:1})]),_:2},1032,["onClick"])])]))),128))]),_:1},8,["model"])]),_:1})]),c("div",je,[o(w,{type:"primary",onClick:ae,style:{width:"100%"}},{default:l(()=>[m("确认")]),_:1})])])]),o(ce,{modelValue:t.show,"onUpdate:modelValue":e[7]||(e[7]=n=>t.show=n),title:"添加规格",width:"500",draggable:""},{footer:l(()=>[c("div",Ae,[o(w,{onClick:e[6]||(e[6]=n=>t.show=!1)},{default:l(()=>[m("取消")]),_:1}),o(w,{type:"primary",onClick:ne},{default:l(()=>[m("确定")]),_:1})])]),default:l(()=>[o(L,{ref:"ggFormRef",model:t.form,"label-width":"auto"},{default:l(()=>[o(i,{label:"产品名称",prop:"product"},{default:l(()=>[o(y,{modelValue:t.form.product,"onUpdate:modelValue":e[3]||(e[3]=n=>t.form.product=n),placeholder:"",onChange:oe},{default:l(()=>[(s(!0),_(h,null,b($.value,n=>(s(),P(V,{key:n.id,label:n.text+" "+n.price+"/"+n.num+"/㎡",value:n},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(i,{label:"单价",prop:"unitPrice"},{default:l(()=>[o(v,{"model-value":le.value,disabled:""},null,8,["model-value"])]),_:1}),o(i,{label:"尺寸"},{default:l(()=>[o(B,{span:11},{default:l(()=>[o(v,{modelValue:t.form.length,"onUpdate:modelValue":e[4]||(e[4]=n=>t.form.length=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(B,{span:2,style:{display:"flex","align-items":"center","justify-content":"center","font-size":"20px"}},{default:l(()=>[o(H,null,{default:l(()=>[o(se)]),_:1})]),_:1}),o(B,{span:11},{default:l(()=>[o(v,{modelValue:t.form.width,"onUpdate:modelValue":e[5]||(e[5]=n=>t.form.width=n),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),o(i,{label:"面积"},{default:l(()=>[o(v,{"model-value":Number((t.form.length*t.form.width).toFixed(2)),autocomplete:"off",disabled:""},null,8,["model-value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),No=Be(He,[["__scopeId","data-v-368d4650"]]);export{No as default};
