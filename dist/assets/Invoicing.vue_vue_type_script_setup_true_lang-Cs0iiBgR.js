import{d as w,t as b,o as h,h as k,i as t,$ as l,Y as p,a7 as r,y as x,X as C}from"./index-CvbIkT2X.js";import{E as D}from"./progress-BS33yjrb.js";import{E as y}from"./button-Dfw9Foa0.js";import{i as I}from"./index-B8JNW2HZ.js";import{u as N}from"./index-ow6vXR7I.js";/* empty css                */import{E as F}from"./dialog-DevwqGG1.js";/* empty css                */import{a as $,E as B}from"./form-item-DyffIhSs.js";/* empty css              */import{E as R}from"./index-BWnm9rLJ.js";/* empty css                    */import{E as S,a as M}from"./radio-Dc1m4MRa.js";const Z=w({__name:"UpInvoice",props:["id","disabled"],emits:["callback"],setup(E,{emit:V}){const c=E,e=b(!1),u=b(null),v=s=>s.size/1024/1024>3?(r.error("文件大小不能超过 3MB!"),!1):!0,g=s=>{e.value=!0;let m=new FormData;return m.append("upload",s.file),new Promise((f,d)=>{N(m).then(i=>{i.code===0?f(i.data):(d(i),r.error(i.msg),u.value.clearFiles()),e.value=!1}).catch(i=>{d(i),r.error("上传失败"),u.value.clearFiles(),e.value=!1})})},a=s=>{I.uploadInvoice({id:c.id,url:s}).then(m=>{m.code===0?(r.success("上传成功"),o("callback")):r.error(m.msg)})},o=V;return(s,m)=>{const f=y,d=D;return h(),k(d,{ref_key:"uploadRef",ref:u,style:{display:"inline-flex","margin-right":"5px",position:"relative",top:"2px"},"show-file-list":!1,"on-success":(i,n,U)=>{a(i.url)},"before-upload":v,"http-request":g},{default:t(()=>[l(f,{link:"",type:"primary",loading:e.value,disabled:c.disabled},{default:t(()=>[p("上传发票")]),_:1},8,["loading","disabled"])]),_:1},8,["on-success"])}}}),T={class:"dialog-footer"},j=w({__name:"EditInvoice",emits:["callback"],setup(E,{expose:V,emit:c}){b(!1),b(null);const e=x({show:!1,form:{id:"",title:"",socialCode:"",contact:"",phone:"",email:""}}),u=()=>{I.edit(e.form).then(a=>{a.code===0?(r.success("修改成功"),e.show=!1,g("callback")):r.error(a.msg)})},v=a=>{e.show=!0,e.form.id=a.id,e.form.title=a.invoiceTitle,e.form.socialCode=a.socialCode,e.form.contact=a.contact,e.form.phone=a.phone,e.form.email=a.email},g=c;return V({setEdit:v}),(a,o)=>{const s=R,m=$,f=B,d=y,i=F;return h(),k(i,{modelValue:e.show,"onUpdate:modelValue":o[6]||(o[6]=n=>e.show=n),title:"编辑发票",width:"500",draggable:""},{footer:t(()=>[C("div",T,[l(d,{onClick:o[5]||(o[5]=n=>e.show=!1)},{default:t(()=>[p("取消")]),_:1}),l(d,{type:"primary",onClick:u},{default:t(()=>[p("确定")]),_:1})])]),default:t(()=>[l(f,{ref:"willFormRef",model:e.form,"label-width":"auto","label-position":"left"},{default:t(()=>[l(m,{label:"发票抬头"},{default:t(()=>[l(s,{modelValue:e.form.title,"onUpdate:modelValue":o[0]||(o[0]=n=>e.form.title=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(m,{label:"社会信用代码"},{default:t(()=>[l(s,{modelValue:e.form.socialCode,"onUpdate:modelValue":o[1]||(o[1]=n=>e.form.socialCode=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(m,{label:"联系人"},{default:t(()=>[l(s,{modelValue:e.form.contact,"onUpdate:modelValue":o[2]||(o[2]=n=>e.form.contact=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(m,{label:"手机号"},{default:t(()=>[l(s,{modelValue:e.form.phone,"onUpdate:modelValue":o[3]||(o[3]=n=>e.form.phone=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),l(m,{label:"邮箱"},{default:t(()=>[l(s,{modelValue:e.form.email,"onUpdate:modelValue":o[4]||(o[4]=n=>e.form.email=n),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),q={class:"dialog-footer"},ee=w({__name:"Invoicing",emits:["callback"],setup(E,{expose:V,emit:c}){b(!1),b(null);const e=x({show:!1,form:{id:"",code:"",type:1}}),u=()=>{I.openInvoice(e.form).then(a=>{a.code===0?(r.success("成功"),e.show=!1,g("callback")):r.error(a.msg)})},v=a=>{e.show=!0,e.form.id=a.id,e.form.code="",e.form.type=1},g=c;return V({openInvoiceSet:v}),(a,o)=>{const s=S,m=M,f=$,d=R,i=B,n=y,U=F;return h(),k(U,{modelValue:e.show,"onUpdate:modelValue":o[3]||(o[3]=_=>e.show=_),title:"开票",width:"500",draggable:""},{footer:t(()=>[C("div",q,[l(n,{onClick:o[2]||(o[2]=_=>e.show=!1)},{default:t(()=>[p("取消")]),_:1}),l(n,{type:"primary",onClick:u},{default:t(()=>[p("确定")]),_:1})])]),default:t(()=>[l(i,{ref:"",model:e.form,"label-width":"auto","label-position":"left"},{default:t(()=>[l(f,{label:"发票类型"},{default:t(()=>[l(m,{modelValue:e.form.type,"onUpdate:modelValue":o[0]||(o[0]=_=>e.form.type=_)},{default:t(()=>[l(s,{value:1},{default:t(()=>[p("电子专票")]),_:1}),l(s,{value:2},{default:t(()=>[p("电子普票")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"发票号"},{default:t(()=>[l(d,{modelValue:e.form.code,"onUpdate:modelValue":o[1]||(o[1]=_=>e.form.code=_),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}});export{Z as _,j as a,ee as b};
