import{d as ue,l as d,s as re,t as N,c as ce,b as p,O as t,R as o,i as s,F as w,U as C,P as _,Q as b,W as pe,a5 as me,o as i,h as z,n as ve,X as _e,Y as he}from"./index-QgCPknRV.js";import{E as be,a as fe}from"./table-column-Bt9ktRkS.js";import"./checkbox-GQAT0fGF.js";/* empty css                */import"./popper-FvkgnJ0o.js";import{E as ge}from"./scrollbar-2JWi6wHl.js";/* empty css              */import{E as xe}from"./input-number-BTpFIs2O.js";import"./tag-DYJzjqVa.js";import{E as we}from"./button-BkUY8nVK.js";import{E as Ce}from"./image-viewer-DQbdlWSy.js";import{a as ye,E as Ie}from"./form-item-PCY24Bz9.js";/* empty css                      */import{E as Ee,a as ke}from"./select-D2x7JMsJ.js";import{c as f}from"./request-D3ROOKJz.js";import{g as Ve,c as y}from"./index-D3urqHNm.js";import{e as ze}from"./index-DPKxTLg9.js";import{g as Se}from"./index-ZQkmtas6.js";import{h as Ue}from"./index-BwbjudL8.js";/* empty css                */import{E as qe}from"./index-Ku1Bi_gm.js";import{E as De,a as Ne,b as Be}from"./index-B1uwQMIN.js";import{_ as Re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-form-item-Do-jLYkW.js";import"./_initCloneObject-DzxW9sW-.js";import"./event-BB_Ol6Sd.js";import"./isEqual-Dq4V8Bky.js";import"./index-DLge-GfZ.js";import"./scroll-DylINAFt.js";import"./castArray-CXoRlNM7.js";import"./_baseClone-CkCg4Dv3.js";import"./refs-C4B67JwL.js";const j=S=>(_e("data-v-1d3dfbba"),S=S(),he(),S),Me={class:"goods-reserve"},je={class:"s-top_bar"},Fe={key:1,style:{width:"166px","text-align":"center",padding:"10px"}},Le={class:"row"},Te={class:"col col1"},Ze={class:"goods-type"},$e=["onClick"],Oe={class:"col col2"},Pe={class:"goods-list"},Ae={class:"msg"},He=["title"],Qe=["title"],We=j(()=>t("label",{for:""},"规格(尺寸)：",-1)),Xe=["title"],Ye=j(()=>t("label",{for:""},"单  价：",-1)),Ge={class:"p"},Je=j(()=>t("label",{for:""},"库  存：",-1)),Ke={class:"col col3"},el={class:"table"},ll={class:"bottom-bar"},ol={class:"p1"},tl={class:"p2"},al=ue({__name:"Reserve",setup(S){const H=pe(),g=me(),n=d(g.query.exhibitionId?Number(g.query.exhibitionId):""),m=d(g.query.exhibitorId?Number(g.query.exhibitorId):""),r=d(g.query.hallCode||""),u=d(g.query.positionCode||""),Q=g.query.clueId,U=d(0),I=d([]),E=d({}),x=d([]),F=d([]),L=d([]),T=d([]),q=d([]);re({});const W=(l,a=1)=>{y.addCart({exhibitorId:m.value,exhibitionId:n.value,hallCode:r.value,positionCode:u.value,id:l.id,num:a}).then(v=>{v.code===0?(f.success("添加成功"),h()):f.error(v.msg)})},X=(l,a=1)=>{y.editCart({exhibitorId:m.value,exhibitionId:n.value,hallCode:r.value,positionCode:u.value,id:l.id,num:a}).then(v=>{v.code===0?f.success("成功"):f.error(v.msg),h()})},Y=l=>{y.delCart({exhibitorId:m.value,exhibitionId:n.value,hallCode:r.value,positionCode:u.value,id:l.id,num:l.num}).then(a=>{a.code===0?(f.success("删除成功"),h()):f.error(a.msg)})},G=l=>{E.value=I.value[l]},J=()=>{ze().then(l=>{l.code===0&&(F.value=l.data)})},Z=()=>{Se({exhibitionId:n.value}).then(l=>{l.code===0&&(L.value=l.data)})},$=()=>{Ve({exhibitionId:n.value}).then(l=>{l.code===0&&(T.value=l.data)})},B=()=>{q.value=[],Ue({exhibitionId:n.value,hallCode:r.value}).then(l=>{l.code===0&&(q.value=l.data)})},O=()=>{y.getMaterial({exhibitionId:n.value}).then(l=>{l.code===0&&(I.value=l.data,I.value.length>0?E.value=I.value[0]:E.value={})})},h=()=>{if(!n.value||!r.value||!u.value){x.value=[];return}y.getCart({exhibitorId:m.value,exhibitionId:n.value,hallCode:r.value,positionCode:u.value}).then(l=>{l.code===0&&(x.value=l.data)})},D=d(!1),K=()=>{D.value=!0,y.create({clueId:Q,exhibitionId:n.value,exhibitorId:m.value,hallCode:r.value,positionCode:u.value,price:U.value,data:x.value.map(l=>({...l,remark:""}))}).then(l=>{l.code===0?(f.success("提交成功"),H.go(-1)):f.error(l.msg),D.value=!1}).catch(l=>{D.value=!1})};N(()=>n.value,l=>{r.value="",u.value="",m.value="",Z(),$(),B(),O(),h()}),N(()=>m.value,l=>{h()}),N(()=>r.value,l=>{u.value="",B(),h()}),N(()=>u.value,l=>{h()});const ee=ce(()=>{let l=0;return x.value.forEach(a=>{l+=a.price*a.num}),U.value=l,l});return J(),Z(),$(),B(),O(),h(),(l,a)=>{const v=Ee,R=ke,k=ye,P=qe,le=De,oe=Ne,te=Be,ae=Ie,se=Ce,M=we,ie=ge,V=fe,ne=xe,de=be;return i(),p("div",Me,[t("div",je,[o(ae,{inline:!0},{default:s(()=>[o(k,{label:"展会名称",style:{width:"220px"}},{default:s(()=>[o(R,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),placeholder:"请选择展会名称",disabled:""},{default:s(()=>[(i(!0),p(w,null,C(F.value,e=>(i(),z(v,{key:e.id,label:e.exhibitionName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(k,{label:"参展企业",style:{width:"220px"}},{default:s(()=>[o(R,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),placeholder:"请选择参展企业",disabled:""},{default:s(()=>[(i(!0),p(w,null,C(L.value,e=>(i(),z(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(k,{label:"展馆",style:{width:"220px"}},{default:s(()=>[o(R,{modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=e=>r.value=e),placeholder:"请选择展馆"},{default:s(()=>[(i(!0),p(w,null,C(T.value,e=>(i(),z(v,{key:e.code,label:e.code,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(k,{label:"展位号",style:{width:"220px"}},{default:s(()=>[o(te,{trigger:"click",style:{width:"100%"},"max-height":"300px",onCommand:a[4]||(a[4]=e=>{u.value=e})},{dropdown:s(()=>[q.value.length?(i(),z(oe,{key:0},{default:s(()=>[(i(!0),p(w,null,C(q.value,(e,c)=>(i(),z(le,{key:c,style:{width:"166px"},command:e},{default:s(()=>[_(b(e),1)]),_:2},1032,["command"]))),128))]),_:1})):(i(),p("div",Fe,"无数据"))]),default:s(()=>[o(P,{modelValue:u.value,"onUpdate:modelValue":a[3]||(a[3]=e=>u.value=e),autocomplete:"off","suffix-icon":"ArrowDown"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),t("div",Le,[t("div",Te,[t("ul",Ze,[(i(!0),p(w,null,C(I.value,(e,c)=>(i(),p("li",{key:c,onClick:A=>G(c),class:ve({active:e.project===E.value.project})},b(e.project),11,$e))),128))])]),t("div",Oe,[o(ie,null,{default:s(()=>[t("div",Pe,[(i(!0),p(w,null,C(E.value.data,(e,c)=>(i(),p("li",{key:c},[o(se,{style:{width:"100%",height:"200px"},src:e.img,"preview-src-list":[e.img],fit:"contain"},null,8,["src","preview-src-list"]),t("div",Ae,[t("p",{class:"title",title:e.position},b(e.position),9,He),t("p",{class:"p",title:e.size},[We,_(b(e.size),1)],8,Qe),t("p",{class:"p",title:e.price+"元/"+e.unit},[Ye,t("span",null,b(e.price+"元/"+e.unit),1)],8,Xe),t("p",Ge,[Je,_(b(e.stock),1)])]),o(M,{type:"primary",onClick:A=>W(e),disabled:e.stock<=0,style:{width:"100%"}},{default:s(()=>[_("加入购物车")]),_:2},1032,["onClick","disabled"])]))),128))])]),_:1})]),t("div",Ke,[t("div",el,[o(de,{data:x.value,border:""},{default:s(()=>[o(V,{label:"服务项目",prop:"project","min-width":"120"}),o(V,{label:"位置/版面",prop:"position","min-width":"120"}),o(V,{label:"规格",prop:"size"}),o(V,{label:"单价(RMB)",prop:"price","min-width":"120"}),o(V,{label:"数量",width:"200px"},{default:s(e=>[o(ne,{modelValue:e.row.num,"onUpdate:modelValue":c=>e.row.num=c,min:1,size:"small",onChange:(c,A)=>{X(e.row,c)}},null,8,["modelValue","onUpdate:modelValue","onChange"]),o(M,{type:"danger",link:"",onClick:c=>Y(e.row),style:{"margin-left":"10px"},icon:"Delete"},null,8,["onClick"])]),_:1})]),_:1},8,["data"])]),t("div",ll,[t("div",ol,[t("span",null,[_("已选物料 "),t("b",null,b(x.value.length),1),_(" 项")]),_(),t("span",null,[_("物料金额 "),t("b",null,"¥"+b(ee.value),1)])]),t("div",tl,[o(k,{label:"最终金额",style:{width:"100%","margin-bottom":"0"}},{default:s(()=>[o(P,{modelValue:U.value,"onUpdate:modelValue":a[5]||(a[5]=e=>U.value=e)},null,8,["modelValue"])]),_:1})]),o(M,{type:"primary",style:{width:"100%"},onClick:K,loading:D.value,disabled:x.value.length<=0},{default:s(()=>[_("提交")]),_:1},8,["loading","disabled"])])])])])}}}),jl=Re(al,[["__scopeId","data-v-1d3dfbba"]]);export{jl as default};
