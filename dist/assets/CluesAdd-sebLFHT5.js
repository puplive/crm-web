import{d as K,l as v,t as w,o as u,b as y,O as R,Q as T,e as p,R as s,i as r,F as f,U as _,P as q,W as X,a5 as Y,h as m,a3 as Z}from"./index-CoktlfKN.js";import{E as x,a as ee}from"./el-form-item-CcULLD48.js";import{E as le}from"./el-cascader-panel-BUDRLz8q.js";/* empty css                 */import"./el-popper-L93M-ikX.js";import"./el-tag-6X7OaLzA.js";import{E as ae,a as oe}from"./el-checkbox-BJHQZPh0.js";import{E as ue,a as te}from"./el-radio-DvnLKCLF.js";import"./el-scrollbar-g4nKRSUD.js";/* empty css                          *//* empty css                       *//* empty css                  */import{E as de,a as re}from"./el-select-B3OnxCx1.js";import{a as i}from"./index-C3exun-z.js";import{c as z}from"./index-LOe7M9UG.js";import{_ as V}from"./rules-BWEfMqzk.js";/* empty css                   */import{c as $}from"./request-DAESqlcg.js";import{E as ne}from"./index-BSg1NFlD.js";import{E as se}from"./index-BPJO_kH-.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-form-item-DzIy8ETn.js";import"./castArray-C5ewEd_X.js";import"./_baseClone-DEct6B3T.js";import"./_initCloneObject-CnCR6HZ9.js";import"./isEqual-DF4feqD3.js";import"./aria-KgdLjl5h.js";import"./event-BB_Ol6Sd.js";import"./arrays-6TrVLtTe.js";import"./scroll-BsrZAv2y.js";import"./cloneDeep-CR3l0pVK.js";const ce={class:"",style:{"margin-bottom":"20px"}},pe={style:{width:"500px"}},ie={style:{"margin-top":"20px","text-align":"right"}},ve=K({__name:"CluesAdd",setup(ye){const P=X(),k=Y();console.log(k);const M=v(null),a=v({companyName:"",contactName:"",contactTel:"",country:"",province:"",city:"",address:"",companyBrand:[""],customField:[]}),E=v([]),F=v([]),U=v([]),C=v(""),b=v(""),h=v(""),S=v([]),A=()=>{M.value.validate(t=>{t&&(k.name==="CluesEdit"?i.edit({id:k.query.id,...a.value}).then(l=>{l.code===0?($.success("编辑成功"),P.go(-1)):$.error(l.msg)}):i.add(a.value).then(l=>{l.code===0?($.success("保存成功"),P.go(-1)):$.error(l.msg)}))})},D=()=>{i.getCountry().then(t=>{t.code===0&&(E.value=t.data,k.name!=="CluesEdit"&&(C.value="CHN"))})},G=()=>{i.getProvince({countryCode:C.value}).then(t=>{t.code===0&&(F.value=t.data)})},O=()=>{i.getCity({provinceCode:b.value}).then(t=>{t.code===0&&(U.value=t.data)})};w(()=>C.value,t=>{let l=E.value.find(n=>n.code==t);a.value.country=l&&l.name||"",G()}),w(()=>b.value,t=>{let l=F.value.find(n=>n.code==t);a.value.province=l&&l.name||"",O()}),w(()=>h.value,t=>{let l=U.value.find(n=>n.code==t);a.value.city=l&&l.name||""});const H=()=>{i.getCustomField().then(t=>{t.code===0&&(S.value=t.data,t.data.forEach(l=>{a.value.customField.push({[l.key]:z[l.type].value})}))})};return D(),H(),k.name==="CluesEdit"&&i.getData({id:k.query.id}).then(t=>{t.code===0&&(a.value=t.data,i.getCountry().then(l=>{l.code===0&&(E.value=l.data,C.value=E.value.find(n=>n.name==a.value.country).code,i.getProvince({countryCode:C.value}).then(n=>{n.code===0&&(F.value=n.data,b.value=F.value.find(c=>c.name==a.value.province).code,i.getCity({provinceCode:b.value}).then(c=>{c.code===0&&(U.value=c.data,h.value=U.value.find(g=>g.name==a.value.city).code)}))}))}))}),(t,l)=>{const n=ne,c=x,g=re,N=de,B=se,L=ue,Q=te,W=ae,j=oe,I=le,J=ee;return u(),y(f,null,[R("div",ce,[R("span",null,T(p(k).name==="CluesEdit"?"编辑":"新建")+"销售线索",1)]),R("div",pe,[s(J,{ref_key:"formRef",ref:M,model:a.value,"label-width":"auto"},{default:r(()=>[s(c,{label:"企业名称",prop:"companyName",rules:p(V).required},{default:r(()=>[s(n,{modelValue:a.value.companyName,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value.companyName=e)},null,8,["modelValue"])]),_:1},8,["rules"]),s(c,{label:"联系人",prop:"contactName",rules:p(V).required},{default:r(()=>[s(n,{modelValue:a.value.contactName,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value.contactName=e)},null,8,["modelValue"])]),_:1},8,["rules"]),s(c,{label:"联系电话",prop:"contactTel",rules:p(V).phone},{default:r(()=>[s(n,{modelValue:a.value.contactTel,"onUpdate:modelValue":l[2]||(l[2]=e=>a.value.contactTel=e)},null,8,["modelValue"])]),_:1},8,["rules"]),s(c,{label:"国家",prop:"country",rules:p(V).select},{default:r(()=>[s(N,{modelValue:C.value,"onUpdate:modelValue":l[3]||(l[3]=e=>C.value=e)},{default:r(()=>[(u(!0),y(f,null,_(E.value,e=>(u(),m(g,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"]),s(c,{label:"省份",prop:"province",rules:p(V).select},{default:r(()=>[s(N,{modelValue:b.value,"onUpdate:modelValue":l[4]||(l[4]=e=>b.value=e)},{default:r(()=>[(u(!0),y(f,null,_(F.value,e=>(u(),m(g,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"]),s(c,{label:"城市",prop:"city",rules:p(V).select},{default:r(()=>[s(N,{modelValue:h.value,"onUpdate:modelValue":l[5]||(l[5]=e=>h.value=e)},{default:r(()=>[(u(!0),y(f,null,_(U.value,e=>(u(),m(g,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"]),s(c,{label:"详细地址",prop:"address",rules:p(V).required},{default:r(()=>[s(n,{type:"textarea",modelValue:a.value.address,"onUpdate:modelValue":l[6]||(l[6]=e=>a.value.address=e)},null,8,["modelValue"])]),_:1},8,["rules"]),(u(!0),y(f,null,_(a.value.companyBrand,(e,d)=>(u(),m(c,{key:d,label:d===0?"品牌":" ",prop:`companyBrand[${d}]`,rules:p(V).required},{default:r(()=>[s(n,{modelValue:a.value.companyBrand[d],"onUpdate:modelValue":o=>a.value.companyBrand[d]=o},{append:r(()=>[d===0?(u(),m(B,{key:0,onClick:l[7]||(l[7]=o=>a.value.companyBrand.push("")),icon:"Plus"})):(u(),m(B,{key:1,onClick:o=>a.value.companyBrand.splice(d,1),icon:"Minus"},null,8,["onClick"]))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","prop","rules"]))),128)),(u(!0),y(f,null,_(S.value,(e,d)=>(u(),m(c,{key:e.key,label:e.name,prop:`customField[${d}][${e.key}]`,rules:e.isRequired?p(z)[e.type].rules:[]},{default:r(()=>[e.type===1?(u(),m(n,{key:0,modelValue:a.value.customField[d][e.key],"onUpdate:modelValue":o=>a.value.customField[d][e.key]=o,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])):e.type===2?(u(),m(n,{key:1,modelValue:a.value.customField[d][e.key],"onUpdate:modelValue":o=>a.value.customField[d][e.key]=o,modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue","onUpdate:modelValue"])):e.type===3?(u(),m(N,{key:2,modelValue:a.value.customField[d][e.key],"onUpdate:modelValue":o=>a.value.customField[d][e.key]=o},{default:r(()=>[(u(!0),y(f,null,_(e.data||[],o=>(u(),m(g,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type===4?(u(),m(Q,{key:3,modelValue:a.value.customField[d][e.key],"onUpdate:modelValue":o=>a.value.customField[d][e.key]=o},{default:r(()=>[(u(!0),y(f,null,_(e.data||[],o=>(u(),m(L,{key:o.id,value:o.id},{default:r(()=>[q(T(o.name),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type===5?(u(),m(j,{key:4,modelValue:a.value.customField[d][e.key],"onUpdate:modelValue":o=>a.value.customField[d][e.key]=o},{default:r(()=>[(u(!0),y(f,null,_(e.data||[],o=>(u(),m(W,{key:o.id,value:o.id,name:"type"},{default:r(()=>[q(T(o.name),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type===6?(u(),m(I,{key:5,clearable:"",style:{width:"100%"},modelValue:a.value.customField[d][e.key],"onUpdate:modelValue":o=>a.value.customField[d][e.key]=o,options:e.data,props:{value:"id",label:"name",children:"child",checkStrictly:!0}},null,8,["modelValue","onUpdate:modelValue","options"])):e.type===7?(u(),m(I,{key:6,clearable:"",style:{width:"100%"},modelValue:a.value.customField[d][e.key],"onUpdate:modelValue":o=>a.value.customField[d][e.key]=o,options:e.data,props:{value:"id",label:"name",children:"child",checkStrictly:!0,multiple:!0}},null,8,["modelValue","onUpdate:modelValue","options"])):Z("",!0)]),_:2},1032,["label","prop","rules"]))),128)),R("div",ie,[s(B,{type:"primary",onClick:A,size:"small"},{default:r(()=>[q("保存")]),_:1}),s(B,{type:"default",onClick:l[8]||(l[8]=e=>t.$router.go(-1)),size:"small"},{default:r(()=>[q("取消")]),_:1})])]),_:1},8,["model"])])],64)}}}),je=me(ve,[["__scopeId","data-v-40a61ba7"]]);export{je as default};
