import{d as M,l as f,o as _,f as E,S as l,w as t,P as h,Q as i,c as x,R as V,F as g,a as R,V as O}from"./index-B51ZjI-P.js";import{E as Q}from"./el-dialog-DkbGBuCA.js";import"./el-overlay-BojN6VgD.js";import{b as j,a as G,E as H,c as J}from"./el-input-CF6DOVry.js";import"./el-tag-DzL8Udk6.js";import{E as K,a as W}from"./el-select-HcL3ytrH.js";import"./el-scrollbar-BCNPLyH0.js";import{E as X,a as Y}from"./el-tab-pane-T4m-dyXX.js";import{E as Z,a as ee}from"./el-table-column-C6vxUn7b.js";import{E as le}from"./el-checkbox-BpX9YOjS.js";import"./el-tooltip-l0sNRNKZ.js";import{a as m}from"./index-8tlgTKd_.js";/* empty css                   */import{E as u}from"./index-BaJ0dyKc.js";import"./index-zV6_ul5o.js";import"./vnode-Cb601ozU.js";import"./isEqual-BAmX46RD.js";import"./isArrayLikeObject-CsjL7c09.js";import"./request-yC8UVKn-.js";const ae={class:"s-table-operations"},te={class:"dialog-footer"},we=M({__name:"Custom",setup(oe){const k=m.types,c=f([]),q=f(null),r=f(!1),U=f("销售线索"),n=f({id:"",name:"",type:"",tips:""}),$=()=>{r.value=!0,n.value={id:"",name:"",type:"",tips:""}},T=a=>{r.value=!0,n.value.id=a.id,n.value.name=a.name,n.value.type=a.type,n.value.tips=a.tips},F=()=>{if(n.value.id)m.edit(n.value).then(a=>{a.code===0?(u.success("编辑成功"),r.value=!1,b()):u.error(a.msg)});else{let{id:a,...o}=n.value;m.add(o).then(s=>{s.code===0?(u.success("添加成功"),r.value=!1,b()):u.error(s.msg)})}},b=async()=>{m.getList().then(a=>{a.code===0&&(c.value=a.data)})},B=(a,o)=>{m.setRequired({id:a.id,status:a.isRequired}).then(s=>{s.code===0?u.success("修改成功"):(u.error(s.msg),c.value[o].isRequired=a.isRequired===0?1:0)})},D=(a,o)=>{m.setEnable({id:a.id,status:a.isEnable}).then(s=>{s.code===0?u.success("修改成功"):(u.error(s.msg),c.value[o].isEnable=a.isEnable===0?1:0)})};return b(),(a,o)=>{const s=j,p=Z,C=le,S=ee,v=X,N=Y,P=W,I=K,y=G,w=H,L=J,z=Q;return _(),E(g,null,[l(N,{type:"border-card"},{default:t(()=>[l(v,{label:"销售客户"},{default:t(()=>[h("div",ae,[l(s,{size:"small",icon:"Plus",onClick:$},{default:t(()=>[i("线索字段")]),_:1})]),l(S,{data:c.value,"row-key":"id",border:"","default-expand-all":""},{default:t(()=>[l(p,{prop:"name",label:"名称"},{default:t(e=>[e.row.type!=1&&e.row.type!=2?(_(),x(s,{key:0,type:"primary",link:"",onClick:d=>a.$router.push({path:"/settings/custom/field",query:{id:e.row.id,title:e.row.name}})},{default:t(()=>[i(V(e.row.name),1)]),_:2},1032,["onClick"])):(_(),E(g,{key:1},[i(V(e.row.name),1)],64))]),_:1}),l(p,{prop:"type",label:"类型"},{default:t(e=>[i(V((()=>{let d=R(k).find(A=>A.value===e.row.type);return d?d.label:""})()),1)]),_:1}),l(p,{prop:"isRequired",label:"必填"},{default:t(e=>[l(C,{modelValue:e.row.isRequired,"onUpdate:modelValue":d=>e.row.isRequired=d,"true-label":1,"false-label":0,onChange:d=>B(e.row,e.$index)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(p,{prop:"isEnable",label:"启用"},{default:t(e=>[l(C,{modelValue:e.row.isEnable,"onUpdate:modelValue":d=>e.row.isEnable=d,"true-label":1,"false-label":0,onChange:d=>D(e.row,e.$index)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),l(p,{label:"操作"},{default:t(e=>[l(s,{link:"",type:"primary",onClick:d=>T(e.row)},{default:t(()=>[i("编辑")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),l(v,{label:"联系人"}),l(v,{label:"会员"})]),_:1}),l(z,{title:U.value,modelValue:r.value,"onUpdate:modelValue":o[4]||(o[4]=e=>r.value=e),style:{width:"400px"}},{footer:t(()=>[h("div",te,[l(s,{onClick:o[3]||(o[3]=e=>r.value=!1)},{default:t(()=>[i("取 消")]),_:1}),l(s,{type:"primary",onClick:F},{default:t(()=>[i("确 定")]),_:1})])]),default:t(()=>[l(L,{ref_key:"addformRef",ref:q,model:n.value,"label-width":"100px"},{default:t(()=>[l(y,{label:"类型",prop:"type"},{default:t(()=>[l(I,{modelValue:n.value.type,"onUpdate:modelValue":o[0]||(o[0]=e=>n.value.type=e)},{default:t(()=>[(_(!0),E(g,null,O(R(k),e=>(_(),x(P,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(y,{label:"名称",prop:"name"},{default:t(()=>[l(w,{modelValue:n.value.name,"onUpdate:modelValue":o[1]||(o[1]=e=>n.value.name=e)},null,8,["modelValue"])]),_:1}),l(y,{label:"提示",prop:"tips"},{default:t(()=>[l(w,{modelValue:n.value.tips,"onUpdate:modelValue":o[2]||(o[2]=e=>n.value.tips=e),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])],64)}}});export{we as default};
