import{j as xe,a2 as Se,aa as k,L as ee,d as pe,a4 as ke,u as Fe,l as V,s as Ie,e as M,ae as se,v as X,y as Pe,af as ze,o as b,f as I,C as fe,a as s,n as ue,a5 as re,r as _e,X as he,S as r,a8 as ce,B as Ae,w as f,c as T,p as Be,ag as Te,ah as De,ai as Ue,h as $e,O as Me,P as c,F as q,W as K,Q as x,R as $,Z as Le,a7 as Oe,_ as Re,$ as qe}from"./index-BnnnK_YI.js";/* empty css                 */import{E as Ke,a as je}from"./el-table-column-BWSclO2l.js";import"./el-checkbox-9FcrlSCf.js";import"./el-tooltip-l0sNRNKZ.js";import{a as Ze}from"./el-scrollbar-D3VZCHtT.js";import"./el-tag-DksfI-x9.js";import{u as We,a as Ge,b as He,c as Ye,t as Qe,e as ge}from"./el-button-D6xHPO3A.js";import{E as Xe}from"./el-image-viewer-D-iICjsA.js";/* empty css                     *//* empty css                  */import{a as B}from"./request-DhRpxnTY.js";import{c as j,g as Je}from"./index-Bos4R-x1.js";import{e as el}from"./index-B4aRIXA1.js";import{g as ll}from"./index-BK5_IOGl.js";import{g as tl}from"./index-ilq89k4J.js";/* empty css                   */import{E as al,a as ol}from"./index-ClxgrGYT.js";import{E as nl,a as sl}from"./index-CXMUnDXQ.js";import{E as rl}from"./index-DucyUmQv.js";import{E as Ne}from"./index-nQ1hFZTo.js";import{u as ul,_ as il,E as Ve}from"./index-C0TB7Dbb.js";import{C as we,I as ie,U as J}from"./event-BB_Ol6Sd.js";import{v as ye}from"./index-B4rGlqPP.js";import{_ as dl}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./_initCloneObject-DNKOYgS9.js";import"./isArrayLikeObject-BfGwdoSH.js";import"./typescript-CS6VS-lD.js";import"./isEqual-DQirXHc5.js";import"./scroll-CjGXt2xZ.js";import"./castArray-DfA7nsC2.js";import"./_baseClone-DJAZlgpx.js";const cl=xe({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:Se,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:u=>u===null||k(u)||["min","max"].includes(u),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:u=>u>=0&&u===Number.parseInt(`${u}`,10)},validateEvent:{type:Boolean,default:!0},...We(["ariaLabel"])}),pl={[we]:(u,Z)=>Z!==u,blur:u=>u instanceof FocusEvent,focus:u=>u instanceof FocusEvent,[ie]:u=>k(u)||ee(u),[J]:u=>k(u)||ee(u)},ml=["aria-label","onKeydown"],vl=["aria-label","onKeydown"],bl=pe({name:"ElInputNumber"}),fl=pe({...bl,props:cl,emits:pl,setup(u,{expose:Z,emit:_}){const o=u,{t:N}=ke(),p=Fe("input-number"),h=V(),i=Ie({currentValue:o.modelValue,userInput:null}),{formItem:w}=Ge(),F=M(()=>k(o.modelValue)&&o.modelValue<=o.min),P=M(()=>k(o.modelValue)&&o.modelValue>=o.max),z=M(()=>{const e=le(o.step);return se(o.precision)?Math.max(le(o.modelValue),e):(e>o.precision,o.precision)}),L=M(()=>o.controls&&o.controlsPosition==="right"),W=He(),A=Ye(),D=M(()=>{if(i.userInput!==null)return i.userInput;let e=i.currentValue;if(ee(e))return"";if(k(e)){if(Number.isNaN(e))return"";se(o.precision)||(e=e.toFixed(o.precision))}return e}),G=(e,l)=>{if(se(l)&&(l=z.value),l===0)return Math.round(e);let n=String(e);const v=n.indexOf(".");if(v===-1||!n.replace(".","").split("")[v+l])return e;const R=n.length;return n.charAt(R-1)==="5"&&(n=`${n.slice(0,Math.max(0,R-1))}6`),Number.parseFloat(Number(n).toFixed(l))},le=e=>{if(ee(e))return 0;const l=e.toString(),n=l.indexOf(".");let v=0;return n!==-1&&(v=l.length-n-1),v},te=(e,l=1)=>k(e)?G(e+o.step*l):i.currentValue,H=()=>{if(o.readonly||A.value||P.value)return;const e=Number(D.value)||0,l=te(e);U(l),_(ie,i.currentValue),a()},Y=()=>{if(o.readonly||A.value||F.value)return;const e=Number(D.value)||0,l=te(e,-1);U(l),_(ie,i.currentValue),a()},ae=(e,l)=>{const{max:n,min:v,step:m,precision:y,stepStrictly:R,valueOnClear:E}=o;n<v&&Qe("InputNumber","min should not be greater than max.");let g=Number(e);if(ee(e)||Number.isNaN(g))return null;if(e===""){if(E===null)return null;g=Ae(E)?{min:v,max:n}[E]:E}return R&&(g=G(Math.round(g/m)*m,y)),se(y)||(g=G(g,y)),(g>n||g<v)&&(g=g>n?n:v,l&&_(J,g)),g},U=(e,l=!0)=>{var n;const v=i.currentValue,m=ae(e);if(!l){_(J,m);return}v===m&&e||(i.userInput=null,_(J,m),v!==m&&_(we,m,v),o.validateEvent&&((n=w==null?void 0:w.validate)==null||n.call(w,"change").catch(y=>ge())),i.currentValue=m)},Q=e=>{i.userInput=e;const l=e===""?null:Number(e);_(ie,l),U(l,!1)},oe=e=>{const l=e!==""?Number(e):"";(k(l)&&!Number.isNaN(l)||e==="")&&U(l),a(),i.userInput=null},C=()=>{var e,l;(l=(e=h.value)==null?void 0:e.focus)==null||l.call(e)},O=()=>{var e,l;(l=(e=h.value)==null?void 0:e.blur)==null||l.call(e)},de=e=>{_("focus",e)},ne=e=>{var l;i.userInput=null,_("blur",e),o.validateEvent&&((l=w==null?void 0:w.validate)==null||l.call(w,"blur").catch(n=>ge()))},a=()=>{i.currentValue!==o.modelValue&&(i.currentValue=o.modelValue)},d=e=>{document.activeElement===e.target&&e.preventDefault()};return X(()=>o.modelValue,(e,l)=>{const n=ae(e,!0);i.userInput===null&&n!==l&&(i.currentValue=n)},{immediate:!0}),Pe(()=>{var e;const{min:l,max:n,modelValue:v}=o,m=(e=h.value)==null?void 0:e.input;if(m.setAttribute("role","spinbutton"),Number.isFinite(n)?m.setAttribute("aria-valuemax",String(n)):m.removeAttribute("aria-valuemax"),Number.isFinite(l)?m.setAttribute("aria-valuemin",String(l)):m.removeAttribute("aria-valuemin"),m.setAttribute("aria-valuenow",i.currentValue||i.currentValue===0?String(i.currentValue):""),m.setAttribute("aria-disabled",String(A.value)),!k(v)&&v!=null){let y=Number(v);Number.isNaN(y)&&(y=null),_(J,y)}m.addEventListener("wheel",d,{passive:!1})}),ze(()=>{var e,l;const n=(e=h.value)==null?void 0:e.input;n==null||n.setAttribute("aria-valuenow",`${(l=i.currentValue)!=null?l:""}`)}),ul({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-input-number",ref:"https://element-plus.org/en-US/component/input-number.html"},M(()=>!!o.label)),Z({focus:C,blur:O}),(e,l)=>(b(),I("div",{class:ue([s(p).b(),s(p).m(s(W)),s(p).is("disabled",s(A)),s(p).is("without-controls",!e.controls),s(p).is("controls-right",s(L))]),onDragstart:l[0]||(l[0]=ce(()=>{},["prevent"]))},[e.controls?fe((b(),I("span",{key:0,role:"button","aria-label":s(N)("el.inputNumber.decrease"),class:ue([s(p).e("decrease"),s(p).is("disabled",s(F))]),onKeydown:re(Y,["enter"])},[_e(e.$slots,"decrease-icon",{},()=>[r(s(Ve),null,{default:f(()=>[s(L)?(b(),T(s(Be),{key:0})):(b(),T(s(Te),{key:1}))]),_:1})])],42,ml)),[[s(ye),Y]]):he("v-if",!0),e.controls?fe((b(),I("span",{key:1,role:"button","aria-label":s(N)("el.inputNumber.increase"),class:ue([s(p).e("increase"),s(p).is("disabled",s(P))]),onKeydown:re(H,["enter"])},[_e(e.$slots,"increase-icon",{},()=>[r(s(Ve),null,{default:f(()=>[s(L)?(b(),T(s(De),{key:0})):(b(),T(s(Ue),{key:1}))]),_:1})])],42,vl)),[[s(ye),H]]):he("v-if",!0),r(s(Ne),{id:e.id,ref_key:"input",ref:h,type:"number",step:e.step,"model-value":s(D),placeholder:e.placeholder,readonly:e.readonly,disabled:s(A),size:s(W),max:e.max,min:e.min,name:e.name,"aria-label":e.label||e.ariaLabel,"validate-event":!1,onKeydown:[re(ce(H,["prevent"]),["up"]),re(ce(Y,["prevent"]),["down"])],onBlur:ne,onFocus:de,onInput:Q,onChange:oe},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],34))}});var _l=il(fl,[["__file","input-number.vue"]]);const hl=$e(_l),me=u=>(Re("data-v-d1d30f14"),u=u(),qe(),u),gl={class:"goods-reserve"},Vl={class:"s-top_bar"},yl={class:"row"},Il={class:"col col1"},Nl={class:"goods-type"},wl=["onClick"],Cl={class:"col col2"},El={class:"goods-list"},xl={class:"msg"},Sl=["title"],kl=["title"],Fl=me(()=>c("label",{for:""},"规格(尺寸)：",-1)),Pl=["title"],zl=me(()=>c("label",{for:""},"单  价：",-1)),Al={class:"p"},Bl=me(()=>c("label",{for:""},"库  存：",-1)),Tl={class:"col col3"},Dl={class:"table"},Ul={class:"bottom-bar"},$l={class:"p1"},Ml={class:"p2"},Ll=pe({__name:"Reserve",setup(u){const Z=Le(),_=Oe(),o=V(_.query.exhibitionId?Number(_.query.exhibitionId):""),N=V(_.query.exhibitorId?Number(_.query.exhibitorId):""),p=V(_.query.hallCode||""),h=V(_.query.positionCode||""),i=_.query.clueId,w=V(0),F=V([]),P=V({}),z=V([]),L=V([]),W=V([]),A=V([]),D=V([]);Ie({});const G=(a,d=1)=>{j.addCart({exhibitorId:N.value,exhibitionId:o.value,hallCode:p.value,positionCode:h.value,id:a.id,num:d}).then(e=>{e.code===0?(B.success("添加成功"),C()):B.error(e.msg)})},le=(a,d=1)=>{j.editCart({exhibitorId:N.value,exhibitionId:o.value,hallCode:p.value,positionCode:h.value,id:a.id,num:d}).then(e=>{e.code===0?B.success("成功"):B.error(e.msg),C()})},te=a=>{j.delCart({exhibitorId:N.value,exhibitionId:o.value,hallCode:p.value,positionCode:h.value,id:a.id,num:a.num}).then(d=>{d.code===0?(B.success("删除成功"),C()):B.error(d.msg)})},H=a=>{P.value=F.value[a]},Y=()=>{el().then(a=>{a.code===0&&(L.value=a.data)})},ae=()=>{ll().then(a=>{a.code===0&&(W.value=a.data)})},U=()=>{Je({exhibitionId:o.value}).then(a=>{a.code===0&&(A.value=a.data)})},Q=()=>{D.value=[],tl({exhibitionId:o.value,hallCode:p.value}).then(a=>{a.code===0&&(D.value=a.data)})},oe=()=>{j.getMaterial({exhibitionId:o.value}).then(a=>{a.code===0&&(F.value=a.data,F.value.length>0?P.value=F.value[0]:P.value={})})},C=()=>{if(!o.value||!p.value||!h.value){z.value=[];return}j.getCart({exhibitorId:N.value,exhibitionId:o.value,hallCode:p.value,positionCode:h.value}).then(a=>{a.code===0&&(z.value=a.data)})},O=V(!1),de=()=>{O.value=!0,j.create({clueId:i,exhibitionId:o.value,exhibitorId:N.value,hallCode:p.value,positionCode:h.value,price:w.value,data:z.value.map(a=>({...a,remark:""}))}).then(a=>{a.code===0?(B.success("提交成功"),Z.go(-1)):B.error(a.msg),O.value=!1}).catch(a=>{O.value=!1})};X(()=>o.value,a=>{p.value="",h.value="",U(),Q(),oe(),C()}),X(()=>N.value,a=>{C()}),X(()=>p.value,a=>{h.value="",Q(),C()}),X(()=>h.value,a=>{C()});const ne=M(()=>{let a=0;return z.value.forEach(d=>{a+=d.price*d.num}),w.value=a,a});return Y(),ae(),U(),Q(),oe(),C(),(a,d)=>{const e=ol,l=al,n=nl,v=sl,m=Xe,y=rl,R=Ze,E=Ke,g=hl,Ce=je,ve=Me("font"),Ee=Ne;return b(),I("div",gl,[c("div",Vl,[r(v,{inline:!0},{default:f(()=>[r(n,{label:"展会名称",style:{width:"220px"}},{default:f(()=>[r(l,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=t=>o.value=t),placeholder:"请选择展会名称",disabled:""},{default:f(()=>[(b(!0),I(q,null,K(L.value,t=>(b(),T(e,{key:t.id,label:t.exhibitionName,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(n,{label:"参展企业",style:{width:"220px"}},{default:f(()=>[r(l,{modelValue:N.value,"onUpdate:modelValue":d[1]||(d[1]=t=>N.value=t),placeholder:"请选择参展企业",disabled:""},{default:f(()=>[(b(!0),I(q,null,K(W.value,t=>(b(),T(e,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(n,{label:"展馆",style:{width:"220px"}},{default:f(()=>[r(l,{modelValue:p.value,"onUpdate:modelValue":d[2]||(d[2]=t=>p.value=t),placeholder:"请选择展馆"},{default:f(()=>[(b(!0),I(q,null,K(A.value,t=>(b(),T(e,{key:t.code,label:t.code,value:t.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(n,{label:"展位号",style:{width:"220px"}},{default:f(()=>[r(l,{modelValue:h.value,"onUpdate:modelValue":d[3]||(d[3]=t=>h.value=t),filterable:"","allow-create":"","default-first-option":"","reserve-keyword":!1,placeholder:"添加展位号",style:{width:"240px"}},{default:f(()=>[(b(!0),I(q,null,K(D.value,t=>(b(),T(e,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),c("div",yl,[c("div",Il,[c("ul",Nl,[(b(!0),I(q,null,K(F.value,(t,S)=>(b(),I("li",{key:S,onClick:be=>H(S),class:ue({active:t.project===P.value.project})},$(t.project),11,wl))),128))])]),c("div",Cl,[r(R,null,{default:f(()=>[c("div",El,[(b(!0),I(q,null,K(P.value.data,(t,S)=>(b(),I("li",{key:S},[r(m,{style:{width:"100%",height:"200px"},src:t.img,"preview-src-list":[t.img],fit:"contain"},null,8,["src","preview-src-list"]),c("div",xl,[c("p",{class:"title",title:t.position},$(t.position),9,Sl),c("p",{class:"p",title:t.size},[Fl,x($(t.size),1)],8,kl),c("p",{class:"p",title:t.price+"元/"+t.unit},[zl,c("span",null,$(t.price+"元/"+t.unit),1)],8,Pl),c("p",Al,[Bl,x($(t.num),1)])]),r(y,{type:"primary",onClick:be=>G(t),disabled:t.num<=0,style:{width:"100%"}},{default:f(()=>[x("加入购物车")]),_:2},1032,["onClick","disabled"])]))),128))])]),_:1})]),c("div",Tl,[c("div",Dl,[r(Ce,{data:z.value,border:""},{default:f(()=>[r(E,{label:"服务项目",prop:"project"}),r(E,{label:"位置/版面",prop:"position"}),r(E,{label:"规格",prop:"size"}),r(E,{label:"单价(RMB)",prop:"price"}),r(E,{label:"数量",width:"200px"},{default:f(t=>[r(g,{modelValue:t.row.num,"onUpdate:modelValue":S=>t.row.num=S,min:1,size:"small",onChange:(S,be)=>{le(t.row,S)}},null,8,["modelValue","onUpdate:modelValue","onChange"]),r(y,{type:"danger",link:"",onClick:S=>te(t.row),style:{"margin-left":"10px"},icon:"Delete"},null,8,["onClick"])]),_:1})]),_:1},8,["data"])]),c("div",Ul,[c("div",$l,[c("span",null,[x("已选物料 "),r(ve,null,{default:f(()=>[x($(z.value.length),1)]),_:1}),x(" 项")]),x(),c("span",null,[x("物料金额 "),r(ve,null,{default:f(()=>[x("¥"+$(ne.value),1)]),_:1})])]),c("div",Ml,[r(n,{label:"最终金额",style:{width:"100%","margin-bottom":"0"}},{default:f(()=>[r(Ee,{modelValue:w.value,"onUpdate:modelValue":d[4]||(d[4]=t=>w.value=t)},null,8,["modelValue"])]),_:1})]),r(y,{type:"primary",style:{width:"100%"},onClick:de,loading:O.value,disabled:ne.value<=0},{default:f(()=>[x("提交")]),_:1},8,["loading","disabled"])])])])])}}}),gt=dl(Ll,[["__scopeId","data-v-d1d30f14"]]);export{gt as default};
