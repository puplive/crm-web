import{d as H,s as J,l as r,o as p,f as w,P as c,S as t,w as a,Q as i,R as K,F as k,W as N,aj as Y,c as P,X as Z}from"./index-F9QIZpl4.js";import{E as ee}from"./el-dialog-CsoKM1SO.js";/* empty css                   *//* empty css                     *//* empty css                 */import"./el-tag-BfL1dDGg.js";/* empty css                  */import"./el-scrollbar-pbkOUS7j.js";import{E as te}from"./el-pagination-N18_8fUt.js";import{E as oe,a as le}from"./el-table-column-DspaQhOS.js";import"./el-checkbox-BPc_gAFH.js";import"./el-tooltip-l0sNRNKZ.js";import{E as ae}from"./el-link-B1lr-sqp.js";import"./el-button-TEngkHeb.js";import{T as re}from"./index-70egpx93.js";import{a as f}from"./index-BK6lXFk_.js";import{e as ie}from"./index-DnXy9kmG.js";import{g as ne}from"./index-CQcFw8HA.js";/* empty css                   *//* empty css                       */import{a as s}from"./request-BYi_Abda.js";import{E as se}from"./index-D-9czxUQ.js";import{E as ue}from"./index-C6QA_pUU.js";import{E as me,a as de}from"./index--0-wC6Rl.js";import{E as pe,a as ce}from"./index-DG_sdTtQ.js";import"./index-FoDl7pCX.js";import"./index-C5z8j5H4.js";import"./scroll-B0Hfy5Ls.js";import"./vnode-DIE62JHo.js";import"./refs-CRC1M4ll.js";import"./event-BB_Ol6Sd.js";import"./_initCloneObject-Dw-py65Z.js";import"./isEqual-COh6LovZ.js";import"./typescript-dhNqpO9x.js";import"./index-DtRfdYvD.js";import"./isArrayLikeObject-CCZg05jR.js";/* empty css                                                              *//* empty css                       *//* empty css                 *//* empty css                          */import"./index-C169urea.js";import"./index-DFF2A5Wa.js";import"./arrays-6TrVLtTe.js";import"./index-_-Q1dWup.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./aria-KgdLjl5h.js";import"./validator-C-90lp82.js";import"./castArray-DpqosLXt.js";import"./_baseClone-nR8gpNM8.js";const fe={class:"s-flex-col",style:{height:"100%"}},ve={class:"s-table-operations"},ge={class:"s-flex-auto",style:{"min-height":"0"}},_e={class:"s-table-pagination"},he={class:"dialog-footer"},be={class:"dialog-footer"},_t=H({__name:"Clues",setup(we){const d=J({page:1,perPage:10}),x=r(0),E=r({}),C=r([]),b=r(null),S=r([]),V=r([]),D=o=>{E.value=o,d.page=1,m()},m=async()=>{f.getList({status:1,...d,...E.value}).then(o=>{o.code===0&&(C.value=o.data.data,x.value=o.data.total)})},v=r({}),g=r(!1),z=r(null),L=o=>{v.value.id=o.id,g.value=!0},M=()=>{z.value.validate(o=>{o&&f.changeIntention(v.value).then(e=>{e.code===0?(s.success("转为意向成功"),m(),g.value=!1):s.error(e.msg)})})},$=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){s.warning("请选择需要删除的线索");return}se.confirm("确定删除所选线索？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{f.del({id:o}).then(e=>{e.code===0?(s.success("删除成功"),m()):s.error(e.msg)})}).catch(()=>{})},_=r({}),h=r(!1),F=r(null),U=r([]),q=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){s.warning("请选择需要转移的线索");return}_.value.id=o,h.value=!0},j=()=>{F.value.validate(o=>{o&&f.changeUser(_.value).then(e=>{e.code===0?(s.success("转移成功"),h.value=!1,m()):s.error(e.msg)})})},O=()=>{let o=b.value.getSelectionRows().map(e=>e.id);if(o.length===0){s.warning("请选择需要移至公海的线索");return}f.changePublic({id:o}).then(e=>{e.code===0?(s.success("移至公海成功"),m()):s.error(e.msg)})},Q=()=>{Y.push("/market/clues/import")},W=()=>{console.log("export")};return f.getSearchField().then(o=>{o.code===0&&(S.value=o.data)}),ie().then(o=>{o.code===0&&(V.value=o.data)}),ne().then(o=>{o.code===0&&(U.value=o.data)}),m(),(o,e)=>{const n=ue,u=oe,X=ae,A=le,G=te,I=de,R=me,y=pe,T=ce,B=ee;return p(),w(k,null,[c("div",fe,[t(re,{data:S.value,onSearch:D},null,8,["data"]),c("div",ve,[t(n,{size:"small",onClick:e[0]||(e[0]=l=>o.$router.push("/market/clues/add"))},{default:a(()=>[i("新增")]),_:1}),t(n,{size:"small",onClick:Q},{default:a(()=>[i("导入")]),_:1}),t(n,{size:"small",onClick:W},{default:a(()=>[i("导出")]),_:1}),t(n,{size:"small",onClick:q},{default:a(()=>[i("转移给他人")]),_:1}),t(n,{size:"small",onClick:O},{default:a(()=>[i("移至公海")]),_:1}),t(n,{size:"small",onClick:$},{default:a(()=>[i("删除")]),_:1})]),c("div",ge,[t(A,{ref_key:"tableRef",ref:b,data:C.value,border:"","table-layout":"fixed",height:"100%","show-overflow-tooltip":"","header-row-class-name":"s-table-header"},{default:a(()=>[t(u,{type:"selection",width:"42"}),t(u,{prop:"companyName",label:"公司名称",width:"180"},{default:a(l=>[t(X,{href:"/market/clues/info?id="+l.row.id+"&exhibitionId="+l.row.exhibitionId+"&authUser="+l.row.authUser,type:"primary"},{default:a(()=>[i(K(l.row.companyName),1)]),_:2},1032,["href"])]),_:1}),t(u,{prop:"exhibitionContact",label:"联系方式",width:"180"}),t(u,{prop:"duties",label:"职务"}),t(u,{prop:"phone",label:"电话"}),t(u,{prop:"recordTime",label:"记录时间",width:"180"}),t(u,{prop:"recordText",label:"记录内容"}),t(u,{prop:"authUser",label:"授权人"}),t(u,{fixed:"right",label:"操作",width:"120"},{default:a(l=>[t(n,{link:"",type:"primary",size:"small",onClick:ke=>L(l.row)},{default:a(()=>[i(" 转为意向客户 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),c("div",_e,[t(G,{layout:"total, sizes, prev, pager, next","page-sizes":[10,20,50],total:x.value,"current-page":d.page,"onUpdate:currentPage":e[1]||(e[1]=l=>d.page=l),"page-size":d.perPage,"onUpdate:pageSize":e[2]||(e[2]=l=>d.perPage=l),onChange:m},null,8,["total","current-page","page-size"])])]),t(B,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=l=>g.value=l),title:"转为意向客户",width:"500",draggable:""},{footer:a(()=>[c("div",he,[t(n,{onClick:e[4]||(e[4]=l=>g.value=!1)},{default:a(()=>[i("取消")]),_:1}),t(n,{type:"primary",onClick:M},{default:a(()=>[i("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"willFormRef",ref:z,model:v.value,"label-width":"auto"},{default:a(()=>[t(y,{label:"项目",prop:"exhibitionId",rules:[{required:!0,message:"请选择项目"}]},{default:a(()=>[t(R,{modelValue:v.value.exhibitionId,"onUpdate:modelValue":e[3]||(e[3]=l=>v.value.exhibitionId=l),placeholder:""},{default:a(()=>[(p(!0),w(k,null,N(V.value,l=>(p(),w(k,{key:l.id},[l.status===1?(p(),P(I,{key:0,label:l.exhibitionName,value:l.id},null,8,["label","value"])):Z("",!0)],64))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:h.value,"onUpdate:modelValue":e[8]||(e[8]=l=>h.value=l),title:"转移销售线索",width:"500",draggable:""},{footer:a(()=>[c("div",be,[t(n,{onClick:e[7]||(e[7]=l=>h.value=!1)},{default:a(()=>[i("取消")]),_:1}),t(n,{type:"primary",onClick:j},{default:a(()=>[i("确定")]),_:1})])]),default:a(()=>[t(T,{ref_key:"moveFormRef",ref:F,model:_.value,"label-width":"auto"},{default:a(()=>[t(y,{label:""},{default:a(()=>[i("是否将选中的销售线索转移？")]),_:1}),t(y,{label:"销售线索所有人",prop:"userId",rules:[{required:!0,message:"请选择销售线索所有人"}]},{default:a(()=>[t(R,{modelValue:_.value.userId,"onUpdate:modelValue":e[6]||(e[6]=l=>_.value.userId=l),placeholder:""},{default:a(()=>[(p(!0),w(k,null,N(U.value,l=>(p(),P(I,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}});export{_t as default};
