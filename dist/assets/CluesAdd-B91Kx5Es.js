import{d as le,t as p,a0 as ae,z as B,b as f,X as x,Z as w,e as y,$ as i,i as r,J as _,a5 as oe,am as te,o as u,h as m,a1 as k,ak as A,Y as q,a7 as T}from"./index-930c3Ux3.js";import{E as ue,a as de}from"./form-item-QauYmOwe.js";import{E as ne}from"./cascader-panel-DbnC1si6.js";/* empty css              */import"./popper-BOCcsbAp.js";import"./tag-Bx63MG5m.js";import{E as re,a as se}from"./checkbox-DsPJ2eDo.js";import{E as ie,a as me}from"./radio-dmMdrzLv.js";import"./scrollbar-BkaUBJQv.js";/* empty css                       *//* empty css                    */import{E as ce}from"./button-BawgqlTS.js";import{E as pe,a as ve}from"./select-Ch0pCwuz.js";import{a as V}from"./index-m2HHByeG.js";import{c as G}from"./index-DEdwEjqm.js";import{_ as b}from"./rules-F8IXRWD9.js";import{e as ye}from"./index-xnctt_mg.js";/* empty css                */import{E as fe}from"./index-1qs0NNd4.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-form-item-C32uxISk.js";import"./castArray-BGl2SdHc.js";import"./_baseClone-CBffdWIR.js";import"./_initCloneObject-B6fmpl8-.js";import"./isEqual-CrWmRS1i.js";import"./aria-KgdLjl5h.js";import"./event-BB_Ol6Sd.js";import"./arrays-6TrVLtTe.js";import"./scroll-D6org_fS.js";import"./cloneDeep-BlcmW06z.js";import"./focus-trap-4Z6V9Sgw.js";const Ve={class:"",style:{"margin-bottom":"20px"}},ke={style:{width:"550px",margin:"0 auto"}},be={style:{"margin-top":"20px","text-align":"center"}},Ce=le({__name:"CluesAdd",setup(he){const O=oe(),C=te(),S=p(C.query.status||""),H=ae(),D=p(H.EXHIBITION_INFO),$=p([]);ye().then(o=>{o.code===0&&($.value=o.data)});const M=p(null),a=p({exhibitionId:D.value.id,exhibitionName:D.value.exhibitionName,companyName:"",contactName:"",contactTel:"",country:"",province:"",city:"",address:"",companyBrand:[""],customField:[]}),g=p([]),U=p([]),N=p([]),h=p(""),E=p(""),I=p(""),P=p([]),L=()=>{M.value.validate(o=>{if(o)if(C.name==="CluesEdit")V.edit({id:C.query.id,...a.value}).then(l=>{l.code===0?(T.success("编辑成功"),O.go(-1)):T.error(l.msg)});else{let l={};if(S.value==="2")l={...a.value};else{let{exhibitionId:d,exhibitionName:c,...s}={...a.value};l=s}V.add(l).then(d=>{d.code===0?(T.success("保存成功"),O.go(-1)):T.error(d.msg)})}})},X=()=>{V.getCountry().then(o=>{o.code===0&&(g.value=o.data,C.name!=="CluesEdit"&&(h.value="CHN"))})},z=()=>{V.getProvince({countryCode:h.value}).then(o=>{o.code===0&&(U.value=o.data)})},J=()=>{V.getCity({provinceCode:E.value}).then(o=>{o.code===0&&(N.value=o.data)})};B(()=>h.value,o=>{let l=g.value.find(d=>d.code==o);a.value.country=l&&l.name||"",z()}),B(()=>E.value,o=>{let l=U.value.find(d=>d.code==o);a.value.province=l&&l.name||"",J()}),B(()=>I.value,o=>{let l=N.value.find(d=>d.code==o);a.value.city=l&&l.name||""});const Y=()=>{V.getCustomField().then(o=>{o.code===0&&(P.value=o.data,o.data.forEach(l=>{a.value.customField.push({[l.key]:G[l.type].value})}),Z())})};X(),Y();const Z=()=>{C.name==="CluesEdit"&&V.getData({id:C.query.id}).then(o=>{if(o.code===0){let l=o.data;for(let d in l)d==="customField"?l[d].forEach(c=>{let s=Object.keys(c)[0],v=Object.values(c)[0],F=a.value.customField.findIndex(R=>Object.keys(R)[0]===s);F!==-1&&(a.value.customField[F][s]=v)}):d==="customFieldTrans"||(a.value[d]=l[d]);V.getCountry().then(d=>{d.code===0&&(g.value=d.data,h.value=g.value.find(c=>c.name==a.value.country).code,V.getProvince({countryCode:h.value}).then(c=>{c.code===0&&(U.value=c.data,E.value=U.value.find(s=>s.name==a.value.province).code,V.getCity({provinceCode:E.value}).then(s=>{s.code===0&&(N.value=s.data,I.value=N.value.find(v=>v.name==a.value.city).code)}))}))})}})};return B(()=>a.value.exhibitionId,o=>{let l=$.value.find(d=>d.id==o);a.value.exhibitionName=l&&l.exhibitionName||""}),(o,l)=>{const d=pe,c=ve,s=de,v=fe,F=ce,R=ie,K=me,Q=re,W=se,j=ne,ee=ue;return u(),f(_,null,[x("div",Ve,[x("span",null,w(y(C).name==="CluesEdit"?"编辑":"新建")+"销售线索",1)]),x("div",ke,[i(ee,{ref_key:"formRef",ref:M,model:a.value,"label-width":"auto","label-position":"left"},{default:r(()=>[S.value=="2"?(u(),m(s,{key:0,label:"展会",prop:"exhibitionId",rules:y(b).select},{default:r(()=>[i(c,{modelValue:a.value.exhibitionId,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value.exhibitionId=e)},{default:r(()=>[(u(!0),f(_,null,k($.value,e=>(u(),m(d,{key:e.id,label:e.exhibitionName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])):A("",!0),i(s,{label:"企业名称",prop:"companyName",rules:y(b).required},{default:r(()=>[i(v,{modelValue:a.value.companyName,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value.companyName=e)},null,8,["modelValue"])]),_:1},8,["rules"]),i(s,{label:"联系人",prop:"contactName",rules:y(b).required},{default:r(()=>[i(v,{modelValue:a.value.contactName,"onUpdate:modelValue":l[2]||(l[2]=e=>a.value.contactName=e)},null,8,["modelValue"])]),_:1},8,["rules"]),i(s,{label:"联系电话",prop:"contactTel",rules:y(b).phone},{default:r(()=>[i(v,{modelValue:a.value.contactTel,"onUpdate:modelValue":l[3]||(l[3]=e=>a.value.contactTel=e)},null,8,["modelValue"])]),_:1},8,["rules"]),i(s,{label:"国家",prop:"country",rules:y(b).select},{default:r(()=>[i(c,{modelValue:h.value,"onUpdate:modelValue":l[4]||(l[4]=e=>h.value=e)},{default:r(()=>[(u(!0),f(_,null,k(g.value,e=>(u(),m(d,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"]),i(s,{label:"省份",prop:"province",rules:y(b).select},{default:r(()=>[i(c,{modelValue:E.value,"onUpdate:modelValue":l[5]||(l[5]=e=>E.value=e)},{default:r(()=>[(u(!0),f(_,null,k(U.value,e=>(u(),m(d,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"]),i(s,{label:"城市",prop:"city",rules:y(b).select},{default:r(()=>[i(c,{modelValue:I.value,"onUpdate:modelValue":l[6]||(l[6]=e=>I.value=e)},{default:r(()=>[(u(!0),f(_,null,k(N.value,e=>(u(),m(d,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"]),i(s,{label:"详细地址",prop:"address",rules:y(b).required},{default:r(()=>[i(v,{type:"textarea",modelValue:a.value.address,"onUpdate:modelValue":l[7]||(l[7]=e=>a.value.address=e)},null,8,["modelValue"])]),_:1},8,["rules"]),(u(!0),f(_,null,k(a.value.companyBrand,(e,n)=>(u(),m(s,{key:n,label:n===0?"品牌":" ",prop:`companyBrand[${n}]`,rules:y(b).required},{default:r(()=>[i(v,{modelValue:a.value.companyBrand[n],"onUpdate:modelValue":t=>a.value.companyBrand[n]=t},{append:r(()=>[n===0?(u(),m(F,{key:0,onClick:l[8]||(l[8]=t=>a.value.companyBrand.push("")),icon:"Plus"})):(u(),m(F,{key:1,onClick:t=>a.value.companyBrand.splice(n,1),icon:"Minus"},null,8,["onClick"]))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","prop","rules"]))),128)),(u(!0),f(_,null,k(P.value,(e,n)=>(u(),m(s,{key:e.key,label:e.name,prop:`customField[${n}][${e.key}]`,rules:e.isRequired?y(G)[e.type].rules:[]},{default:r(()=>[e.type===1?(u(),m(v,{key:0,modelValue:a.value.customField[n][e.key],"onUpdate:modelValue":t=>a.value.customField[n][e.key]=t,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])):e.type===2?(u(),m(v,{key:1,modelValue:a.value.customField[n][e.key],"onUpdate:modelValue":t=>a.value.customField[n][e.key]=t,modelModifiers:{trim:!0},type:"textarea"},null,8,["modelValue","onUpdate:modelValue"])):e.type===3?(u(),m(c,{key:2,modelValue:a.value.customField[n][e.key],"onUpdate:modelValue":t=>a.value.customField[n][e.key]=t},{default:r(()=>[(u(!0),f(_,null,k(e.data||[],t=>(u(),m(d,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type===4?(u(),m(K,{key:3,modelValue:a.value.customField[n][e.key],"onUpdate:modelValue":t=>a.value.customField[n][e.key]=t},{default:r(()=>[(u(!0),f(_,null,k(e.data||[],t=>(u(),m(R,{key:t.id,value:t.id},{default:r(()=>[q(w(t.name),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type===5?(u(),m(W,{key:4,modelValue:a.value.customField[n][e.key],"onUpdate:modelValue":t=>a.value.customField[n][e.key]=t},{default:r(()=>[(u(!0),f(_,null,k(e.data||[],t=>(u(),m(Q,{key:t.id,value:t.id,name:"type"},{default:r(()=>[q(w(t.name),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type===6?(u(),m(j,{key:5,clearable:"",style:{width:"100%"},modelValue:a.value.customField[n][e.key],"onUpdate:modelValue":t=>a.value.customField[n][e.key]=t,options:e.data,props:{value:"id",label:"name",children:"child",checkStrictly:!0}},null,8,["modelValue","onUpdate:modelValue","options"])):e.type===7?(u(),m(j,{key:6,clearable:"",style:{width:"100%"},modelValue:a.value.customField[n][e.key],"onUpdate:modelValue":t=>a.value.customField[n][e.key]=t,options:e.data,props:{value:"id",label:"name",children:"child",checkStrictly:!0,multiple:!0}},null,8,["modelValue","onUpdate:modelValue","options"])):A("",!0)]),_:2},1032,["label","prop","rules"]))),128)),x("div",be,[i(F,{type:"primary",onClick:L},{default:r(()=>[q("保存")]),_:1}),i(F,{type:"default",onClick:l[9]||(l[9]=e=>o.$router.go(-1))},{default:r(()=>[q("取消")]),_:1})])]),_:1},8,["model"])])],64)}}}),el=_e(Ce,[["__scopeId","data-v-438272ab"]]);export{el as default};
